"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "vendor-chunks/pinata";
exports.ids = ["vendor-chunks/pinata"];
exports.modules = {

/***/ "(rsc)/./node_modules/pinata/dist/index.mjs":
/*!********************************************!*\
  !*** ./node_modules/pinata/dist/index.mjs ***!
  \********************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   PinataSDK: () => (/* binding */ PinataSDK)\n/* harmony export */ });\n// src/utils/custom-errors.ts\nvar PinataError = class extends Error {\n  constructor(message, statusCode, details) {\n    super(message);\n    this.statusCode = statusCode;\n    this.details = details;\n    this.name = \"PinataError\";\n  }\n};\nvar NetworkError = class extends PinataError {\n  constructor(message, statusCode, details) {\n    super(message, statusCode, details);\n    this.name = \"NetworkError\";\n  }\n};\nvar AuthenticationError = class extends PinataError {\n  constructor(message, statusCode, details) {\n    super(message, statusCode, details);\n    this.name = \"AuthenticationError\";\n  }\n};\nvar ValidationError = class extends PinataError {\n  constructor(message, details) {\n    super(message, void 0, details);\n    this.name = \"ValidationError\";\n  }\n};\n\n// src/core/authentication/testAuthentication.ts\nvar testAuthentication = async (config) => {\n  if (!config) {\n    throw new ValidationError(\"Pinata configuration is missing\");\n  }\n  let headers;\n  let endpoint = \"https://api.pinata.cloud\";\n  if (config.endpointUrl) {\n    endpoint = config.endpointUrl;\n  }\n  if (config.customHeaders && Object.keys(config.customHeaders).length > 0) {\n    headers = {\n      Authorization: `Bearer ${config.pinataJwt}`,\n      ...config.customHeaders\n    };\n  } else {\n    headers = {\n      Authorization: `Bearer ${config.pinataJwt}`,\n      Source: \"sdk/testAuthentication\"\n    };\n  }\n  try {\n    const request = await fetch(`${endpoint}/data/testAuthentication`, {\n      method: \"GET\",\n      headers\n    });\n    if (!request.ok) {\n      const errorData = await request.text();\n      if (request.status === 401 || request.status === 403) {\n        throw new AuthenticationError(\n          `Authentication failed: ${errorData}`,\n          request.status,\n          errorData\n        );\n      }\n      throw new NetworkError(\n        `HTTP error: ${errorData}`,\n        request.status,\n        errorData\n      );\n    }\n    const res = await request.json();\n    return res;\n  } catch (error) {\n    if (error instanceof PinataError) {\n      throw error;\n    }\n    if (error instanceof Error) {\n      throw new PinataError(\n        `Error processing authentication: ${error.message}`\n      );\n    }\n    throw new PinataError(\n      \"An unknown error occurred while testing authentication\"\n    );\n  }\n};\n\n// src/utils/resumable.ts\nfunction getFileIdFromUrl(url) {\n  const match = url.match(/\\/files\\/([^\\/]+)/);\n  if (match && match[1]) {\n    return match[1];\n  }\n  throw new NetworkError(\"File ID not found in URL\", 400, url);\n}\n\n// src/core/uploads/file.ts\nvar uploadFile = async (config, file, options) => {\n  if (!config) {\n    throw new ValidationError(\"Pinata configuration is missing\");\n  }\n  const jwt = options?.keys || config.pinataJwt;\n  let endpoint = \"https://uploads.pinata.cloud/v3\";\n  if (config.uploadUrl) {\n    endpoint = config.uploadUrl;\n  }\n  if (file.size > 94371840) {\n    let headers2;\n    if (config.customHeaders && Object.keys(config.customHeaders).length > 0) {\n      headers2 = {\n        Authorization: `Bearer ${jwt}`,\n        ...config.customHeaders\n      };\n    } else {\n      headers2 = {\n        Authorization: `Bearer ${jwt}`,\n        Source: \"sdk/file\"\n      };\n    }\n    const name = options?.metadata?.name || file.name || \"File from SDK\";\n    let metadata = `filename ${btoa(name)},filetype ${btoa(file.type)}`;\n    if (options?.groupId) {\n      metadata + `,group_id ${btoa(options.groupId)}`;\n    }\n    if (options?.metadata?.keyvalues) {\n      metadata + `,keyvalues ${btoa(JSON.stringify(options.metadata.keyvalues))}`;\n    }\n    const urlReq = await fetch(`${endpoint}/files`, {\n      method: \"POST\",\n      headers: {\n        \"Upload-Length\": `${file.size}`,\n        \"Upload-Metadata\": metadata,\n        ...headers2\n      }\n    });\n    const url = urlReq.headers.get(\"Location\");\n    if (!url) {\n      throw new NetworkError(\"Upload URL not provided\", urlReq.status, \"\");\n    }\n    const chunkSize = 50 * 1024 * 1024;\n    const totalChunks = Math.ceil(file.size / chunkSize);\n    let offset = 0;\n    let uploadReq;\n    for (let i = 0; i < totalChunks; i++) {\n      const chunk = file.slice(offset, offset + chunkSize);\n      uploadReq = await fetch(url, {\n        method: \"PATCH\",\n        headers: {\n          \"Content-Type\": \"application/offset+octet-stream\",\n          \"Upload-Offset\": offset.toString(),\n          ...headers2\n        },\n        body: chunk\n      });\n      if (!uploadReq.ok) {\n        const errorData = await uploadReq.text();\n        throw new NetworkError(\n          `HTTP error during chunk upload: ${errorData}`,\n          uploadReq.status,\n          errorData\n        );\n      }\n      offset += chunk.size;\n    }\n    if (uploadReq.status === 204) {\n      const fileId = getFileIdFromUrl(url);\n      let dataEndpoint;\n      if (config.endpointUrl) {\n        dataEndpoint = config.endpointUrl;\n      } else {\n        dataEndpoint = \"https://api.pinata.cloud/v3\";\n      }\n      const fileInfoReq = await fetch(`${dataEndpoint}/files/${fileId}`, {\n        method: \"GET\",\n        headers: {\n          Authorization: `Bearer ${process.env.PINATA_JWT}`\n        }\n      });\n      const fileInfo = await fileInfoReq.json();\n      const data2 = fileInfo.data;\n      return data2;\n    }\n  }\n  let headers;\n  if (config.customHeaders && Object.keys(config.customHeaders).length > 0) {\n    headers = {\n      Authorization: `Bearer ${jwt}`,\n      ...config.customHeaders\n    };\n  } else {\n    headers = {\n      Authorization: `Bearer ${jwt}`,\n      Source: \"sdk/file\"\n    };\n  }\n  const data = new FormData();\n  data.append(\"file\", file, file.name);\n  data.append(\"name\", options?.metadata?.name || file.name || \"File from SDK\");\n  if (options?.groupId) {\n    data.append(\"group_id\", options.groupId);\n  }\n  if (options?.metadata?.keyvalues) {\n    data.append(\"keyvalues\", JSON.stringify(options.metadata.keyvalues));\n  }\n  try {\n    const request = await fetch(`${endpoint}/files`, {\n      method: \"POST\",\n      headers,\n      body: data\n    });\n    if (!request.ok) {\n      const errorData = await request.text();\n      if (request.status === 401 || request.status === 403) {\n        throw new AuthenticationError(\n          `Authentication failed: ${errorData}`,\n          request.status,\n          errorData\n        );\n      }\n      throw new NetworkError(\n        `HTTP error: ${errorData}`,\n        request.status,\n        errorData\n      );\n    }\n    const res = await request.json();\n    const resData = res.data;\n    return resData;\n  } catch (error) {\n    if (error instanceof PinataError) {\n      throw error;\n    }\n    if (error instanceof Error) {\n      throw new PinataError(`Error uploading file: ${error.message}`);\n    }\n    throw new PinataError(\"An unknown error occurred while uploading the file\");\n  }\n};\n\n// src/core/uploads/base64.ts\nvar uploadBase64 = async (config, base64String, options) => {\n  if (!config) {\n    throw new ValidationError(\"Pinata configuration is missing\");\n  }\n  const jwt = options?.keys || config?.pinataJwt;\n  const name = options?.metadata?.name ? options?.metadata?.name : \"base64 string\";\n  const buffer = Buffer.from(base64String, \"base64\");\n  const blob = new Blob([buffer]);\n  const data = new FormData();\n  data.append(\"file\", blob, name);\n  data.append(\"name\", name);\n  if (options?.groupId) {\n    data.append(\"group_id\", options.groupId);\n  }\n  if (options?.metadata?.keyvalues) {\n    data.append(\"keyvalues\", JSON.stringify(options.metadata.keyvalues));\n  }\n  let headers;\n  if (config.customHeaders && Object.keys(config.customHeaders).length > 0) {\n    headers = {\n      Authorization: `Bearer ${jwt}`,\n      ...config.customHeaders\n    };\n  } else {\n    headers = {\n      Authorization: `Bearer ${jwt}`,\n      Source: \"sdk/base64\"\n    };\n  }\n  let endpoint = \"https://uploads.pinata.cloud/v3\";\n  if (config.uploadUrl) {\n    endpoint = config.uploadUrl;\n  }\n  try {\n    const request = await fetch(`${endpoint}/files`, {\n      method: \"POST\",\n      headers,\n      body: data\n    });\n    if (!request.ok) {\n      const errorData = await request.text();\n      if (request.status === 401 || request.status === 403) {\n        throw new AuthenticationError(\n          `Authentication failed: ${errorData}`,\n          request.status,\n          errorData\n        );\n      }\n      throw new NetworkError(\n        `HTTP error: ${errorData}`,\n        request.status,\n        errorData\n      );\n    }\n    const res = await request.json();\n    const resData = res.data;\n    return resData;\n  } catch (error) {\n    if (error instanceof PinataError) {\n      throw error;\n    }\n    if (error instanceof Error) {\n      throw new PinataError(`Error processing base64: ${error.message}`);\n    }\n    throw new PinataError(\n      \"An unknown error occurred while trying to upload base64\"\n    );\n  }\n};\n\n// src/core/uploads/url.ts\nvar uploadUrl = async (config, url, options) => {\n  if (!config) {\n    throw new ValidationError(\"Pinata configuration is missing\");\n  }\n  const jwt = options?.keys || config?.pinataJwt;\n  const data = new FormData();\n  const stream = await fetch(url);\n  if (!stream.ok) {\n    const errorData = await stream.text();\n    throw new NetworkError(\n      `HTTP error: ${errorData}`,\n      stream.status,\n      errorData\n    );\n  }\n  const arrayBuffer = await stream.arrayBuffer();\n  const blob = new Blob([arrayBuffer]);\n  const name = options?.metadata?.name ?? \"url_upload\";\n  const file = new File([blob], name);\n  data.append(\"file\", file, name);\n  data.append(\"name\", name);\n  if (options?.groupId) {\n    data.append(\"group_id\", options.groupId);\n  }\n  if (options?.metadata?.keyvalues) {\n    data.append(\"keyvalues\", JSON.stringify(options.metadata.keyvalues));\n  }\n  let headers;\n  if (config.customHeaders && Object.keys(config.customHeaders).length > 0) {\n    headers = {\n      Authorization: `Bearer ${jwt}`,\n      ...config.customHeaders\n    };\n  } else {\n    headers = {\n      Authorization: `Bearer ${jwt}`,\n      Source: \"sdk/url\"\n    };\n  }\n  let endpoint = \"https://uploads.pinata.cloud/v3\";\n  if (config.uploadUrl) {\n    endpoint = config.uploadUrl;\n  }\n  try {\n    const request = await fetch(`${endpoint}/files`, {\n      method: \"POST\",\n      headers,\n      body: data\n    });\n    if (!request.ok) {\n      const errorData = await request.text();\n      if (request.status === 401 || request.status === 403) {\n        throw new AuthenticationError(\n          `Authentication failed: ${errorData}`,\n          request.status,\n          errorData\n        );\n      }\n      throw new NetworkError(\n        `HTTP error: ${errorData}`,\n        request.status,\n        errorData\n      );\n    }\n    const res = await request.json();\n    const resData = res.data;\n    return resData;\n  } catch (error) {\n    if (error instanceof PinataError) {\n      throw error;\n    }\n    if (error instanceof Error) {\n      throw new PinataError(`Error processing url: ${error.message}`);\n    }\n    throw new PinataError(\"An unknown error occurred while uploading by url\");\n  }\n};\n\n// src/core/uploads/json.ts\nvar uploadJson = async (config, jsonData, options) => {\n  if (!config) {\n    throw new ValidationError(\"Pinata configuration is missing\");\n  }\n  const jwt = options?.keys || config?.pinataJwt;\n  const json = JSON.stringify(jsonData);\n  const blob = new Blob([json]);\n  const file = new File([blob], \"data.json\", { type: \"application/json\" });\n  const data = new FormData();\n  data.append(\"file\", file, file.name);\n  data.append(\"name\", options?.metadata?.name || file.name || \"File from SDK\");\n  if (options?.groupId) {\n    data.append(\"group_id\", options.groupId);\n  }\n  if (options?.metadata?.keyvalues) {\n    data.append(\"keyvalues\", JSON.stringify(options.metadata.keyvalues));\n  }\n  let headers;\n  if (config.customHeaders && Object.keys(config.customHeaders).length > 0) {\n    headers = {\n      Authorization: `Bearer ${jwt}`,\n      ...config.customHeaders\n    };\n  } else {\n    headers = {\n      Authorization: `Bearer ${jwt}`,\n      Source: \"sdk/json\"\n    };\n  }\n  let endpoint = \"https://uploads.pinata.cloud/v3\";\n  if (config.uploadUrl) {\n    endpoint = config.uploadUrl;\n  }\n  try {\n    const request = await fetch(`${endpoint}/files`, {\n      method: \"POST\",\n      headers,\n      body: data\n    });\n    if (!request.ok) {\n      const errorData = await request.text();\n      if (request.status === 401 || request.status === 403) {\n        throw new AuthenticationError(\n          `Authentication failed: ${errorData}`,\n          request.status,\n          errorData\n        );\n      }\n      throw new NetworkError(\n        `HTTP error: ${errorData}`,\n        request.status,\n        errorData\n      );\n    }\n    const res = await request.json();\n    const resData = res.data;\n    return resData;\n  } catch (error) {\n    if (error instanceof PinataError) {\n      throw error;\n    }\n    if (error instanceof Error) {\n      throw new PinataError(`Error processing json: ${error.message}`);\n    }\n    throw new PinataError(\"An unknown error occurred while uploading json\");\n  }\n};\n\n// src/core/files/delete.ts\nvar wait = (milliseconds) => {\n  return new Promise((resolve) => {\n    setTimeout(resolve, milliseconds);\n  });\n};\nvar deleteFile = async (config, files) => {\n  if (!config) {\n    throw new ValidationError(\"Pinata configuration is missing\");\n  }\n  const responses = [];\n  let headers;\n  if (config.customHeaders && Object.keys(config.customHeaders).length > 0) {\n    headers = {\n      Authorization: `Bearer ${config.pinataJwt}`,\n      ...config.customHeaders\n    };\n  } else {\n    headers = {\n      Authorization: `Bearer ${config.pinataJwt}`,\n      Source: \"sdk/deleteFile\"\n    };\n  }\n  let endpoint = \"https://api.pinata.cloud/v3\";\n  if (config.endpointUrl) {\n    endpoint = config.endpointUrl;\n  }\n  for (const id of files) {\n    try {\n      const response = await fetch(`${endpoint}/files/${id}`, {\n        method: \"DELETE\",\n        headers\n      });\n      await wait(300);\n      if (!response.ok) {\n        const errorData = await response.text();\n        if (response.status === 401) {\n          throw new AuthenticationError(\n            `Authentication failed: ${errorData}`,\n            response.status,\n            errorData\n          );\n        }\n        throw new NetworkError(\n          `HTTP error: ${errorData}`,\n          response.status,\n          errorData\n        );\n      }\n      responses.push({\n        id,\n        status: response.statusText\n      });\n    } catch (error) {\n      let errorMessage;\n      if (error instanceof PinataError) {\n        errorMessage = error.message;\n      } else if (error instanceof Error) {\n        errorMessage = `Error deleting file ${id}: ${error.message}`;\n      } else {\n        errorMessage = `An unknown error occurred while deleting file ${id}`;\n      }\n      responses.push({\n        id,\n        status: errorMessage\n      });\n    }\n  }\n  return responses;\n};\n\n// src/core/files/list.ts\nvar listFiles = async (config, options) => {\n  if (!config) {\n    throw new ValidationError(\"Pinata configuration is missing\");\n  }\n  const params = new URLSearchParams();\n  if (options) {\n    const {\n      name,\n      group,\n      cid,\n      order,\n      limit,\n      mimeType,\n      pageToken,\n      cidPending,\n      metadata,\n      noGroup\n    } = options;\n    if (limit)\n      params.append(\"limit\", limit.toString());\n    if (name)\n      params.append(\"name\", name);\n    if (group)\n      params.append(\"group\", group);\n    if (cid)\n      params.append(\"cid\", cid);\n    if (mimeType)\n      params.append(\"mimeType\", mimeType);\n    if (order)\n      params.append(\"order\", order);\n    if (pageToken)\n      params.append(\"pageToken\", pageToken);\n    if (cidPending)\n      params.append(\"cidPending\", \"true\");\n    if (noGroup)\n      params.append(\"group\", \"null\");\n    if (metadata && typeof metadata === \"object\") {\n      Object.entries(metadata).forEach(([key, value]) => {\n        params.append(`metadata[${key}]`, value.toString());\n      });\n    }\n  }\n  let endpoint = \"https://api.pinata.cloud/v3\";\n  if (config.endpointUrl) {\n    endpoint = config.endpointUrl;\n  }\n  const url = `${endpoint}/files?${params.toString()}`;\n  try {\n    let headers;\n    if (config.customHeaders && Object.keys(config.customHeaders).length > 0) {\n      headers = {\n        Authorization: `Bearer ${config.pinataJwt}`,\n        ...config.customHeaders\n      };\n    } else {\n      headers = {\n        Authorization: `Bearer ${config.pinataJwt}`,\n        Source: \"sdk/listFiles\"\n      };\n    }\n    const request = await fetch(url, {\n      method: \"GET\",\n      headers\n    });\n    if (!request.ok) {\n      const errorData = await request.text();\n      if (request.status === 401 || request.status === 403) {\n        throw new AuthenticationError(\n          `Authentication failed: ${errorData}`,\n          request.status,\n          errorData\n        );\n      }\n      throw new NetworkError(\n        `HTTP error: ${errorData}`,\n        request.status,\n        errorData\n      );\n    }\n    const res = await request.json();\n    const resData = res.data;\n    return resData;\n  } catch (error) {\n    if (error instanceof PinataError) {\n      throw error;\n    }\n    if (error instanceof Error) {\n      throw new PinataError(`Error processing list files: ${error.message}`);\n    }\n    throw new PinataError(\"An unknown error occurred while listing files\");\n  }\n};\n\n// src/core/files/updateFile.ts\nvar updateFile = async (config, options) => {\n  if (!config) {\n    throw new ValidationError(\"Pinata configuration is missing\");\n  }\n  if (!options.name && (!options.keyvalues || Object.keys(options.keyvalues).length === 0)) {\n    throw new ValidationError(\n      \"At least one of 'name' or 'keyvalues' must be provided\"\n    );\n  }\n  const data = {};\n  if (options.name !== void 0) {\n    data.name = options.name;\n  }\n  if (options.keyvalues && Object.keys(options.keyvalues).length > 0) {\n    data.keyvalues = options.keyvalues;\n  }\n  const body = JSON.stringify(data);\n  let headers;\n  if (config.customHeaders && Object.keys(config.customHeaders).length > 0) {\n    headers = {\n      Authorization: `Bearer ${config.pinataJwt}`,\n      \"Content-Type\": \"application/json\",\n      ...config.customHeaders\n    };\n  } else {\n    headers = {\n      Authorization: `Bearer ${config.pinataJwt}`,\n      \"Content-Type\": \"application/json\",\n      Source: \"sdk/updateMetadata\"\n    };\n  }\n  let endpoint = \"https://api.pinata.cloud/v3\";\n  if (config.endpointUrl) {\n    endpoint = config.endpointUrl;\n  }\n  try {\n    const request = await fetch(`${endpoint}/files/${options.id}`, {\n      method: \"PUT\",\n      headers,\n      body\n    });\n    if (!request.ok) {\n      const errorData = await request.text();\n      if (request.status === 401 || request.status === 403) {\n        throw new AuthenticationError(\n          `Authentication failed: ${errorData}`,\n          request.status,\n          errorData\n        );\n      }\n      throw new NetworkError(\n        `HTTP error: ${errorData}`,\n        request.status,\n        errorData\n      );\n    }\n    const res = await request.json();\n    const resData = res.data;\n    return resData;\n  } catch (error) {\n    if (error instanceof PinataError) {\n      throw error;\n    }\n    if (error instanceof Error) {\n      throw new PinataError(`Error processing updateFile: ${error.message}`);\n    }\n    throw new PinataError(\"An unknown error occurred while updating file\");\n  }\n};\n\n// src/core/gateway/getCid.ts\nvar getCid = async (config, cid, options) => {\n  if (!config) {\n    throw new ValidationError(\"Pinata configuration is missing\");\n  }\n  let data;\n  let newUrl = `${config?.pinataGateway}/files/${cid}`;\n  const params = new URLSearchParams();\n  if (options) {\n    if (options.width)\n      params.append(\"img-width\", options.width.toString());\n    if (options.height)\n      params.append(\"img-height\", options.height.toString());\n    if (options.dpr)\n      params.append(\"img-dpr\", options.dpr.toString());\n    if (options.fit)\n      params.append(\"img-fit\", options.fit);\n    if (options.gravity)\n      params.append(\"img-gravity\", options.gravity);\n    if (options.quality)\n      params.append(\"img-quality\", options.quality.toString());\n    if (options.format)\n      params.append(\"img-format\", options.format);\n    if (options.animation !== void 0)\n      params.append(\"img-anim\", options.animation.toString());\n    if (options.sharpen)\n      params.append(\"img-sharpen\", options.sharpen.toString());\n    if (options.onError === true)\n      params.append(\"img-onerror\", \"redirect\");\n    if (options.metadata)\n      params.append(\"img-metadata\", options.metadata);\n  }\n  const queryString = params.toString();\n  if (queryString) {\n    newUrl += `?${queryString}`;\n  }\n  const date = Math.floor((/* @__PURE__ */ new Date()).getTime() / 1e3);\n  const payload = JSON.stringify({\n    url: newUrl,\n    date,\n    expires: 30,\n    method: \"GET\"\n  });\n  let endpoint = \"https://api.pinata.cloud/v3\";\n  if (config.endpointUrl) {\n    endpoint = config.endpointUrl;\n  }\n  let headers;\n  if (config.customHeaders && Object.keys(config.customHeaders).length > 0) {\n    headers = {\n      Authorization: `Bearer ${config.pinataJwt}`,\n      \"Content-Type\": \"application/json\",\n      ...config.customHeaders\n    };\n  } else {\n    headers = {\n      \"Content-Type\": \"application/json\",\n      Authorization: `Bearer ${config.pinataJwt}`,\n      Source: \"sdk/getCid\"\n    };\n  }\n  const signedUrlRequest = await fetch(`${endpoint}/files/sign`, {\n    method: \"POST\",\n    headers,\n    body: payload\n  });\n  const signedUrl = await signedUrlRequest.json();\n  try {\n    const request = await fetch(signedUrl.data);\n    if (!request.ok) {\n      const errorData = await request.text();\n      if (request.status === 401 || request.status === 403) {\n        throw new AuthenticationError(\n          `Authentication Failed: ${errorData}`,\n          request.status,\n          errorData\n        );\n      }\n      throw new NetworkError(\n        `HTTP error: ${errorData}`,\n        request.status,\n        errorData\n      );\n    }\n    const contentType = request.headers.get(\"content-type\")?.split(\";\")[0] || null;\n    if (contentType?.includes(\"application/json\")) {\n      data = await request.json();\n    } else if (contentType?.includes(\"text/\")) {\n      data = await request.text();\n    } else {\n      data = await request.blob();\n    }\n    const res = {\n      data,\n      contentType\n    };\n    return res;\n  } catch (error) {\n    if (error instanceof PinataError) {\n      throw error;\n    }\n    if (error instanceof Error) {\n      throw new PinataError(`Error processing getCid: ${error.message}`);\n    }\n    throw new PinataError(\n      \"An unknown error occurred while getting CID contents\"\n    );\n  }\n};\n\n// src/core/keys/createKey.ts\nvar createKey = async (config, options) => {\n  if (!config) {\n    throw new ValidationError(\"Pinata configuration is missing\");\n  }\n  let headers;\n  if (config.customHeaders && Object.keys(config.customHeaders).length > 0) {\n    headers = {\n      Authorization: `Bearer ${config.pinataJwt}`,\n      \"Content-Type\": \"application/json\",\n      ...config.customHeaders\n    };\n  } else {\n    headers = {\n      Authorization: `Bearer ${config.pinataJwt}`,\n      \"Content-Type\": \"application/json\",\n      Source: \"sdk/createKey\"\n    };\n  }\n  const data = JSON.stringify(options);\n  let endpoint = \"https://api.pinata.cloud/v3\";\n  if (config.endpointUrl) {\n    endpoint = config.endpointUrl;\n  }\n  try {\n    const request = await fetch(`${endpoint}/pinata/keys`, {\n      method: \"POST\",\n      headers,\n      body: data\n    });\n    if (!request.ok) {\n      const errorData = await request.text();\n      if (request.status === 401 || request.status === 403) {\n        throw new AuthenticationError(\n          `Authentication failed: ${errorData}`,\n          request.status,\n          errorData\n        );\n      }\n      throw new NetworkError(\n        `HTTP error: ${errorData}`,\n        request.status,\n        errorData\n      );\n    }\n    const res = await request.json();\n    return res;\n  } catch (error) {\n    if (error instanceof PinataError) {\n      throw error;\n    }\n    if (error instanceof Error) {\n      throw new PinataError(`Error processing createKey: ${error.message}`);\n    }\n    throw new PinataError(\"An unknown error occurred while creating API key\");\n  }\n};\n\n// src/core/keys/listKeys.ts\nvar listKeys = async (config, options) => {\n  if (!config) {\n    throw new ValidationError(\"Pinata configuration is missing\");\n  }\n  let headers;\n  if (config.customHeaders && Object.keys(config.customHeaders).length > 0) {\n    headers = {\n      Authorization: `Bearer ${config.pinataJwt}`,\n      \"Content-Type\": \"application/json\",\n      ...config.customHeaders\n    };\n  } else {\n    headers = {\n      Authorization: `Bearer ${config.pinataJwt}`,\n      \"Content-Type\": \"application/json\",\n      Source: \"sdk/listKeys\"\n    };\n  }\n  const params = new URLSearchParams();\n  if (options) {\n    const { offset, name, revoked, limitedUse, exhausted } = options;\n    if (offset)\n      params.append(\"offset\", offset.toString());\n    if (revoked !== void 0)\n      params.append(\"revoked\", revoked.toString());\n    if (limitedUse !== void 0)\n      params.append(\"limitedUse\", limitedUse.toString());\n    if (exhausted !== void 0)\n      params.append(\"exhausted\", exhausted.toString());\n    if (name)\n      params.append(\"name\", name);\n  }\n  let endpoint = \"https://api.pinata.cloud/v3\";\n  if (config.endpointUrl) {\n    endpoint = config.endpointUrl;\n  }\n  try {\n    const request = await fetch(\n      `${endpoint}/pinata/keys?${params.toString()}`,\n      {\n        method: \"GET\",\n        headers\n      }\n    );\n    if (!request.ok) {\n      const errorData = await request.text();\n      if (request.status === 401 || request.status === 403) {\n        throw new AuthenticationError(\n          `Authentication failed: ${errorData}`,\n          request.status,\n          errorData\n        );\n      }\n      throw new NetworkError(\n        `HTTP error: ${errorData}`,\n        request.status,\n        errorData\n      );\n    }\n    const res = await request.json();\n    return res.keys;\n  } catch (error) {\n    if (error instanceof PinataError) {\n      throw error;\n    }\n    if (error instanceof Error) {\n      throw new PinataError(`Error processing listKeys: ${error.message}`);\n    }\n    throw new PinataError(\"An unknown error occurred while listing API keys\");\n  }\n};\n\n// src/core/keys/revokeKeys.ts\nvar wait2 = (milliseconds) => {\n  return new Promise((resolve) => {\n    setTimeout(resolve, milliseconds);\n  });\n};\nvar revokeKeys = async (config, keys) => {\n  if (!config) {\n    throw new ValidationError(\"Pinata configuration is missing\");\n  }\n  let headers;\n  if (config.customHeaders && Object.keys(config.customHeaders).length > 0) {\n    headers = {\n      Authorization: `Bearer ${config.pinataJwt}`,\n      \"Content-Type\": \"application/json\",\n      ...config.customHeaders\n    };\n    headers = { ...config.customHeaders };\n  } else {\n    headers = {\n      Authorization: `Bearer ${config.pinataJwt}`,\n      \"Content-Type\": \"application/json\",\n      Source: \"sdk/revokeKeys\"\n    };\n  }\n  const responses = [];\n  let endpoint = \"https://api.pinata.cloud/v3\";\n  if (config.endpointUrl) {\n    endpoint = config.endpointUrl;\n  }\n  for (const key of keys) {\n    try {\n      const request = await fetch(`${endpoint}/pinata/keys/${key}`, {\n        method: \"PUT\",\n        headers\n      });\n      await wait2(300);\n      if (!request.ok) {\n        const errorData = await request.text();\n        if (request.status === 401 || request.status === 403) {\n          throw new AuthenticationError(\n            `Authentication failed: ${errorData}`,\n            request.status,\n            errorData\n          );\n        }\n        throw new NetworkError(\n          `HTTP error: ${errorData}`,\n          request.status,\n          errorData\n        );\n      }\n      const result = await request.json();\n      responses.push({\n        key,\n        status: result\n      });\n    } catch (error) {\n      let errorMessage;\n      if (error instanceof PinataError) {\n        errorMessage = error.message;\n      } else if (error instanceof Error) {\n        errorMessage = `Error revoking key ${key}: ${error.message}`;\n      } else {\n        errorMessage = `An unknown error occurred while revoking key ${key}`;\n      }\n      responses.push({\n        key,\n        status: errorMessage\n      });\n    }\n  }\n  return responses;\n};\n\n// src/core/groups/createGroup.ts\nvar createGroup = async (config, options) => {\n  if (!config) {\n    throw new ValidationError(\"Pinata configuration is missing\");\n  }\n  const data = JSON.stringify({\n    name: options.name,\n    is_public: options.isPublic\n  });\n  let headers;\n  if (config.customHeaders && Object.keys(config.customHeaders).length > 0) {\n    headers = {\n      Authorization: `Bearer ${config.pinataJwt}`,\n      \"Content-Type\": \"application/json\",\n      ...config.customHeaders\n    };\n  } else {\n    headers = {\n      Authorization: `Bearer ${config.pinataJwt}`,\n      \"Content-Type\": \"application/json\",\n      Source: \"sdk/createGroup\"\n    };\n  }\n  let endpoint = \"https://api.pinata.cloud/v3\";\n  if (config.endpointUrl) {\n    endpoint = config.endpointUrl;\n  }\n  try {\n    const request = await fetch(`${endpoint}/files/groups`, {\n      method: \"POST\",\n      headers,\n      body: data\n    });\n    if (!request.ok) {\n      const errorData = await request.text();\n      if (request.status === 401 || request.status === 403) {\n        throw new AuthenticationError(\n          `Authentication failed: ${errorData}`,\n          request.status,\n          errorData\n        );\n      }\n      throw new NetworkError(\n        `HTTP error: ${errorData}`,\n        request.status,\n        errorData\n      );\n    }\n    const res = await request.json();\n    const resData = res.data;\n    return resData;\n  } catch (error) {\n    if (error instanceof PinataError) {\n      throw error;\n    }\n    if (error instanceof Error) {\n      throw new PinataError(`Error processing createGroup: ${error.message}`);\n    }\n    throw new PinataError(\"An unknown error occurred while creating a group\");\n  }\n};\n\n// src/core/groups/listGroups.ts\nvar listGroups = async (config, options) => {\n  if (!config) {\n    throw new ValidationError(\"Pinata configuration is missing\");\n  }\n  let headers;\n  if (config.customHeaders && Object.keys(config.customHeaders).length > 0) {\n    headers = {\n      Authorization: `Bearer ${config.pinataJwt}`,\n      \"Content-Type\": \"application/json\",\n      ...config.customHeaders\n    };\n  } else {\n    headers = {\n      Authorization: `Bearer ${config.pinataJwt}`,\n      \"Content-Type\": \"application/json\",\n      Source: \"sdk/listGroups\"\n    };\n  }\n  const params = new URLSearchParams();\n  if (options) {\n    const { pageToken, name, limit, isPublic } = options;\n    if (pageToken)\n      params.append(\"pageToken\", pageToken.toString());\n    if (isPublic)\n      params.append(\"isPublic\", isPublic.toString());\n    if (name)\n      params.append(\"name\", name);\n    if (limit !== void 0)\n      params.append(\"limit\", limit.toString());\n  }\n  let endpoint = \"https://api.pinata.cloud/v3\";\n  if (config.endpointUrl) {\n    endpoint = config.endpointUrl;\n  }\n  try {\n    const request = await fetch(\n      `${endpoint}/files/groups?${params.toString()}`,\n      {\n        method: \"GET\",\n        headers\n      }\n    );\n    if (!request.ok) {\n      const errorData = await request.text();\n      if (request.status === 401 || request.status === 403) {\n        throw new AuthenticationError(\n          `Authentication failed: ${errorData}`,\n          request.status,\n          errorData\n        );\n      }\n      throw new NetworkError(\n        `HTTP error: ${errorData}`,\n        request.status,\n        errorData\n      );\n    }\n    const res = await request.json();\n    const resData = res.data;\n    return resData;\n  } catch (error) {\n    if (error instanceof PinataError) {\n      throw error;\n    }\n    if (error instanceof Error) {\n      throw new PinataError(`Error processing listGroups: ${error.message}`);\n    }\n    throw new PinataError(\"An unknown error occurred while listing groups\");\n  }\n};\n\n// src/core/groups/getGroup.ts\nvar getGroup = async (config, options) => {\n  if (!config) {\n    throw new ValidationError(\"Pinata configuration is missing\");\n  }\n  let headers;\n  if (config.customHeaders && Object.keys(config.customHeaders).length > 0) {\n    headers = {\n      Authorization: `Bearer ${config.pinataJwt}`,\n      \"Content-Type\": \"application/json\",\n      ...config.customHeaders\n    };\n  } else {\n    headers = {\n      Authorization: `Bearer ${config.pinataJwt}`,\n      \"Content-Type\": \"application/json\",\n      Source: \"sdk/getGroup\"\n    };\n  }\n  let endpoint = \"https://api.pinata.cloud/v3\";\n  if (config.endpointUrl) {\n    endpoint = config.endpointUrl;\n  }\n  try {\n    const request = await fetch(`${endpoint}/files/groups/${options.groupId}`, {\n      method: \"GET\",\n      headers\n    });\n    if (!request.ok) {\n      const errorData = await request.text();\n      if (request.status === 401 || request.status === 403) {\n        throw new AuthenticationError(\n          `Authentication failed: ${errorData}`,\n          request.status,\n          errorData\n        );\n      }\n      throw new NetworkError(\n        `HTTP error: ${errorData}`,\n        request.status,\n        errorData\n      );\n    }\n    const res = await request.json();\n    const resData = res.data;\n    return resData;\n  } catch (error) {\n    if (error instanceof PinataError) {\n      throw error;\n    }\n    if (error instanceof Error) {\n      throw new PinataError(`Error processing getGroup: ${error.message}`);\n    }\n    throw new PinataError(\n      \"An unknown error occurred while getting info for a group\"\n    );\n  }\n};\n\n// src/core/groups/addToGroup.ts\nvar addToGroup = async (config, options) => {\n  if (!config) {\n    throw new ValidationError(\"Pinata configuration is missing\");\n  }\n  const wait3 = (milliseconds) => {\n    return new Promise((resolve) => {\n      setTimeout(resolve, milliseconds);\n    });\n  };\n  const responses = [];\n  let headers;\n  if (config.customHeaders && Object.keys(config.customHeaders).length > 0) {\n    headers = {\n      Authorization: `Bearer ${config.pinataJwt}`,\n      \"Content-Type\": \"application/json\",\n      ...config.customHeaders\n    };\n  } else {\n    headers = {\n      Authorization: `Bearer ${config.pinataJwt}`,\n      \"Content-Type\": \"application/json\",\n      Source: \"sdk/addToGroup\"\n    };\n  }\n  let endpoint = \"https://api.pinata.cloud/v3\";\n  if (config.endpointUrl) {\n    endpoint = config.endpointUrl;\n  }\n  for (const id of options.files) {\n    try {\n      const response = await fetch(\n        `${endpoint}/files/groups/${options.groupId}/ids/${id}`,\n        {\n          method: \"PUT\",\n          headers\n        }\n      );\n      await wait3(300);\n      if (!response.ok) {\n        const errorData = await response.text();\n        if (response.status === 401) {\n          throw new AuthenticationError(\n            `Authentication failed: ${errorData}`,\n            response.status,\n            errorData\n          );\n        }\n        throw new NetworkError(\n          `HTTP error: ${errorData}`,\n          response.status,\n          errorData\n        );\n      }\n      responses.push({\n        id,\n        status: response.statusText\n      });\n    } catch (error) {\n      let errorMessage;\n      if (error instanceof PinataError) {\n        errorMessage = error.message;\n      } else if (error instanceof Error) {\n        errorMessage = `Error adding file ${id} to group: ${error.message}`;\n      } else {\n        errorMessage = `An unknown error occurred while adding file ${id} to group`;\n      }\n      responses.push({\n        id,\n        status: errorMessage\n      });\n    }\n  }\n  return responses;\n};\n\n// src/core/groups/updateGroup.ts\nvar updateGroup = async (config, options) => {\n  if (!config) {\n    throw new ValidationError(\"Pinata configuration is missing\");\n  }\n  const data = JSON.stringify({\n    name: options.name,\n    is_public: options.isPublic\n  });\n  let headers;\n  if (config.customHeaders && Object.keys(config.customHeaders).length > 0) {\n    headers = {\n      Authorization: `Bearer ${config.pinataJwt}`,\n      \"Content-Type\": \"application/json\",\n      ...config.customHeaders\n    };\n  } else {\n    headers = {\n      Authorization: `Bearer ${config.pinataJwt}`,\n      \"Content-Type\": \"application/json\",\n      Source: \"sdk/updateGroup\"\n    };\n  }\n  let endpoint = \"https://api.pinata.cloud/v3\";\n  if (config.endpointUrl) {\n    endpoint = config.endpointUrl;\n  }\n  try {\n    const request = await fetch(`${endpoint}/files/groups/${options.groupId}`, {\n      method: \"PUT\",\n      headers,\n      body: data\n    });\n    if (!request.ok) {\n      const errorData = await request.text();\n      if (request.status === 401 || request.status === 403) {\n        throw new AuthenticationError(\n          `Authentication failed: ${errorData}`,\n          request.status,\n          errorData\n        );\n      }\n      throw new NetworkError(\n        `HTTP error: ${errorData}`,\n        request.status,\n        errorData\n      );\n    }\n    const res = await request.json();\n    const resData = res.data;\n    return resData;\n  } catch (error) {\n    if (error instanceof PinataError) {\n      throw error;\n    }\n    if (error instanceof Error) {\n      throw new PinataError(`Error processing updateGroup: ${error.message}`);\n    }\n    throw new PinataError(\"An unknown error occurred while updating group\");\n  }\n};\n\n// src/core/groups/removeFromGroup.ts\nvar removeFromGroup = async (config, options) => {\n  if (!config) {\n    throw new ValidationError(\"Pinata configuration is missing\");\n  }\n  const wait3 = (milliseconds) => {\n    return new Promise((resolve) => {\n      setTimeout(resolve, milliseconds);\n    });\n  };\n  const responses = [];\n  let headers;\n  if (config.customHeaders && Object.keys(config.customHeaders).length > 0) {\n    headers = {\n      Authorization: `Bearer ${config.pinataJwt}`,\n      \"Content-Type\": \"application/json\",\n      ...config.customHeaders\n    };\n  } else {\n    headers = {\n      Authorization: `Bearer ${config.pinataJwt}`,\n      \"Content-Type\": \"application/json\",\n      Source: \"sdk/addToGroup\"\n    };\n  }\n  let endpoint = \"https://api.pinata.cloud/v3\";\n  if (config.endpointUrl) {\n    endpoint = config.endpointUrl;\n  }\n  for (const id of options.files) {\n    try {\n      const response = await fetch(\n        `${endpoint}/files/groups/${options.groupId}/ids/${id}`,\n        {\n          method: \"DELETE\",\n          headers\n        }\n      );\n      await wait3(300);\n      if (!response.ok) {\n        const errorData = await response.text();\n        if (response.status === 401) {\n          throw new AuthenticationError(\n            `Authentication failed: ${errorData}`,\n            response.status,\n            errorData\n          );\n        }\n        throw new NetworkError(\n          `HTTP error: ${errorData}`,\n          response.status,\n          errorData\n        );\n      }\n      responses.push({\n        id,\n        status: response.statusText\n      });\n    } catch (error) {\n      let errorMessage;\n      if (error instanceof PinataError) {\n        errorMessage = error.message;\n      } else if (error instanceof Error) {\n        errorMessage = `Error adding file ${id} to group: ${error.message}`;\n      } else {\n        errorMessage = `An unknown error occurred while adding file ${id} to group`;\n      }\n      responses.push({\n        id,\n        status: errorMessage\n      });\n    }\n  }\n  return responses;\n};\n\n// src/core/groups/deleteGroup.ts\nvar deleteGroup = async (config, options) => {\n  if (!config) {\n    throw new ValidationError(\"Pinata configuration is missing\");\n  }\n  let headers;\n  if (config.customHeaders && Object.keys(config.customHeaders).length > 0) {\n    headers = {\n      Authorization: `Bearer ${config.pinataJwt}`,\n      \"Content-Type\": \"application/json\",\n      ...config.customHeaders\n    };\n  } else {\n    headers = {\n      Authorization: `Bearer ${config.pinataJwt}`,\n      \"Content-Type\": \"application/json\",\n      Source: \"sdk/deleteGroup\"\n    };\n  }\n  let endpoint = \"https://api.pinata.cloud/v3\";\n  if (config.endpointUrl) {\n    endpoint = config.endpointUrl;\n  }\n  try {\n    const request = await fetch(`${endpoint}/files/groups/${options.groupId}`, {\n      method: \"DELETE\",\n      headers\n    });\n    if (!request.ok) {\n      const errorData = await request.text();\n      if (request.status === 401 || request.status === 403) {\n        throw new AuthenticationError(\n          `Authentication failed: ${errorData}`,\n          request.status,\n          errorData\n        );\n      }\n      throw new NetworkError(\n        `HTTP error: ${errorData}`,\n        request.status,\n        errorData\n      );\n    }\n    const res = request.statusText;\n    return res;\n  } catch (error) {\n    if (error instanceof PinataError) {\n      throw error;\n    }\n    if (error instanceof Error) {\n      throw new PinataError(`Error processing deleteGroup: ${error.message}`);\n    }\n    throw new PinataError(\"An unknown error occurred while deleting a group\");\n  }\n};\n\n// src/core/analytics/analyticsTopUsage.ts\nvar analyticsTopUsage = async (config, options) => {\n  if (!config) {\n    throw new ValidationError(\"Pinata configuration is missing\");\n  }\n  const params = new URLSearchParams();\n  if (options) {\n    const {\n      cid,\n      gateway_domain,\n      start_date,\n      end_date,\n      file_name,\n      user_agent,\n      country,\n      region,\n      referer,\n      limit,\n      sort_order,\n      sort_by,\n      attribute\n    } = options;\n    const domain = gateway_domain || config.pinataGateway;\n    if (domain) {\n      const cleanDomain = domain.replace(/^https?:\\/\\//, \"\");\n      params.append(\"gateway_domain\", cleanDomain);\n    }\n    if (cid) {\n      params.append(\"cid\", cid);\n    }\n    if (start_date)\n      params.append(\"start_date\", start_date);\n    if (end_date)\n      params.append(\"end_date\", end_date);\n    if (file_name)\n      params.append(\"file_name\", file_name);\n    if (user_agent)\n      params.append(\"user_agent\", user_agent.toString());\n    if (country)\n      params.append(\"country\", country.toString());\n    if (region)\n      params.append(\"region\", region);\n    if (referer)\n      params.append(\"referer\", referer.toString());\n    if (limit)\n      params.append(\"limit\", limit.toString());\n    if (sort_order)\n      params.append(\"sort_order\", sort_order);\n    if (sort_by)\n      params.append(\"sort_by\", sort_by);\n    if (attribute)\n      params.append(\"by\", attribute);\n  }\n  let endpoint = \"https://api.pinata.cloud/v3\";\n  if (config.endpointUrl) {\n    endpoint = config.endpointUrl;\n  }\n  const url = `${endpoint}/ipfs/gateway_analytics_top?${params.toString()}`;\n  try {\n    let headers;\n    if (config.customHeaders && Object.keys(config.customHeaders).length > 0) {\n      headers = { ...config.customHeaders };\n    } else {\n      headers = {\n        Authorization: `Bearer ${config.pinataJwt}`,\n        Source: \"sdk/analyticsTopUsage\"\n      };\n    }\n    const request = await fetch(url, {\n      method: \"GET\",\n      headers\n    });\n    if (!request.ok) {\n      const errorData = await request.text();\n      if (request.status === 401 || request.status === 403) {\n        throw new AuthenticationError(\n          `Authentication failed: ${errorData}`,\n          request.status,\n          errorData\n        );\n      }\n      throw new NetworkError(\n        `HTTP error: ${errorData}`,\n        request.status,\n        errorData\n      );\n    }\n    const res = await request.json();\n    return res;\n  } catch (error) {\n    if (error instanceof PinataError) {\n      throw error;\n    }\n    if (error instanceof Error) {\n      throw new PinataError(\n        `Error processing anaytics usage: ${error.message}`\n      );\n    }\n    throw new PinataError(\n      \"An unknown error occurred while fetching gateway usage\"\n    );\n  }\n};\n\n// src/core/analytics/analyticsDateInterval.ts\nvar analyticsDateInterval = async (config, options) => {\n  if (!config) {\n    throw new ValidationError(\"Pinata configuration is missing\");\n  }\n  const params = new URLSearchParams();\n  if (options) {\n    const {\n      cid,\n      gateway_domain,\n      start_date,\n      end_date,\n      file_name,\n      user_agent,\n      country,\n      region,\n      referer,\n      limit,\n      sort_order,\n      date_interval,\n      sort_by\n    } = options;\n    if (cid)\n      params.append(\"cid\", cid);\n    if (gateway_domain)\n      params.append(\"gateway_domain\", gateway_domain);\n    if (start_date)\n      params.append(\"start_date\", start_date);\n    if (end_date)\n      params.append(\"end_date\", end_date);\n    if (file_name)\n      params.append(\"file_name\", file_name);\n    if (user_agent)\n      params.append(\"user_agent\", user_agent.toString());\n    if (country)\n      params.append(\"country\", country.toString());\n    if (region)\n      params.append(\"region\", region);\n    if (referer)\n      params.append(\"referer\", referer.toString());\n    if (limit)\n      params.append(\"limit\", limit.toString());\n    if (sort_order)\n      params.append(\"sort_order\", sort_order);\n    if (sort_by)\n      params.append(\"sort_by\", sort_by);\n    if (date_interval)\n      params.append(\"by\", date_interval);\n  }\n  let endpoint = \"https://api.pinata.cloud/v3\";\n  if (config.endpointUrl) {\n    endpoint = config.endpointUrl;\n  }\n  const url = `${endpoint}/ipfs/gateway_analytics_time_series?${params.toString()}`;\n  try {\n    let headers;\n    if (config.customHeaders && Object.keys(config.customHeaders).length > 0) {\n      headers = { ...config.customHeaders };\n    } else {\n      headers = {\n        Authorization: `Bearer ${config.pinataJwt}`,\n        Source: \"sdk/analyticsDateInterval\"\n      };\n    }\n    const request = await fetch(url, {\n      method: \"GET\",\n      headers\n    });\n    if (!request.ok) {\n      const errorData = await request.text();\n      if (request.status === 401 || request.status === 403) {\n        throw new AuthenticationError(\n          `Authentication failed: ${errorData}`,\n          request.status,\n          errorData\n        );\n      }\n      throw new NetworkError(\n        `HTTP error: ${errorData}`,\n        request.status,\n        errorData\n      );\n    }\n    const res = await request.json();\n    const resData = res.data;\n    return resData;\n  } catch (error) {\n    if (error instanceof PinataError) {\n      throw error;\n    }\n    if (error instanceof Error) {\n      throw new PinataError(\n        `Error processing anaytics usage: ${error.message}`\n      );\n    }\n    throw new PinataError(\n      \"An unknown error occurred while fetching gateway usage\"\n    );\n  }\n};\n\n// src/core/files/swapCid.ts\nvar swapCid = async (config, options) => {\n  if (!config) {\n    throw new ValidationError(\"Pinata configuration is missing\");\n  }\n  const data = JSON.stringify({\n    swap_cid: options.swapCid\n  });\n  let headers;\n  if (config.customHeaders && Object.keys(config.customHeaders).length > 0) {\n    headers = {\n      Authorization: `Bearer ${config.pinataJwt}`,\n      \"Content-Type\": \"application/json\",\n      ...config.customHeaders\n    };\n  } else {\n    headers = {\n      Authorization: `Bearer ${config.pinataJwt}`,\n      \"Content-Type\": \"application/json\",\n      Source: \"sdk/swapCid\"\n    };\n  }\n  let endpoint = \"https://api.pinata.cloud/v3\";\n  if (config.endpointUrl) {\n    endpoint = config.endpointUrl;\n  }\n  try {\n    const request = await fetch(`${endpoint}/files/swap/${options.cid}`, {\n      method: \"PUT\",\n      headers,\n      body: data\n    });\n    if (!request.ok) {\n      const errorData = await request.text();\n      if (request.status === 401 || request.status === 403) {\n        throw new AuthenticationError(\n          `Authentication failed: ${errorData}`,\n          request.status,\n          errorData\n        );\n      }\n      if (request.status === 403) {\n        throw new PinataError(\n          \"Unauthorized CID Swap\",\n          request.status,\n          errorData\n        );\n      }\n      if (request.status === 404) {\n        throw new PinataError(\n          \"CID not pinned to account\",\n          request.status,\n          errorData\n        );\n      }\n      throw new NetworkError(\n        `HTTP error: ${errorData}`,\n        request.status,\n        errorData\n      );\n    }\n    const res = await request.json();\n    const resData = res.data;\n    return resData;\n  } catch (error) {\n    if (error instanceof PinataError) {\n      throw error;\n    }\n    if (error instanceof Error) {\n      throw new PinataError(`Error processing CID Swap: ${error.message}`);\n    }\n    throw new PinataError(\"An unknown error occurred while swapping CID\");\n  }\n};\n\n// src/core/files/swapHistory.ts\nvar swapHistory = async (config, options) => {\n  if (!config) {\n    throw new ValidationError(\"Pinata configuration is missing\");\n  }\n  let headers;\n  if (config.customHeaders && Object.keys(config.customHeaders).length > 0) {\n    headers = {\n      Authorization: `Bearer ${config.pinataJwt}`,\n      \"Content-Type\": \"application/json\",\n      ...config.customHeaders\n    };\n  } else {\n    headers = {\n      Authorization: `Bearer ${config.pinataJwt}`,\n      \"Content-Type\": \"application/json\",\n      Source: \"sdk/swapHistory\"\n    };\n  }\n  let endpoint = \"https://api.pinata.cloud/v3\";\n  if (config.endpointUrl) {\n    endpoint = config.endpointUrl;\n  }\n  try {\n    const request = await fetch(\n      `${endpoint}/files/swap/${options.cid}?domain=${options.domain}`,\n      {\n        method: \"GET\",\n        headers\n      }\n    );\n    if (!request.ok) {\n      const errorData = await request.text();\n      if (request.status === 401 || request.status === 403) {\n        throw new AuthenticationError(\n          `Authentication failed: ${errorData}`,\n          request.status,\n          errorData\n        );\n      }\n      if (request.status === 404) {\n        throw new PinataError(\n          \"CID does not have history\",\n          request.status,\n          errorData\n        );\n      }\n      throw new NetworkError(\n        `HTTP error: ${errorData}`,\n        request.status,\n        errorData\n      );\n    }\n    const res = await request.json();\n    const resData = res.data;\n    return resData;\n  } catch (error) {\n    if (error instanceof PinataError) {\n      throw error;\n    }\n    if (error instanceof Error) {\n      throw new PinataError(`Error fetching swap history: ${error.message}`);\n    }\n    throw new PinataError(\n      \"An unknown error occurred while fetching swap history\"\n    );\n  }\n};\n\n// src/core/files/deleteSwap.ts\nvar deleteSwap = async (config, cid) => {\n  if (!config) {\n    throw new ValidationError(\"Pinata configuration is missing\");\n  }\n  let headers;\n  if (config.customHeaders && Object.keys(config.customHeaders).length > 0) {\n    headers = {\n      Authorization: `Bearer ${config.pinataJwt}`,\n      \"Content-Type\": \"application/json\",\n      ...config.customHeaders\n    };\n  } else {\n    headers = {\n      Authorization: `Bearer ${config.pinataJwt}`,\n      \"Content-Type\": \"application/json\",\n      Source: \"sdk/deleteSwap\"\n    };\n  }\n  let endpoint = \"https://api.pinata.cloud/v3\";\n  if (config.endpointUrl) {\n    endpoint = config.endpointUrl;\n  }\n  try {\n    const request = await fetch(`${endpoint}/files/swap/${cid}`, {\n      method: \"DELETE\",\n      headers\n    });\n    if (!request.ok) {\n      const errorData = await request.text();\n      if (request.status === 401 || request.status === 403) {\n        throw new AuthenticationError(\n          `Authentication failed: ${errorData}`,\n          request.status,\n          errorData\n        );\n      }\n      if (request.status === 403) {\n        throw new PinataError(\n          \"Unauthorized CID Swap Deletion\",\n          request.status,\n          errorData\n        );\n      }\n      if (request.status === 404) {\n        throw new PinataError(\n          \"CID not pinned to account\",\n          request.status,\n          errorData\n        );\n      }\n      throw new NetworkError(\n        `HTTP error: ${errorData}`,\n        request.status,\n        errorData\n      );\n    }\n    return request.statusText;\n  } catch (error) {\n    if (error instanceof PinataError) {\n      throw error;\n    }\n    if (error instanceof Error) {\n      throw new PinataError(`Error processing deleteSwap: ${error.message}`);\n    }\n    throw new PinataError(\"An unknown error occurred while deleting swap\");\n  }\n};\n\n// src/core/gateway/createSignedURL.ts\nvar createSignedURL = async (config, options, imgOpts) => {\n  if (!config) {\n    throw new ValidationError(\"Pinata configuration is missing\");\n  }\n  let baseUrl;\n  if (options?.gateway) {\n    baseUrl = options.gateway.startsWith(\"https://\") ? options.gateway : `https://${options.gateway}`;\n  } else {\n    baseUrl = config.pinataGateway;\n  }\n  let newUrl = `${baseUrl}/files/${options.cid}`;\n  const params = new URLSearchParams();\n  if (imgOpts) {\n    if (imgOpts.width)\n      params.append(\"img-width\", imgOpts.width.toString());\n    if (imgOpts.height)\n      params.append(\"img-height\", imgOpts.height.toString());\n    if (imgOpts.dpr)\n      params.append(\"img-dpr\", imgOpts.dpr.toString());\n    if (imgOpts.fit)\n      params.append(\"img-fit\", imgOpts.fit);\n    if (imgOpts.gravity)\n      params.append(\"img-gravity\", imgOpts.gravity);\n    if (imgOpts.quality)\n      params.append(\"img-quality\", imgOpts.quality.toString());\n    if (imgOpts.format)\n      params.append(\"img-format\", imgOpts.format);\n    if (imgOpts.animation !== void 0)\n      params.append(\"img-anim\", imgOpts.animation.toString());\n    if (imgOpts.sharpen)\n      params.append(\"img-sharpen\", imgOpts.sharpen.toString());\n    if (imgOpts.onError === true)\n      params.append(\"img-onerror\", \"redirect\");\n    if (imgOpts.metadata)\n      params.append(\"img-metadata\", imgOpts.metadata);\n  }\n  const queryString = params.toString();\n  if (queryString) {\n    newUrl += `?${queryString}`;\n  }\n  const date = options?.date || Math.floor((/* @__PURE__ */ new Date()).getTime() / 1e3);\n  const payload = JSON.stringify({\n    url: newUrl,\n    date,\n    expires: options.expires,\n    method: \"GET\"\n  });\n  let endpoint = \"https://api.pinata.cloud/v3\";\n  if (config.endpointUrl) {\n    endpoint = config.endpointUrl;\n  }\n  let headers;\n  if (config.customHeaders && Object.keys(config.customHeaders).length > 0) {\n    headers = {\n      Authorization: `Bearer ${config.pinataJwt}`,\n      \"Content-Type\": \"application/json\",\n      ...config.customHeaders\n    };\n  } else {\n    headers = {\n      \"Content-Type\": \"application/json\",\n      Authorization: `Bearer ${config.pinataJwt}`,\n      Source: \"sdk/createSignURL\"\n    };\n  }\n  try {\n    const request = await fetch(`${endpoint}/files/sign`, {\n      method: \"POST\",\n      headers,\n      body: payload\n    });\n    if (!request.ok) {\n      const errorData = await request.text();\n      if (request.status === 401 || request.status === 403) {\n        throw new AuthenticationError(\n          `Authentication Failed: ${errorData}`,\n          request.status,\n          errorData\n        );\n      }\n      throw new NetworkError(\n        `HTTP error: ${errorData}`,\n        request.status,\n        errorData\n      );\n    }\n    const res = await request.json();\n    return res.data;\n  } catch (error) {\n    if (error instanceof PinataError) {\n      throw error;\n    }\n    if (error instanceof Error) {\n      throw new PinataError(\n        `Error processing createSignedURL: ${error.message}`\n      );\n    }\n    throw new PinataError(\"An unknown error occurred while getting signed url\");\n  }\n};\n\n// src/core/pinataSDK.ts\nvar formatConfig = (config) => {\n  let gateway = config?.pinataGateway;\n  if (config && gateway) {\n    if (gateway && !gateway.startsWith(\"https://\")) {\n      gateway = `https://${gateway}`;\n    }\n    config.pinataGateway = gateway;\n  }\n  return config;\n};\nvar PinataSDK = class {\n  //signatures: Signatures;\n  constructor(config) {\n    this.config = formatConfig(config);\n    this.files = new Files(this.config);\n    this.upload = new Upload(this.config);\n    this.gateways = new Gateways(this.config);\n    this.keys = new Keys(this.config);\n    this.groups = new Groups(this.config);\n    this.analytics = new Analytics(this.config);\n  }\n  setNewHeaders(headers) {\n    if (!this.config) {\n      this.config = { pinataJwt: \"\", customHeaders: {} };\n    }\n    this.config.customHeaders = { ...this.config.customHeaders, ...headers };\n    this.files.updateConfig(this.config);\n    this.upload.updateConfig(this.config);\n    this.gateways.updateConfig(this.config);\n    this.keys.updateConfig(this.config);\n    this.groups.updateConfig(this.config);\n    this.analytics.updateConfig(this.config);\n  }\n  setNewJwt(jwt) {\n    if (!this.config) {\n      this.config = { pinataJwt: \"\" };\n    }\n    this.config.pinataJwt = jwt;\n    this.files.updateConfig(this.config);\n    this.upload.updateConfig(this.config);\n    this.gateways.updateConfig(this.config);\n    this.keys.updateConfig(this.config);\n    this.groups.updateConfig(this.config);\n    this.analytics.updateConfig(this.config);\n  }\n  testAuthentication() {\n    return testAuthentication(this.config);\n  }\n};\nvar Files = class {\n  constructor(config) {\n    this.config = formatConfig(config);\n  }\n  updateConfig(newConfig) {\n    this.config = newConfig;\n  }\n  list() {\n    return new FilterFiles(this.config);\n  }\n  delete(files) {\n    return deleteFile(this.config, files);\n  }\n  update(options) {\n    return updateFile(this.config, options);\n  }\n  addSwap(options) {\n    return swapCid(this.config, options);\n  }\n  getSwapHistory(options) {\n    return swapHistory(this.config, options);\n  }\n  deleteSwap(cid) {\n    return deleteSwap(this.config, cid);\n  }\n};\nvar UploadBuilder = class {\n  constructor(config, uploadFunction, ...args) {\n    this.config = config;\n    this.uploadFunction = uploadFunction;\n    this.args = args;\n  }\n  addMetadata(metadata) {\n    this.metadata = metadata;\n    return this;\n  }\n  key(jwt) {\n    this.keys = jwt;\n    return this;\n  }\n  // cidVersion(v: 0 | 1): UploadBuilder<T> {\n  // \tthis.version = v;\n  // \treturn this;\n  // }\n  group(groupId) {\n    this.groupId = groupId;\n    return this;\n  }\n  then(onfulfilled, onrejected) {\n    const options = this.args[this.args.length - 1] || {};\n    if (this.metadata) {\n      options.metadata = this.metadata;\n    }\n    if (this.keys) {\n      options.keys = this.keys;\n    }\n    if (this.groupId) {\n      options.groupId = this.groupId;\n    }\n    this.args[this.args.length - 1] = options;\n    return this.uploadFunction(this.config, ...this.args).then(\n      onfulfilled,\n      onrejected\n    );\n  }\n};\nvar Upload = class {\n  constructor(config) {\n    this.config = formatConfig(config);\n  }\n  updateConfig(newConfig) {\n    this.config = newConfig;\n  }\n  file(file, options) {\n    return new UploadBuilder(this.config, uploadFile, file, options);\n  }\n  // fileArray(\n  // \tfiles: FileObject[],\n  // \toptions?: UploadOptions,\n  // ): UploadBuilder<UploadResponse> {\n  // \treturn new UploadBuilder(this.config, uploadFileArray, files, options);\n  // }\n  base64(base64String, options) {\n    return new UploadBuilder(this.config, uploadBase64, base64String, options);\n  }\n  url(url, options) {\n    return new UploadBuilder(this.config, uploadUrl, url, options);\n  }\n  json(data, options) {\n    return new UploadBuilder(this.config, uploadJson, data, options);\n  }\n};\nvar FilterFiles = class {\n  // rate limit vars\n  // private requestCount = 0;\n  // private lastRequestTime = 0;\n  // private readonly MAX_REQUESTS_PER_MINUTE = 30;\n  // private readonly MINUTE_IN_MS = 60000;\n  constructor(config) {\n    this.query = {};\n    this.config = config;\n  }\n  name(name) {\n    this.query.name = name;\n    return this;\n  }\n  group(group) {\n    this.query.group = group;\n    return this;\n  }\n  cid(cid) {\n    this.query.cid = cid;\n    return this;\n  }\n  mimeType(mimeType) {\n    this.query.mimeType = mimeType;\n    return this;\n  }\n  order(order) {\n    this.query.order = order;\n    return this;\n  }\n  limit(limit) {\n    this.query.limit = limit;\n    return this;\n  }\n  cidPending(cidPending) {\n    this.query.cidPending = cidPending;\n    return this;\n  }\n  metadata(keyvalues) {\n    this.query.metadata = keyvalues;\n    return this;\n  }\n  noGroup(noGroup) {\n    this.query.noGroup = noGroup;\n    return this;\n  }\n  pageToken(pageToken) {\n    this.query.pageToken = pageToken;\n    return this;\n  }\n  then(onfulfilled) {\n    return this.fetchPage().then(onfulfilled);\n  }\n  async fetchPage() {\n    if (this.currentPageToken) {\n      this.query.pageToken = this.currentPageToken;\n    }\n    const response = await listFiles(this.config, this.query);\n    this.currentPageToken = response.next_page_token;\n    return response;\n  }\n  // // rate limit, hopefully temporary?\n  // private async rateLimit(): Promise<void> {\n  // \tthis.requestCount++;\n  // \tconst now = Date.now();\n  // \tif (this.requestCount >= this.MAX_REQUESTS_PER_MINUTE) {\n  // \t\tconst timePassedSinceLastRequest = now - this.lastRequestTime;\n  // \t\tif (timePassedSinceLastRequest < this.MINUTE_IN_MS) {\n  // \t\t\tconst delayTime = this.MINUTE_IN_MS - timePassedSinceLastRequest;\n  // \t\t\tawait new Promise((resolve) => setTimeout(resolve, delayTime));\n  // \t\t}\n  // \t\tthis.requestCount = 0;\n  // \t}\n  // \tthis.lastRequestTime = Date.now();\n  // }\n  async *[Symbol.asyncIterator]() {\n    while (true) {\n      const items = await this.fetchPage();\n      for (const item of items.files) {\n        yield item;\n      }\n      if (!this.currentPageToken) {\n        break;\n      }\n    }\n  }\n  async all() {\n    const allItems = [];\n    for await (const item of this) {\n      allItems.push(item);\n    }\n    return allItems;\n  }\n};\nvar Gateways = class {\n  constructor(config) {\n    this.config = formatConfig(config);\n  }\n  updateConfig(newConfig) {\n    this.config = newConfig;\n  }\n  get(cid) {\n    return new OptimizeImageGetCid(this.config, cid);\n  }\n  createSignedURL(options) {\n    return new OptimizeImageCreateSignedURL(this.config, options);\n  }\n  // topUsageAnalytics(options: {\n  // \tdomain: string;\n  // \tstart: string;\n  // \tend: string;\n  // \tsortBy: \"requests\" | \"bandwidth\";\n  // \tattribute:\n  // \t\t| \"cid\"\n  // \t\t| \"country\"\n  // \t\t| \"region\"\n  // \t\t| \"user_agent\"\n  // \t\t| \"referer\"\n  // \t\t| \"file_name\";\n  // }): TopGatewayAnalyticsBuilder {\n  // \treturn new TopGatewayAnalyticsBuilder(\n  // \t\tthis.config,\n  // \t\toptions.domain,\n  // \t\toptions.start,\n  // \t\toptions.end,\n  // \t\toptions.sortBy,\n  // \t\toptions.attribute,\n  // \t);\n  // }\n  // dateIntervalAnalytics(options: {\n  // \tdomain: string;\n  // \tstart: string;\n  // \tend: string;\n  // \tinterval: \"day\" | \"week\";\n  // }): TimeIntervalGatewayAnalyticsBuilder {\n  // \treturn new TimeIntervalGatewayAnalyticsBuilder(\n  // \t\tthis.config,\n  // \t\toptions.domain,\n  // \t\toptions.start,\n  // \t\toptions.end,\n  // \t\toptions.interval,\n  // \t);\n  // }\n};\nvar OptimizeImageGetCid = class {\n  constructor(config, cid) {\n    this.options = {};\n    this.config = config;\n    this.cid = cid;\n  }\n  optimizeImage(options) {\n    this.options = { ...this.options, ...options };\n    return this;\n  }\n  then(onfulfilled) {\n    return getCid(this.config, this.cid, this.options).then(onfulfilled);\n  }\n};\nvar OptimizeImageCreateSignedURL = class {\n  constructor(config, urlOpts) {\n    this.imgOpts = {};\n    this.config = config;\n    this.urlOpts = urlOpts;\n  }\n  optimizeImage(options) {\n    this.imgOpts = { ...this.imgOpts, ...options };\n    return this;\n  }\n  then(onfulfilled) {\n    return createSignedURL(this.config, this.urlOpts, this.imgOpts).then(\n      onfulfilled\n    );\n  }\n};\nvar Keys = class {\n  constructor(config) {\n    this.config = formatConfig(config);\n  }\n  updateConfig(newConfig) {\n    this.config = newConfig;\n  }\n  create(options) {\n    return createKey(this.config, options);\n  }\n  list() {\n    return new FilterKeys(this.config);\n  }\n  revoke(keys) {\n    return revokeKeys(this.config, keys);\n  }\n};\nvar FilterKeys = class {\n  // rate limit vars\n  // private requestCount = 0;\n  // private lastRequestTime = 0;\n  // private readonly MAX_REQUESTS_PER_MINUTE = 30;\n  // private readonly MINUTE_IN_MS = 60000;\n  constructor(config) {\n    this.query = {};\n    this.config = config;\n  }\n  offset(offset) {\n    this.query.offset = offset;\n    return this;\n  }\n  revoked(revoked) {\n    this.query.revoked = revoked;\n    return this;\n  }\n  limitedUse(limitedUse) {\n    this.query.limitedUse = limitedUse;\n    return this;\n  }\n  exhausted(exhausted) {\n    this.query.exhausted = exhausted;\n    return this;\n  }\n  name(name) {\n    this.query.name = name;\n    return this;\n  }\n  then(onfulfilled) {\n    return listKeys(this.config, this.query).then(onfulfilled);\n  }\n  // private async rateLimit(): Promise<void> {\n  // \tthis.requestCount++;\n  // \tconst now = Date.now();\n  // \tif (this.requestCount >= this.MAX_REQUESTS_PER_MINUTE) {\n  // \t\tconst timePassedSinceLastRequest = now - this.lastRequestTime;\n  // \t\tif (timePassedSinceLastRequest < this.MINUTE_IN_MS) {\n  // \t\t\tconst delayTime = this.MINUTE_IN_MS - timePassedSinceLastRequest;\n  // \t\t\tawait new Promise((resolve) => setTimeout(resolve, delayTime));\n  // \t\t}\n  // \t\tthis.requestCount = 0;\n  // \t}\n  // \tthis.lastRequestTime = Date.now();\n  // }\n  async *[Symbol.asyncIterator]() {\n    let hasMore = true;\n    let offset = 0;\n    while (hasMore) {\n      this.query.offset = offset;\n      const items = await listKeys(this.config, this.query);\n      for (const item of items) {\n        yield item;\n      }\n      if (items.length === 0) {\n        hasMore = false;\n      } else {\n        offset += items.length;\n      }\n    }\n  }\n  async all() {\n    const allItems = [];\n    for await (const item of this) {\n      allItems.push(item);\n    }\n    return allItems;\n  }\n};\nvar Groups = class {\n  constructor(config) {\n    this.config = formatConfig(config);\n  }\n  updateConfig(newConfig) {\n    this.config = newConfig;\n  }\n  create(options) {\n    return createGroup(this.config, options);\n  }\n  list() {\n    return new FilterGroups(this.config);\n  }\n  get(options) {\n    return getGroup(this.config, options);\n  }\n  addFiles(options) {\n    return addToGroup(this.config, options);\n  }\n  removeFiles(options) {\n    return removeFromGroup(this.config, options);\n  }\n  update(options) {\n    return updateGroup(this.config, options);\n  }\n  delete(options) {\n    return deleteGroup(this.config, options);\n  }\n};\nvar FilterGroups = class {\n  constructor(config) {\n    this.query = {};\n    this.config = config;\n  }\n  name(name) {\n    this.query.name = name;\n    return this;\n  }\n  limit(limit) {\n    this.query.limit = limit;\n    return this;\n  }\n  isPublic(isPublic) {\n    this.query.isPublic = isPublic;\n    return this;\n  }\n  pageToken(pageToken) {\n    this.query.pageToken = pageToken;\n    return this;\n  }\n  then(onfulfilled) {\n    return this.fetchPage().then((response) => {\n      this.nextPageToken = response.next_page_token;\n      return response;\n    }).then(onfulfilled);\n  }\n  async fetchPage() {\n    if (this.nextPageToken) {\n      this.query.pageToken = this.nextPageToken;\n    }\n    return listGroups(this.config, this.query);\n  }\n  // rate limit, hopefully temporary?\n  // private async rateLimit(): Promise<void> {\n  // \tthis.requestCount++;\n  // \tconst now = Date.now();\n  // \tif (this.requestCount >= this.MAX_REQUESTS_PER_MINUTE) {\n  // \t\tconst timePassedSinceLastRequest = now - this.lastRequestTime;\n  // \t\tif (timePassedSinceLastRequest < this.MINUTE_IN_MS) {\n  // \t\t\tconst delayTime = this.MINUTE_IN_MS - timePassedSinceLastRequest;\n  // \t\t\tawait new Promise((resolve) => setTimeout(resolve, delayTime));\n  // \t\t}\n  // \t\tthis.requestCount = 0;\n  // \t}\n  // \tthis.lastRequestTime = Date.now();\n  // }\n  async *[Symbol.asyncIterator]() {\n    while (true) {\n      const response = await this.fetchPage();\n      for (const item of response.groups) {\n        yield item;\n      }\n      if (!response.next_page_token) {\n        break;\n      }\n      this.nextPageToken = response.next_page_token;\n    }\n  }\n  async all() {\n    const allItems = [];\n    for await (const item of this) {\n      allItems.push(item);\n    }\n    return allItems;\n  }\n};\nvar Analytics = class {\n  constructor(config) {\n    this.config = formatConfig(config);\n    this.requests = new AnalyticsRequests(this.config);\n    this.bandwidth = new AnalyticsBandwidth(this.config);\n  }\n  updateConfig(newConfig) {\n    this.config = newConfig;\n    this.requests.updateConfig(newConfig);\n    this.bandwidth.updateConfig(newConfig);\n  }\n  // detailed(options: {\n  // \tdomain: string;\n  // \tstart: string;\n  // \tend: string;\n  // \tsortBy: \"requests\" | \"bandwidth\";\n  // \tattribute:\n  // \t\t| \"cid\"\n  // \t\t| \"country\"\n  // \t\t| \"region\"\n  // \t\t| \"user_agent\"\n  // \t\t| \"referer\"\n  // \t\t| \"file_name\";\n  // }): TopAnalyticsBuilder {\n  // \treturn new TopAnalyticsBuilder(\n  // \t\tthis.config,\n  // \t\toptions.domain,\n  // \t\toptions.start,\n  // \t\toptions.end,\n  // \t\toptions.sortBy,\n  // \t\toptions.attribute,\n  // \t);\n  // }\n  summary(options) {\n    return new TimeIntervalAnalyticsBuilder(\n      this.config,\n      options.domain,\n      options.start,\n      options.end,\n      options.interval\n    );\n  }\n};\nvar calculateDates = (days) => {\n  const end = /* @__PURE__ */ new Date();\n  const start = /* @__PURE__ */ new Date();\n  start.setDate(start.getDate() - days);\n  return {\n    start: start.toISOString().split(\"T\")[0],\n    end: end.toISOString().split(\"T\")[0]\n  };\n};\nvar AnalyticsFilter = class {\n  constructor(config, domain, start, end) {\n    this.config = config;\n    this.query = {\n      gateway_domain: domain,\n      start_date: start,\n      end_date: end,\n      sort_by: \"requests\",\n      // Will be overridden in child classes\n      attribute: \"cid\"\n    };\n  }\n  cid(cid) {\n    this.query.attribute = \"cid\";\n    if (cid) {\n      this.query.cid = cid;\n    }\n    return this;\n  }\n  fileName(fileName) {\n    this.query.attribute = \"file_name\";\n    if (fileName) {\n      this.query.file_name = fileName;\n    }\n    return this;\n  }\n  userAgent(userAgent) {\n    this.query.attribute = \"user_agent\";\n    if (userAgent) {\n      this.query.user_agent = userAgent;\n    }\n    return this;\n  }\n  country(country) {\n    this.query.attribute = \"country\";\n    if (country) {\n      this.query.country = country;\n    }\n    return this;\n  }\n  region(region) {\n    this.query.attribute = \"region\";\n    if (region) {\n      this.query.region = region;\n    }\n    return this;\n  }\n  referer(referer) {\n    this.query.attribute = \"referer\";\n    if (referer) {\n      this.query.referer = referer;\n    }\n    return this;\n  }\n  limit(limit) {\n    this.query.limit = limit;\n    return this;\n  }\n  sort(order) {\n    this.query.sort_order = order;\n    return this;\n  }\n  days(numberOfDays) {\n    const { start, end } = calculateDates(numberOfDays);\n    this.query.start_date = start;\n    this.query.end_date = end;\n    return this;\n  }\n  then(onfulfilled) {\n    return analyticsTopUsage(this.config, this.query).then(onfulfilled);\n  }\n};\nvar AnalyticsRequests = class extends AnalyticsFilter {\n  constructor(config) {\n    super(config, \"\", \"\", \"\");\n    this.query.sort_by = \"requests\";\n  }\n  updateConfig(newConfig) {\n    this.config = newConfig;\n  }\n  customDates(start, end) {\n    if (start)\n      this.query.start_date = start;\n    if (end)\n      this.query.end_date = end;\n    return this;\n  }\n  from(domain) {\n    this.query.gateway_domain = domain;\n    return this;\n  }\n};\nvar AnalyticsBandwidth = class extends AnalyticsFilter {\n  constructor(config) {\n    super(config, \"\", \"\", \"\");\n    this.query.sort_by = \"bandwidth\";\n  }\n  updateConfig(newConfig) {\n    this.config = newConfig;\n  }\n  customDates(start, end) {\n    if (start)\n      this.query.start_date = start;\n    if (end)\n      this.query.end_date = end;\n    return this;\n  }\n  from(domain) {\n    this.query.gateway_domain = domain;\n    return this;\n  }\n};\nvar AnalyticsBuilder = class {\n  constructor(config, query) {\n    this.requestCount = 0;\n    this.lastRequestTime = 0;\n    this.MAX_REQUESTS_PER_MINUTE = 30;\n    this.MINUTE_IN_MS = 6e4;\n    this.config = config;\n    this.query = query;\n  }\n  cid(cid) {\n    this.query.cid = cid;\n    return this;\n  }\n  fileName(fileName) {\n    this.query.file_name = fileName;\n    return this;\n  }\n  userAgent(userAgent) {\n    this.query.user_agent = userAgent;\n    return this;\n  }\n  country(country) {\n    this.query.country = country;\n    return this;\n  }\n  region(region) {\n    this.query.region = region;\n    return this;\n  }\n  referer(referer) {\n    this.query.referer = referer;\n    return this;\n  }\n  limit(limit) {\n    this.query.limit = limit;\n    return this;\n  }\n  sort(order) {\n    this.query.sort_order = order;\n    return this;\n  }\n  // private async rateLimit(): Promise<void> {\n  // \tthis.requestCount++;\n  // \tconst now = Date.now();\n  // \tif (this.requestCount >= this.MAX_REQUESTS_PER_MINUTE) {\n  // \t\tconst timePassedSinceLastRequest = now - this.lastRequestTime;\n  // \t\tif (timePassedSinceLastRequest < this.MINUTE_IN_MS) {\n  // \t\t\tconst delayTime = this.MINUTE_IN_MS - timePassedSinceLastRequest;\n  // \t\t\tawait new Promise((resolve) => setTimeout(resolve, delayTime));\n  // \t\t}\n  // \t\tthis.requestCount = 0;\n  // \t}\n  // \tthis.lastRequestTime = Date.now();\n  // }\n  async getAnalytics() {\n    throw new Error(\"getAnalytics method must be implemented in derived class\");\n  }\n  then(onfulfilled) {\n    return this.getAnalytics().then(onfulfilled);\n  }\n};\nvar TimeIntervalAnalyticsBuilder = class extends AnalyticsBuilder {\n  constructor(config, domain, start, end, dateInterval) {\n    super(config, {\n      gateway_domain: domain,\n      start_date: start,\n      end_date: end,\n      date_interval: dateInterval\n    });\n  }\n  sortBy(sortBy) {\n    this.query.sort_by = sortBy;\n    return this;\n  }\n  async getAnalytics() {\n    return analyticsDateInterval(this.config, this.query);\n  }\n  async all() {\n    return this.getAnalytics();\n  }\n};\n\n//# sourceMappingURL=index.mjs.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvcGluYXRhL2Rpc3QvaW5kZXgubWpzIiwibWFwcGluZ3MiOiI7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0JBQStCLGlCQUFpQjtBQUNoRDtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0EsK0JBQStCLGlCQUFpQjtBQUNoRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1DQUFtQyxTQUFTO0FBQzVDO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQ0FBb0MsVUFBVTtBQUM5QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLFVBQVU7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0Q0FBNEMsY0FBYztBQUMxRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUMsSUFBSTtBQUNyQztBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0EsaUNBQWlDLElBQUk7QUFDckM7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQkFBK0IsV0FBVyxZQUFZLGdCQUFnQjtBQUN0RTtBQUNBLDhCQUE4QixzQkFBc0I7QUFDcEQ7QUFDQTtBQUNBLCtCQUErQixpREFBaUQ7QUFDaEY7QUFDQSxrQ0FBa0MsU0FBUztB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Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSxhQUFhO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0U7QUFDRiIsInNvdXJjZXMiOlsiL2hvbWUvbXVoYW1tZWQtc2FpbmFsL1ZPTk5VRS9UQVNLUy9ldmVudC1tYW5hZ2VtZW50L25vZGVfbW9kdWxlcy9waW5hdGEvZGlzdC9pbmRleC5tanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gc3JjL3V0aWxzL2N1c3RvbS1lcnJvcnMudHNcbnZhciBQaW5hdGFFcnJvciA9IGNsYXNzIGV4dGVuZHMgRXJyb3Ige1xuICBjb25zdHJ1Y3RvcihtZXNzYWdlLCBzdGF0dXNDb2RlLCBkZXRhaWxzKSB7XG4gICAgc3VwZXIobWVzc2FnZSk7XG4gICAgdGhpcy5zdGF0dXNDb2RlID0gc3RhdHVzQ29kZTtcbiAgICB0aGlzLmRldGFpbHMgPSBkZXRhaWxzO1xuICAgIHRoaXMubmFtZSA9IFwiUGluYXRhRXJyb3JcIjtcbiAgfVxufTtcbnZhciBOZXR3b3JrRXJyb3IgPSBjbGFzcyBleHRlbmRzIFBpbmF0YUVycm9yIHtcbiAgY29uc3RydWN0b3IobWVzc2FnZSwgc3RhdHVzQ29kZSwgZGV0YWlscykge1xuICAgIHN1cGVyKG1lc3NhZ2UsIHN0YXR1c0NvZGUsIGRldGFpbHMpO1xuICAgIHRoaXMubmFtZSA9IFwiTmV0d29ya0Vycm9yXCI7XG4gIH1cbn07XG52YXIgQXV0aGVudGljYXRpb25FcnJvciA9IGNsYXNzIGV4dGVuZHMgUGluYXRhRXJyb3Ige1xuICBjb25zdHJ1Y3RvcihtZXNzYWdlLCBzdGF0dXNDb2RlLCBkZXRhaWxzKSB7XG4gICAgc3VwZXIobWVzc2FnZSwgc3RhdHVzQ29kZSwgZGV0YWlscyk7XG4gICAgdGhpcy5uYW1lID0gXCJBdXRoZW50aWNhdGlvbkVycm9yXCI7XG4gIH1cbn07XG52YXIgVmFsaWRhdGlvbkVycm9yID0gY2xhc3MgZXh0ZW5kcyBQaW5hdGFFcnJvciB7XG4gIGNvbnN0cnVjdG9yKG1lc3NhZ2UsIGRldGFpbHMpIHtcbiAgICBzdXBlcihtZXNzYWdlLCB2b2lkIDAsIGRldGFpbHMpO1xuICAgIHRoaXMubmFtZSA9IFwiVmFsaWRhdGlvbkVycm9yXCI7XG4gIH1cbn07XG5cbi8vIHNyYy9jb3JlL2F1dGhlbnRpY2F0aW9uL3Rlc3RBdXRoZW50aWNhdGlvbi50c1xudmFyIHRlc3RBdXRoZW50aWNhdGlvbiA9IGFzeW5jIChjb25maWcpID0+IHtcbiAgaWYgKCFjb25maWcpIHtcbiAgICB0aHJvdyBuZXcgVmFsaWRhdGlvbkVycm9yKFwiUGluYXRhIGNvbmZpZ3VyYXRpb24gaXMgbWlzc2luZ1wiKTtcbiAgfVxuICBsZXQgaGVhZGVycztcbiAgbGV0IGVuZHBvaW50ID0gXCJodHRwczovL2FwaS5waW5hdGEuY2xvdWRcIjtcbiAgaWYgKGNvbmZpZy5lbmRwb2ludFVybCkge1xuICAgIGVuZHBvaW50ID0gY29uZmlnLmVuZHBvaW50VXJsO1xuICB9XG4gIGlmIChjb25maWcuY3VzdG9tSGVhZGVycyAmJiBPYmplY3Qua2V5cyhjb25maWcuY3VzdG9tSGVhZGVycykubGVuZ3RoID4gMCkge1xuICAgIGhlYWRlcnMgPSB7XG4gICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7Y29uZmlnLnBpbmF0YUp3dH1gLFxuICAgICAgLi4uY29uZmlnLmN1c3RvbUhlYWRlcnNcbiAgICB9O1xuICB9IGVsc2Uge1xuICAgIGhlYWRlcnMgPSB7XG4gICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7Y29uZmlnLnBpbmF0YUp3dH1gLFxuICAgICAgU291cmNlOiBcInNkay90ZXN0QXV0aGVudGljYXRpb25cIlxuICAgIH07XG4gIH1cbiAgdHJ5IHtcbiAgICBjb25zdCByZXF1ZXN0ID0gYXdhaXQgZmV0Y2goYCR7ZW5kcG9pbnR9L2RhdGEvdGVzdEF1dGhlbnRpY2F0aW9uYCwge1xuICAgICAgbWV0aG9kOiBcIkdFVFwiLFxuICAgICAgaGVhZGVyc1xuICAgIH0pO1xuICAgIGlmICghcmVxdWVzdC5vaykge1xuICAgICAgY29uc3QgZXJyb3JEYXRhID0gYXdhaXQgcmVxdWVzdC50ZXh0KCk7XG4gICAgICBpZiAocmVxdWVzdC5zdGF0dXMgPT09IDQwMSB8fCByZXF1ZXN0LnN0YXR1cyA9PT0gNDAzKSB7XG4gICAgICAgIHRocm93IG5ldyBBdXRoZW50aWNhdGlvbkVycm9yKFxuICAgICAgICAgIGBBdXRoZW50aWNhdGlvbiBmYWlsZWQ6ICR7ZXJyb3JEYXRhfWAsXG4gICAgICAgICAgcmVxdWVzdC5zdGF0dXMsXG4gICAgICAgICAgZXJyb3JEYXRhXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgICB0aHJvdyBuZXcgTmV0d29ya0Vycm9yKFxuICAgICAgICBgSFRUUCBlcnJvcjogJHtlcnJvckRhdGF9YCxcbiAgICAgICAgcmVxdWVzdC5zdGF0dXMsXG4gICAgICAgIGVycm9yRGF0YVxuICAgICAgKTtcbiAgICB9XG4gICAgY29uc3QgcmVzID0gYXdhaXQgcmVxdWVzdC5qc29uKCk7XG4gICAgcmV0dXJuIHJlcztcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBQaW5hdGFFcnJvcikge1xuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIEVycm9yKSB7XG4gICAgICB0aHJvdyBuZXcgUGluYXRhRXJyb3IoXG4gICAgICAgIGBFcnJvciBwcm9jZXNzaW5nIGF1dGhlbnRpY2F0aW9uOiAke2Vycm9yLm1lc3NhZ2V9YFxuICAgICAgKTtcbiAgICB9XG4gICAgdGhyb3cgbmV3IFBpbmF0YUVycm9yKFxuICAgICAgXCJBbiB1bmtub3duIGVycm9yIG9jY3VycmVkIHdoaWxlIHRlc3RpbmcgYXV0aGVudGljYXRpb25cIlxuICAgICk7XG4gIH1cbn07XG5cbi8vIHNyYy91dGlscy9yZXN1bWFibGUudHNcbmZ1bmN0aW9uIGdldEZpbGVJZEZyb21VcmwodXJsKSB7XG4gIGNvbnN0IG1hdGNoID0gdXJsLm1hdGNoKC9cXC9maWxlc1xcLyhbXlxcL10rKS8pO1xuICBpZiAobWF0Y2ggJiYgbWF0Y2hbMV0pIHtcbiAgICByZXR1cm4gbWF0Y2hbMV07XG4gIH1cbiAgdGhyb3cgbmV3IE5ldHdvcmtFcnJvcihcIkZpbGUgSUQgbm90IGZvdW5kIGluIFVSTFwiLCA0MDAsIHVybCk7XG59XG5cbi8vIHNyYy9jb3JlL3VwbG9hZHMvZmlsZS50c1xudmFyIHVwbG9hZEZpbGUgPSBhc3luYyAoY29uZmlnLCBmaWxlLCBvcHRpb25zKSA9PiB7XG4gIGlmICghY29uZmlnKSB7XG4gICAgdGhyb3cgbmV3IFZhbGlkYXRpb25FcnJvcihcIlBpbmF0YSBjb25maWd1cmF0aW9uIGlzIG1pc3NpbmdcIik7XG4gIH1cbiAgY29uc3Qgand0ID0gb3B0aW9ucz8ua2V5cyB8fCBjb25maWcucGluYXRhSnd0O1xuICBsZXQgZW5kcG9pbnQgPSBcImh0dHBzOi8vdXBsb2Fkcy5waW5hdGEuY2xvdWQvdjNcIjtcbiAgaWYgKGNvbmZpZy51cGxvYWRVcmwpIHtcbiAgICBlbmRwb2ludCA9IGNvbmZpZy51cGxvYWRVcmw7XG4gIH1cbiAgaWYgKGZpbGUuc2l6ZSA+IDk0MzcxODQwKSB7XG4gICAgbGV0IGhlYWRlcnMyO1xuICAgIGlmIChjb25maWcuY3VzdG9tSGVhZGVycyAmJiBPYmplY3Qua2V5cyhjb25maWcuY3VzdG9tSGVhZGVycykubGVuZ3RoID4gMCkge1xuICAgICAgaGVhZGVyczIgPSB7XG4gICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHtqd3R9YCxcbiAgICAgICAgLi4uY29uZmlnLmN1c3RvbUhlYWRlcnNcbiAgICAgIH07XG4gICAgfSBlbHNlIHtcbiAgICAgIGhlYWRlcnMyID0ge1xuICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7and0fWAsXG4gICAgICAgIFNvdXJjZTogXCJzZGsvZmlsZVwiXG4gICAgICB9O1xuICAgIH1cbiAgICBjb25zdCBuYW1lID0gb3B0aW9ucz8ubWV0YWRhdGE/Lm5hbWUgfHwgZmlsZS5uYW1lIHx8IFwiRmlsZSBmcm9tIFNES1wiO1xuICAgIGxldCBtZXRhZGF0YSA9IGBmaWxlbmFtZSAke2J0b2EobmFtZSl9LGZpbGV0eXBlICR7YnRvYShmaWxlLnR5cGUpfWA7XG4gICAgaWYgKG9wdGlvbnM/Lmdyb3VwSWQpIHtcbiAgICAgIG1ldGFkYXRhICsgYCxncm91cF9pZCAke2J0b2Eob3B0aW9ucy5ncm91cElkKX1gO1xuICAgIH1cbiAgICBpZiAob3B0aW9ucz8ubWV0YWRhdGE/LmtleXZhbHVlcykge1xuICAgICAgbWV0YWRhdGEgKyBgLGtleXZhbHVlcyAke2J0b2EoSlNPTi5zdHJpbmdpZnkob3B0aW9ucy5tZXRhZGF0YS5rZXl2YWx1ZXMpKX1gO1xuICAgIH1cbiAgICBjb25zdCB1cmxSZXEgPSBhd2FpdCBmZXRjaChgJHtlbmRwb2ludH0vZmlsZXNgLCB7XG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICBcIlVwbG9hZC1MZW5ndGhcIjogYCR7ZmlsZS5zaXplfWAsXG4gICAgICAgIFwiVXBsb2FkLU1ldGFkYXRhXCI6IG1ldGFkYXRhLFxuICAgICAgICAuLi5oZWFkZXJzMlxuICAgICAgfVxuICAgIH0pO1xuICAgIGNvbnN0IHVybCA9IHVybFJlcS5oZWFkZXJzLmdldChcIkxvY2F0aW9uXCIpO1xuICAgIGlmICghdXJsKSB7XG4gICAgICB0aHJvdyBuZXcgTmV0d29ya0Vycm9yKFwiVXBsb2FkIFVSTCBub3QgcHJvdmlkZWRcIiwgdXJsUmVxLnN0YXR1cywgXCJcIik7XG4gICAgfVxuICAgIGNvbnN0IGNodW5rU2l6ZSA9IDUwICogMTAyNCAqIDEwMjQ7XG4gICAgY29uc3QgdG90YWxDaHVua3MgPSBNYXRoLmNlaWwoZmlsZS5zaXplIC8gY2h1bmtTaXplKTtcbiAgICBsZXQgb2Zmc2V0ID0gMDtcbiAgICBsZXQgdXBsb2FkUmVxO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdG90YWxDaHVua3M7IGkrKykge1xuICAgICAgY29uc3QgY2h1bmsgPSBmaWxlLnNsaWNlKG9mZnNldCwgb2Zmc2V0ICsgY2h1bmtTaXplKTtcbiAgICAgIHVwbG9hZFJlcSA9IGF3YWl0IGZldGNoKHVybCwge1xuICAgICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vb2Zmc2V0K29jdGV0LXN0cmVhbVwiLFxuICAgICAgICAgIFwiVXBsb2FkLU9mZnNldFwiOiBvZmZzZXQudG9TdHJpbmcoKSxcbiAgICAgICAgICAuLi5oZWFkZXJzMlxuICAgICAgICB9LFxuICAgICAgICBib2R5OiBjaHVua1xuICAgICAgfSk7XG4gICAgICBpZiAoIXVwbG9hZFJlcS5vaykge1xuICAgICAgICBjb25zdCBlcnJvckRhdGEgPSBhd2FpdCB1cGxvYWRSZXEudGV4dCgpO1xuICAgICAgICB0aHJvdyBuZXcgTmV0d29ya0Vycm9yKFxuICAgICAgICAgIGBIVFRQIGVycm9yIGR1cmluZyBjaHVuayB1cGxvYWQ6ICR7ZXJyb3JEYXRhfWAsXG4gICAgICAgICAgdXBsb2FkUmVxLnN0YXR1cyxcbiAgICAgICAgICBlcnJvckRhdGFcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICAgIG9mZnNldCArPSBjaHVuay5zaXplO1xuICAgIH1cbiAgICBpZiAodXBsb2FkUmVxLnN0YXR1cyA9PT0gMjA0KSB7XG4gICAgICBjb25zdCBmaWxlSWQgPSBnZXRGaWxlSWRGcm9tVXJsKHVybCk7XG4gICAgICBsZXQgZGF0YUVuZHBvaW50O1xuICAgICAgaWYgKGNvbmZpZy5lbmRwb2ludFVybCkge1xuICAgICAgICBkYXRhRW5kcG9pbnQgPSBjb25maWcuZW5kcG9pbnRVcmw7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBkYXRhRW5kcG9pbnQgPSBcImh0dHBzOi8vYXBpLnBpbmF0YS5jbG91ZC92M1wiO1xuICAgICAgfVxuICAgICAgY29uc3QgZmlsZUluZm9SZXEgPSBhd2FpdCBmZXRjaChgJHtkYXRhRW5kcG9pbnR9L2ZpbGVzLyR7ZmlsZUlkfWAsIHtcbiAgICAgICAgbWV0aG9kOiBcIkdFVFwiLFxuICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3Byb2Nlc3MuZW52LlBJTkFUQV9KV1R9YFxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIGNvbnN0IGZpbGVJbmZvID0gYXdhaXQgZmlsZUluZm9SZXEuanNvbigpO1xuICAgICAgY29uc3QgZGF0YTIgPSBmaWxlSW5mby5kYXRhO1xuICAgICAgcmV0dXJuIGRhdGEyO1xuICAgIH1cbiAgfVxuICBsZXQgaGVhZGVycztcbiAgaWYgKGNvbmZpZy5jdXN0b21IZWFkZXJzICYmIE9iamVjdC5rZXlzKGNvbmZpZy5jdXN0b21IZWFkZXJzKS5sZW5ndGggPiAwKSB7XG4gICAgaGVhZGVycyA9IHtcbiAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHtqd3R9YCxcbiAgICAgIC4uLmNvbmZpZy5jdXN0b21IZWFkZXJzXG4gICAgfTtcbiAgfSBlbHNlIHtcbiAgICBoZWFkZXJzID0ge1xuICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke2p3dH1gLFxuICAgICAgU291cmNlOiBcInNkay9maWxlXCJcbiAgICB9O1xuICB9XG4gIGNvbnN0IGRhdGEgPSBuZXcgRm9ybURhdGEoKTtcbiAgZGF0YS5hcHBlbmQoXCJmaWxlXCIsIGZpbGUsIGZpbGUubmFtZSk7XG4gIGRhdGEuYXBwZW5kKFwibmFtZVwiLCBvcHRpb25zPy5tZXRhZGF0YT8ubmFtZSB8fCBmaWxlLm5hbWUgfHwgXCJGaWxlIGZyb20gU0RLXCIpO1xuICBpZiAob3B0aW9ucz8uZ3JvdXBJZCkge1xuICAgIGRhdGEuYXBwZW5kKFwiZ3JvdXBfaWRcIiwgb3B0aW9ucy5ncm91cElkKTtcbiAgfVxuICBpZiAob3B0aW9ucz8ubWV0YWRhdGE/LmtleXZhbHVlcykge1xuICAgIGRhdGEuYXBwZW5kKFwia2V5dmFsdWVzXCIsIEpTT04uc3RyaW5naWZ5KG9wdGlvbnMubWV0YWRhdGEua2V5dmFsdWVzKSk7XG4gIH1cbiAgdHJ5IHtcbiAgICBjb25zdCByZXF1ZXN0ID0gYXdhaXQgZmV0Y2goYCR7ZW5kcG9pbnR9L2ZpbGVzYCwge1xuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgIGhlYWRlcnMsXG4gICAgICBib2R5OiBkYXRhXG4gICAgfSk7XG4gICAgaWYgKCFyZXF1ZXN0Lm9rKSB7XG4gICAgICBjb25zdCBlcnJvckRhdGEgPSBhd2FpdCByZXF1ZXN0LnRleHQoKTtcbiAgICAgIGlmIChyZXF1ZXN0LnN0YXR1cyA9PT0gNDAxIHx8IHJlcXVlc3Quc3RhdHVzID09PSA0MDMpIHtcbiAgICAgICAgdGhyb3cgbmV3IEF1dGhlbnRpY2F0aW9uRXJyb3IoXG4gICAgICAgICAgYEF1dGhlbnRpY2F0aW9uIGZhaWxlZDogJHtlcnJvckRhdGF9YCxcbiAgICAgICAgICByZXF1ZXN0LnN0YXR1cyxcbiAgICAgICAgICBlcnJvckRhdGFcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICAgIHRocm93IG5ldyBOZXR3b3JrRXJyb3IoXG4gICAgICAgIGBIVFRQIGVycm9yOiAke2Vycm9yRGF0YX1gLFxuICAgICAgICByZXF1ZXN0LnN0YXR1cyxcbiAgICAgICAgZXJyb3JEYXRhXG4gICAgICApO1xuICAgIH1cbiAgICBjb25zdCByZXMgPSBhd2FpdCByZXF1ZXN0Lmpzb24oKTtcbiAgICBjb25zdCByZXNEYXRhID0gcmVzLmRhdGE7XG4gICAgcmV0dXJuIHJlc0RhdGE7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgaWYgKGVycm9yIGluc3RhbmNlb2YgUGluYXRhRXJyb3IpIHtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBFcnJvcikge1xuICAgICAgdGhyb3cgbmV3IFBpbmF0YUVycm9yKGBFcnJvciB1cGxvYWRpbmcgZmlsZTogJHtlcnJvci5tZXNzYWdlfWApO1xuICAgIH1cbiAgICB0aHJvdyBuZXcgUGluYXRhRXJyb3IoXCJBbiB1bmtub3duIGVycm9yIG9jY3VycmVkIHdoaWxlIHVwbG9hZGluZyB0aGUgZmlsZVwiKTtcbiAgfVxufTtcblxuLy8gc3JjL2NvcmUvdXBsb2Fkcy9iYXNlNjQudHNcbnZhciB1cGxvYWRCYXNlNjQgPSBhc3luYyAoY29uZmlnLCBiYXNlNjRTdHJpbmcsIG9wdGlvbnMpID0+IHtcbiAgaWYgKCFjb25maWcpIHtcbiAgICB0aHJvdyBuZXcgVmFsaWRhdGlvbkVycm9yKFwiUGluYXRhIGNvbmZpZ3VyYXRpb24gaXMgbWlzc2luZ1wiKTtcbiAgfVxuICBjb25zdCBqd3QgPSBvcHRpb25zPy5rZXlzIHx8IGNvbmZpZz8ucGluYXRhSnd0O1xuICBjb25zdCBuYW1lID0gb3B0aW9ucz8ubWV0YWRhdGE/Lm5hbWUgPyBvcHRpb25zPy5tZXRhZGF0YT8ubmFtZSA6IFwiYmFzZTY0IHN0cmluZ1wiO1xuICBjb25zdCBidWZmZXIgPSBCdWZmZXIuZnJvbShiYXNlNjRTdHJpbmcsIFwiYmFzZTY0XCIpO1xuICBjb25zdCBibG9iID0gbmV3IEJsb2IoW2J1ZmZlcl0pO1xuICBjb25zdCBkYXRhID0gbmV3IEZvcm1EYXRhKCk7XG4gIGRhdGEuYXBwZW5kKFwiZmlsZVwiLCBibG9iLCBuYW1lKTtcbiAgZGF0YS5hcHBlbmQoXCJuYW1lXCIsIG5hbWUpO1xuICBpZiAob3B0aW9ucz8uZ3JvdXBJZCkge1xuICAgIGRhdGEuYXBwZW5kKFwiZ3JvdXBfaWRcIiwgb3B0aW9ucy5ncm91cElkKTtcbiAgfVxuICBpZiAob3B0aW9ucz8ubWV0YWRhdGE/LmtleXZhbHVlcykge1xuICAgIGRhdGEuYXBwZW5kKFwia2V5dmFsdWVzXCIsIEpTT04uc3RyaW5naWZ5KG9wdGlvbnMubWV0YWRhdGEua2V5dmFsdWVzKSk7XG4gIH1cbiAgbGV0IGhlYWRlcnM7XG4gIGlmIChjb25maWcuY3VzdG9tSGVhZGVycyAmJiBPYmplY3Qua2V5cyhjb25maWcuY3VzdG9tSGVhZGVycykubGVuZ3RoID4gMCkge1xuICAgIGhlYWRlcnMgPSB7XG4gICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7and0fWAsXG4gICAgICAuLi5jb25maWcuY3VzdG9tSGVhZGVyc1xuICAgIH07XG4gIH0gZWxzZSB7XG4gICAgaGVhZGVycyA9IHtcbiAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHtqd3R9YCxcbiAgICAgIFNvdXJjZTogXCJzZGsvYmFzZTY0XCJcbiAgICB9O1xuICB9XG4gIGxldCBlbmRwb2ludCA9IFwiaHR0cHM6Ly91cGxvYWRzLnBpbmF0YS5jbG91ZC92M1wiO1xuICBpZiAoY29uZmlnLnVwbG9hZFVybCkge1xuICAgIGVuZHBvaW50ID0gY29uZmlnLnVwbG9hZFVybDtcbiAgfVxuICB0cnkge1xuICAgIGNvbnN0IHJlcXVlc3QgPSBhd2FpdCBmZXRjaChgJHtlbmRwb2ludH0vZmlsZXNgLCB7XG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgaGVhZGVycyxcbiAgICAgIGJvZHk6IGRhdGFcbiAgICB9KTtcbiAgICBpZiAoIXJlcXVlc3Qub2spIHtcbiAgICAgIGNvbnN0IGVycm9yRGF0YSA9IGF3YWl0IHJlcXVlc3QudGV4dCgpO1xuICAgICAgaWYgKHJlcXVlc3Quc3RhdHVzID09PSA0MDEgfHwgcmVxdWVzdC5zdGF0dXMgPT09IDQwMykge1xuICAgICAgICB0aHJvdyBuZXcgQXV0aGVudGljYXRpb25FcnJvcihcbiAgICAgICAgICBgQXV0aGVudGljYXRpb24gZmFpbGVkOiAke2Vycm9yRGF0YX1gLFxuICAgICAgICAgIHJlcXVlc3Quc3RhdHVzLFxuICAgICAgICAgIGVycm9yRGF0YVxuICAgICAgICApO1xuICAgICAgfVxuICAgICAgdGhyb3cgbmV3IE5ldHdvcmtFcnJvcihcbiAgICAgICAgYEhUVFAgZXJyb3I6ICR7ZXJyb3JEYXRhfWAsXG4gICAgICAgIHJlcXVlc3Quc3RhdHVzLFxuICAgICAgICBlcnJvckRhdGFcbiAgICAgICk7XG4gICAgfVxuICAgIGNvbnN0IHJlcyA9IGF3YWl0IHJlcXVlc3QuanNvbigpO1xuICAgIGNvbnN0IHJlc0RhdGEgPSByZXMuZGF0YTtcbiAgICByZXR1cm4gcmVzRGF0YTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBQaW5hdGFFcnJvcikge1xuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIEVycm9yKSB7XG4gICAgICB0aHJvdyBuZXcgUGluYXRhRXJyb3IoYEVycm9yIHByb2Nlc3NpbmcgYmFzZTY0OiAke2Vycm9yLm1lc3NhZ2V9YCk7XG4gICAgfVxuICAgIHRocm93IG5ldyBQaW5hdGFFcnJvcihcbiAgICAgIFwiQW4gdW5rbm93biBlcnJvciBvY2N1cnJlZCB3aGlsZSB0cnlpbmcgdG8gdXBsb2FkIGJhc2U2NFwiXG4gICAgKTtcbiAgfVxufTtcblxuLy8gc3JjL2NvcmUvdXBsb2Fkcy91cmwudHNcbnZhciB1cGxvYWRVcmwgPSBhc3luYyAoY29uZmlnLCB1cmwsIG9wdGlvbnMpID0+IHtcbiAgaWYgKCFjb25maWcpIHtcbiAgICB0aHJvdyBuZXcgVmFsaWRhdGlvbkVycm9yKFwiUGluYXRhIGNvbmZpZ3VyYXRpb24gaXMgbWlzc2luZ1wiKTtcbiAgfVxuICBjb25zdCBqd3QgPSBvcHRpb25zPy5rZXlzIHx8IGNvbmZpZz8ucGluYXRhSnd0O1xuICBjb25zdCBkYXRhID0gbmV3IEZvcm1EYXRhKCk7XG4gIGNvbnN0IHN0cmVhbSA9IGF3YWl0IGZldGNoKHVybCk7XG4gIGlmICghc3RyZWFtLm9rKSB7XG4gICAgY29uc3QgZXJyb3JEYXRhID0gYXdhaXQgc3RyZWFtLnRleHQoKTtcbiAgICB0aHJvdyBuZXcgTmV0d29ya0Vycm9yKFxuICAgICAgYEhUVFAgZXJyb3I6ICR7ZXJyb3JEYXRhfWAsXG4gICAgICBzdHJlYW0uc3RhdHVzLFxuICAgICAgZXJyb3JEYXRhXG4gICAgKTtcbiAgfVxuICBjb25zdCBhcnJheUJ1ZmZlciA9IGF3YWl0IHN0cmVhbS5hcnJheUJ1ZmZlcigpO1xuICBjb25zdCBibG9iID0gbmV3IEJsb2IoW2FycmF5QnVmZmVyXSk7XG4gIGNvbnN0IG5hbWUgPSBvcHRpb25zPy5tZXRhZGF0YT8ubmFtZSA/PyBcInVybF91cGxvYWRcIjtcbiAgY29uc3QgZmlsZSA9IG5ldyBGaWxlKFtibG9iXSwgbmFtZSk7XG4gIGRhdGEuYXBwZW5kKFwiZmlsZVwiLCBmaWxlLCBuYW1lKTtcbiAgZGF0YS5hcHBlbmQoXCJuYW1lXCIsIG5hbWUpO1xuICBpZiAob3B0aW9ucz8uZ3JvdXBJZCkge1xuICAgIGRhdGEuYXBwZW5kKFwiZ3JvdXBfaWRcIiwgb3B0aW9ucy5ncm91cElkKTtcbiAgfVxuICBpZiAob3B0aW9ucz8ubWV0YWRhdGE/LmtleXZhbHVlcykge1xuICAgIGRhdGEuYXBwZW5kKFwia2V5dmFsdWVzXCIsIEpTT04uc3RyaW5naWZ5KG9wdGlvbnMubWV0YWRhdGEua2V5dmFsdWVzKSk7XG4gIH1cbiAgbGV0IGhlYWRlcnM7XG4gIGlmIChjb25maWcuY3VzdG9tSGVhZGVycyAmJiBPYmplY3Qua2V5cyhjb25maWcuY3VzdG9tSGVhZGVycykubGVuZ3RoID4gMCkge1xuICAgIGhlYWRlcnMgPSB7XG4gICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7and0fWAsXG4gICAgICAuLi5jb25maWcuY3VzdG9tSGVhZGVyc1xuICAgIH07XG4gIH0gZWxzZSB7XG4gICAgaGVhZGVycyA9IHtcbiAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHtqd3R9YCxcbiAgICAgIFNvdXJjZTogXCJzZGsvdXJsXCJcbiAgICB9O1xuICB9XG4gIGxldCBlbmRwb2ludCA9IFwiaHR0cHM6Ly91cGxvYWRzLnBpbmF0YS5jbG91ZC92M1wiO1xuICBpZiAoY29uZmlnLnVwbG9hZFVybCkge1xuICAgIGVuZHBvaW50ID0gY29uZmlnLnVwbG9hZFVybDtcbiAgfVxuICB0cnkge1xuICAgIGNvbnN0IHJlcXVlc3QgPSBhd2FpdCBmZXRjaChgJHtlbmRwb2ludH0vZmlsZXNgLCB7XG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgaGVhZGVycyxcbiAgICAgIGJvZHk6IGRhdGFcbiAgICB9KTtcbiAgICBpZiAoIXJlcXVlc3Qub2spIHtcbiAgICAgIGNvbnN0IGVycm9yRGF0YSA9IGF3YWl0IHJlcXVlc3QudGV4dCgpO1xuICAgICAgaWYgKHJlcXVlc3Quc3RhdHVzID09PSA0MDEgfHwgcmVxdWVzdC5zdGF0dXMgPT09IDQwMykge1xuICAgICAgICB0aHJvdyBuZXcgQXV0aGVudGljYXRpb25FcnJvcihcbiAgICAgICAgICBgQXV0aGVudGljYXRpb24gZmFpbGVkOiAke2Vycm9yRGF0YX1gLFxuICAgICAgICAgIHJlcXVlc3Quc3RhdHVzLFxuICAgICAgICAgIGVycm9yRGF0YVxuICAgICAgICApO1xuICAgICAgfVxuICAgICAgdGhyb3cgbmV3IE5ldHdvcmtFcnJvcihcbiAgICAgICAgYEhUVFAgZXJyb3I6ICR7ZXJyb3JEYXRhfWAsXG4gICAgICAgIHJlcXVlc3Quc3RhdHVzLFxuICAgICAgICBlcnJvckRhdGFcbiAgICAgICk7XG4gICAgfVxuICAgIGNvbnN0IHJlcyA9IGF3YWl0IHJlcXVlc3QuanNvbigpO1xuICAgIGNvbnN0IHJlc0RhdGEgPSByZXMuZGF0YTtcbiAgICByZXR1cm4gcmVzRGF0YTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBQaW5hdGFFcnJvcikge1xuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIEVycm9yKSB7XG4gICAgICB0aHJvdyBuZXcgUGluYXRhRXJyb3IoYEVycm9yIHByb2Nlc3NpbmcgdXJsOiAke2Vycm9yLm1lc3NhZ2V9YCk7XG4gICAgfVxuICAgIHRocm93IG5ldyBQaW5hdGFFcnJvcihcIkFuIHVua25vd24gZXJyb3Igb2NjdXJyZWQgd2hpbGUgdXBsb2FkaW5nIGJ5IHVybFwiKTtcbiAgfVxufTtcblxuLy8gc3JjL2NvcmUvdXBsb2Fkcy9qc29uLnRzXG52YXIgdXBsb2FkSnNvbiA9IGFzeW5jIChjb25maWcsIGpzb25EYXRhLCBvcHRpb25zKSA9PiB7XG4gIGlmICghY29uZmlnKSB7XG4gICAgdGhyb3cgbmV3IFZhbGlkYXRpb25FcnJvcihcIlBpbmF0YSBjb25maWd1cmF0aW9uIGlzIG1pc3NpbmdcIik7XG4gIH1cbiAgY29uc3Qgand0ID0gb3B0aW9ucz8ua2V5cyB8fCBjb25maWc/LnBpbmF0YUp3dDtcbiAgY29uc3QganNvbiA9IEpTT04uc3RyaW5naWZ5KGpzb25EYXRhKTtcbiAgY29uc3QgYmxvYiA9IG5ldyBCbG9iKFtqc29uXSk7XG4gIGNvbnN0IGZpbGUgPSBuZXcgRmlsZShbYmxvYl0sIFwiZGF0YS5qc29uXCIsIHsgdHlwZTogXCJhcHBsaWNhdGlvbi9qc29uXCIgfSk7XG4gIGNvbnN0IGRhdGEgPSBuZXcgRm9ybURhdGEoKTtcbiAgZGF0YS5hcHBlbmQoXCJmaWxlXCIsIGZpbGUsIGZpbGUubmFtZSk7XG4gIGRhdGEuYXBwZW5kKFwibmFtZVwiLCBvcHRpb25zPy5tZXRhZGF0YT8ubmFtZSB8fCBmaWxlLm5hbWUgfHwgXCJGaWxlIGZyb20gU0RLXCIpO1xuICBpZiAob3B0aW9ucz8uZ3JvdXBJZCkge1xuICAgIGRhdGEuYXBwZW5kKFwiZ3JvdXBfaWRcIiwgb3B0aW9ucy5ncm91cElkKTtcbiAgfVxuICBpZiAob3B0aW9ucz8ubWV0YWRhdGE/LmtleXZhbHVlcykge1xuICAgIGRhdGEuYXBwZW5kKFwia2V5dmFsdWVzXCIsIEpTT04uc3RyaW5naWZ5KG9wdGlvbnMubWV0YWRhdGEua2V5dmFsdWVzKSk7XG4gIH1cbiAgbGV0IGhlYWRlcnM7XG4gIGlmIChjb25maWcuY3VzdG9tSGVhZGVycyAmJiBPYmplY3Qua2V5cyhjb25maWcuY3VzdG9tSGVhZGVycykubGVuZ3RoID4gMCkge1xuICAgIGhlYWRlcnMgPSB7XG4gICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7and0fWAsXG4gICAgICAuLi5jb25maWcuY3VzdG9tSGVhZGVyc1xuICAgIH07XG4gIH0gZWxzZSB7XG4gICAgaGVhZGVycyA9IHtcbiAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHtqd3R9YCxcbiAgICAgIFNvdXJjZTogXCJzZGsvanNvblwiXG4gICAgfTtcbiAgfVxuICBsZXQgZW5kcG9pbnQgPSBcImh0dHBzOi8vdXBsb2Fkcy5waW5hdGEuY2xvdWQvdjNcIjtcbiAgaWYgKGNvbmZpZy51cGxvYWRVcmwpIHtcbiAgICBlbmRwb2ludCA9IGNvbmZpZy51cGxvYWRVcmw7XG4gIH1cbiAgdHJ5IHtcbiAgICBjb25zdCByZXF1ZXN0ID0gYXdhaXQgZmV0Y2goYCR7ZW5kcG9pbnR9L2ZpbGVzYCwge1xuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgIGhlYWRlcnMsXG4gICAgICBib2R5OiBkYXRhXG4gICAgfSk7XG4gICAgaWYgKCFyZXF1ZXN0Lm9rKSB7XG4gICAgICBjb25zdCBlcnJvckRhdGEgPSBhd2FpdCByZXF1ZXN0LnRleHQoKTtcbiAgICAgIGlmIChyZXF1ZXN0LnN0YXR1cyA9PT0gNDAxIHx8IHJlcXVlc3Quc3RhdHVzID09PSA0MDMpIHtcbiAgICAgICAgdGhyb3cgbmV3IEF1dGhlbnRpY2F0aW9uRXJyb3IoXG4gICAgICAgICAgYEF1dGhlbnRpY2F0aW9uIGZhaWxlZDogJHtlcnJvckRhdGF9YCxcbiAgICAgICAgICByZXF1ZXN0LnN0YXR1cyxcbiAgICAgICAgICBlcnJvckRhdGFcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICAgIHRocm93IG5ldyBOZXR3b3JrRXJyb3IoXG4gICAgICAgIGBIVFRQIGVycm9yOiAke2Vycm9yRGF0YX1gLFxuICAgICAgICByZXF1ZXN0LnN0YXR1cyxcbiAgICAgICAgZXJyb3JEYXRhXG4gICAgICApO1xuICAgIH1cbiAgICBjb25zdCByZXMgPSBhd2FpdCByZXF1ZXN0Lmpzb24oKTtcbiAgICBjb25zdCByZXNEYXRhID0gcmVzLmRhdGE7XG4gICAgcmV0dXJuIHJlc0RhdGE7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgaWYgKGVycm9yIGluc3RhbmNlb2YgUGluYXRhRXJyb3IpIHtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBFcnJvcikge1xuICAgICAgdGhyb3cgbmV3IFBpbmF0YUVycm9yKGBFcnJvciBwcm9jZXNzaW5nIGpzb246ICR7ZXJyb3IubWVzc2FnZX1gKTtcbiAgICB9XG4gICAgdGhyb3cgbmV3IFBpbmF0YUVycm9yKFwiQW4gdW5rbm93biBlcnJvciBvY2N1cnJlZCB3aGlsZSB1cGxvYWRpbmcganNvblwiKTtcbiAgfVxufTtcblxuLy8gc3JjL2NvcmUvZmlsZXMvZGVsZXRlLnRzXG52YXIgd2FpdCA9IChtaWxsaXNlY29uZHMpID0+IHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG4gICAgc2V0VGltZW91dChyZXNvbHZlLCBtaWxsaXNlY29uZHMpO1xuICB9KTtcbn07XG52YXIgZGVsZXRlRmlsZSA9IGFzeW5jIChjb25maWcsIGZpbGVzKSA9PiB7XG4gIGlmICghY29uZmlnKSB7XG4gICAgdGhyb3cgbmV3IFZhbGlkYXRpb25FcnJvcihcIlBpbmF0YSBjb25maWd1cmF0aW9uIGlzIG1pc3NpbmdcIik7XG4gIH1cbiAgY29uc3QgcmVzcG9uc2VzID0gW107XG4gIGxldCBoZWFkZXJzO1xuICBpZiAoY29uZmlnLmN1c3RvbUhlYWRlcnMgJiYgT2JqZWN0LmtleXMoY29uZmlnLmN1c3RvbUhlYWRlcnMpLmxlbmd0aCA+IDApIHtcbiAgICBoZWFkZXJzID0ge1xuICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke2NvbmZpZy5waW5hdGFKd3R9YCxcbiAgICAgIC4uLmNvbmZpZy5jdXN0b21IZWFkZXJzXG4gICAgfTtcbiAgfSBlbHNlIHtcbiAgICBoZWFkZXJzID0ge1xuICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke2NvbmZpZy5waW5hdGFKd3R9YCxcbiAgICAgIFNvdXJjZTogXCJzZGsvZGVsZXRlRmlsZVwiXG4gICAgfTtcbiAgfVxuICBsZXQgZW5kcG9pbnQgPSBcImh0dHBzOi8vYXBpLnBpbmF0YS5jbG91ZC92M1wiO1xuICBpZiAoY29uZmlnLmVuZHBvaW50VXJsKSB7XG4gICAgZW5kcG9pbnQgPSBjb25maWcuZW5kcG9pbnRVcmw7XG4gIH1cbiAgZm9yIChjb25zdCBpZCBvZiBmaWxlcykge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAke2VuZHBvaW50fS9maWxlcy8ke2lkfWAsIHtcbiAgICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgICAgICBoZWFkZXJzXG4gICAgICB9KTtcbiAgICAgIGF3YWl0IHdhaXQoMzAwKTtcbiAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgY29uc3QgZXJyb3JEYXRhID0gYXdhaXQgcmVzcG9uc2UudGV4dCgpO1xuICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSA0MDEpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgQXV0aGVudGljYXRpb25FcnJvcihcbiAgICAgICAgICAgIGBBdXRoZW50aWNhdGlvbiBmYWlsZWQ6ICR7ZXJyb3JEYXRhfWAsXG4gICAgICAgICAgICByZXNwb25zZS5zdGF0dXMsXG4gICAgICAgICAgICBlcnJvckRhdGFcbiAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICAgIHRocm93IG5ldyBOZXR3b3JrRXJyb3IoXG4gICAgICAgICAgYEhUVFAgZXJyb3I6ICR7ZXJyb3JEYXRhfWAsXG4gICAgICAgICAgcmVzcG9uc2Uuc3RhdHVzLFxuICAgICAgICAgIGVycm9yRGF0YVxuICAgICAgICApO1xuICAgICAgfVxuICAgICAgcmVzcG9uc2VzLnB1c2goe1xuICAgICAgICBpZCxcbiAgICAgICAgc3RhdHVzOiByZXNwb25zZS5zdGF0dXNUZXh0XG4gICAgICB9KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbGV0IGVycm9yTWVzc2FnZTtcbiAgICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIFBpbmF0YUVycm9yKSB7XG4gICAgICAgIGVycm9yTWVzc2FnZSA9IGVycm9yLm1lc3NhZ2U7XG4gICAgICB9IGVsc2UgaWYgKGVycm9yIGluc3RhbmNlb2YgRXJyb3IpIHtcbiAgICAgICAgZXJyb3JNZXNzYWdlID0gYEVycm9yIGRlbGV0aW5nIGZpbGUgJHtpZH06ICR7ZXJyb3IubWVzc2FnZX1gO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZXJyb3JNZXNzYWdlID0gYEFuIHVua25vd24gZXJyb3Igb2NjdXJyZWQgd2hpbGUgZGVsZXRpbmcgZmlsZSAke2lkfWA7XG4gICAgICB9XG4gICAgICByZXNwb25zZXMucHVzaCh7XG4gICAgICAgIGlkLFxuICAgICAgICBzdGF0dXM6IGVycm9yTWVzc2FnZVxuICAgICAgfSk7XG4gICAgfVxuICB9XG4gIHJldHVybiByZXNwb25zZXM7XG59O1xuXG4vLyBzcmMvY29yZS9maWxlcy9saXN0LnRzXG52YXIgbGlzdEZpbGVzID0gYXN5bmMgKGNvbmZpZywgb3B0aW9ucykgPT4ge1xuICBpZiAoIWNvbmZpZykge1xuICAgIHRocm93IG5ldyBWYWxpZGF0aW9uRXJyb3IoXCJQaW5hdGEgY29uZmlndXJhdGlvbiBpcyBtaXNzaW5nXCIpO1xuICB9XG4gIGNvbnN0IHBhcmFtcyA9IG5ldyBVUkxTZWFyY2hQYXJhbXMoKTtcbiAgaWYgKG9wdGlvbnMpIHtcbiAgICBjb25zdCB7XG4gICAgICBuYW1lLFxuICAgICAgZ3JvdXAsXG4gICAgICBjaWQsXG4gICAgICBvcmRlcixcbiAgICAgIGxpbWl0LFxuICAgICAgbWltZVR5cGUsXG4gICAgICBwYWdlVG9rZW4sXG4gICAgICBjaWRQZW5kaW5nLFxuICAgICAgbWV0YWRhdGEsXG4gICAgICBub0dyb3VwXG4gICAgfSA9IG9wdGlvbnM7XG4gICAgaWYgKGxpbWl0KVxuICAgICAgcGFyYW1zLmFwcGVuZChcImxpbWl0XCIsIGxpbWl0LnRvU3RyaW5nKCkpO1xuICAgIGlmIChuYW1lKVxuICAgICAgcGFyYW1zLmFwcGVuZChcIm5hbWVcIiwgbmFtZSk7XG4gICAgaWYgKGdyb3VwKVxuICAgICAgcGFyYW1zLmFwcGVuZChcImdyb3VwXCIsIGdyb3VwKTtcbiAgICBpZiAoY2lkKVxuICAgICAgcGFyYW1zLmFwcGVuZChcImNpZFwiLCBjaWQpO1xuICAgIGlmIChtaW1lVHlwZSlcbiAgICAgIHBhcmFtcy5hcHBlbmQoXCJtaW1lVHlwZVwiLCBtaW1lVHlwZSk7XG4gICAgaWYgKG9yZGVyKVxuICAgICAgcGFyYW1zLmFwcGVuZChcIm9yZGVyXCIsIG9yZGVyKTtcbiAgICBpZiAocGFnZVRva2VuKVxuICAgICAgcGFyYW1zLmFwcGVuZChcInBhZ2VUb2tlblwiLCBwYWdlVG9rZW4pO1xuICAgIGlmIChjaWRQZW5kaW5nKVxuICAgICAgcGFyYW1zLmFwcGVuZChcImNpZFBlbmRpbmdcIiwgXCJ0cnVlXCIpO1xuICAgIGlmIChub0dyb3VwKVxuICAgICAgcGFyYW1zLmFwcGVuZChcImdyb3VwXCIsIFwibnVsbFwiKTtcbiAgICBpZiAobWV0YWRhdGEgJiYgdHlwZW9mIG1ldGFkYXRhID09PSBcIm9iamVjdFwiKSB7XG4gICAgICBPYmplY3QuZW50cmllcyhtZXRhZGF0YSkuZm9yRWFjaCgoW2tleSwgdmFsdWVdKSA9PiB7XG4gICAgICAgIHBhcmFtcy5hcHBlbmQoYG1ldGFkYXRhWyR7a2V5fV1gLCB2YWx1ZS50b1N0cmluZygpKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuICBsZXQgZW5kcG9pbnQgPSBcImh0dHBzOi8vYXBpLnBpbmF0YS5jbG91ZC92M1wiO1xuICBpZiAoY29uZmlnLmVuZHBvaW50VXJsKSB7XG4gICAgZW5kcG9pbnQgPSBjb25maWcuZW5kcG9pbnRVcmw7XG4gIH1cbiAgY29uc3QgdXJsID0gYCR7ZW5kcG9pbnR9L2ZpbGVzPyR7cGFyYW1zLnRvU3RyaW5nKCl9YDtcbiAgdHJ5IHtcbiAgICBsZXQgaGVhZGVycztcbiAgICBpZiAoY29uZmlnLmN1c3RvbUhlYWRlcnMgJiYgT2JqZWN0LmtleXMoY29uZmlnLmN1c3RvbUhlYWRlcnMpLmxlbmd0aCA+IDApIHtcbiAgICAgIGhlYWRlcnMgPSB7XG4gICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHtjb25maWcucGluYXRhSnd0fWAsXG4gICAgICAgIC4uLmNvbmZpZy5jdXN0b21IZWFkZXJzXG4gICAgICB9O1xuICAgIH0gZWxzZSB7XG4gICAgICBoZWFkZXJzID0ge1xuICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7Y29uZmlnLnBpbmF0YUp3dH1gLFxuICAgICAgICBTb3VyY2U6IFwic2RrL2xpc3RGaWxlc1wiXG4gICAgICB9O1xuICAgIH1cbiAgICBjb25zdCByZXF1ZXN0ID0gYXdhaXQgZmV0Y2godXJsLCB7XG4gICAgICBtZXRob2Q6IFwiR0VUXCIsXG4gICAgICBoZWFkZXJzXG4gICAgfSk7XG4gICAgaWYgKCFyZXF1ZXN0Lm9rKSB7XG4gICAgICBjb25zdCBlcnJvckRhdGEgPSBhd2FpdCByZXF1ZXN0LnRleHQoKTtcbiAgICAgIGlmIChyZXF1ZXN0LnN0YXR1cyA9PT0gNDAxIHx8IHJlcXVlc3Quc3RhdHVzID09PSA0MDMpIHtcbiAgICAgICAgdGhyb3cgbmV3IEF1dGhlbnRpY2F0aW9uRXJyb3IoXG4gICAgICAgICAgYEF1dGhlbnRpY2F0aW9uIGZhaWxlZDogJHtlcnJvckRhdGF9YCxcbiAgICAgICAgICByZXF1ZXN0LnN0YXR1cyxcbiAgICAgICAgICBlcnJvckRhdGFcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICAgIHRocm93IG5ldyBOZXR3b3JrRXJyb3IoXG4gICAgICAgIGBIVFRQIGVycm9yOiAke2Vycm9yRGF0YX1gLFxuICAgICAgICByZXF1ZXN0LnN0YXR1cyxcbiAgICAgICAgZXJyb3JEYXRhXG4gICAgICApO1xuICAgIH1cbiAgICBjb25zdCByZXMgPSBhd2FpdCByZXF1ZXN0Lmpzb24oKTtcbiAgICBjb25zdCByZXNEYXRhID0gcmVzLmRhdGE7XG4gICAgcmV0dXJuIHJlc0RhdGE7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgaWYgKGVycm9yIGluc3RhbmNlb2YgUGluYXRhRXJyb3IpIHtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBFcnJvcikge1xuICAgICAgdGhyb3cgbmV3IFBpbmF0YUVycm9yKGBFcnJvciBwcm9jZXNzaW5nIGxpc3QgZmlsZXM6ICR7ZXJyb3IubWVzc2FnZX1gKTtcbiAgICB9XG4gICAgdGhyb3cgbmV3IFBpbmF0YUVycm9yKFwiQW4gdW5rbm93biBlcnJvciBvY2N1cnJlZCB3aGlsZSBsaXN0aW5nIGZpbGVzXCIpO1xuICB9XG59O1xuXG4vLyBzcmMvY29yZS9maWxlcy91cGRhdGVGaWxlLnRzXG52YXIgdXBkYXRlRmlsZSA9IGFzeW5jIChjb25maWcsIG9wdGlvbnMpID0+IHtcbiAgaWYgKCFjb25maWcpIHtcbiAgICB0aHJvdyBuZXcgVmFsaWRhdGlvbkVycm9yKFwiUGluYXRhIGNvbmZpZ3VyYXRpb24gaXMgbWlzc2luZ1wiKTtcbiAgfVxuICBpZiAoIW9wdGlvbnMubmFtZSAmJiAoIW9wdGlvbnMua2V5dmFsdWVzIHx8IE9iamVjdC5rZXlzKG9wdGlvbnMua2V5dmFsdWVzKS5sZW5ndGggPT09IDApKSB7XG4gICAgdGhyb3cgbmV3IFZhbGlkYXRpb25FcnJvcihcbiAgICAgIFwiQXQgbGVhc3Qgb25lIG9mICduYW1lJyBvciAna2V5dmFsdWVzJyBtdXN0IGJlIHByb3ZpZGVkXCJcbiAgICApO1xuICB9XG4gIGNvbnN0IGRhdGEgPSB7fTtcbiAgaWYgKG9wdGlvbnMubmFtZSAhPT0gdm9pZCAwKSB7XG4gICAgZGF0YS5uYW1lID0gb3B0aW9ucy5uYW1lO1xuICB9XG4gIGlmIChvcHRpb25zLmtleXZhbHVlcyAmJiBPYmplY3Qua2V5cyhvcHRpb25zLmtleXZhbHVlcykubGVuZ3RoID4gMCkge1xuICAgIGRhdGEua2V5dmFsdWVzID0gb3B0aW9ucy5rZXl2YWx1ZXM7XG4gIH1cbiAgY29uc3QgYm9keSA9IEpTT04uc3RyaW5naWZ5KGRhdGEpO1xuICBsZXQgaGVhZGVycztcbiAgaWYgKGNvbmZpZy5jdXN0b21IZWFkZXJzICYmIE9iamVjdC5rZXlzKGNvbmZpZy5jdXN0b21IZWFkZXJzKS5sZW5ndGggPiAwKSB7XG4gICAgaGVhZGVycyA9IHtcbiAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHtjb25maWcucGluYXRhSnd0fWAsXG4gICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgIC4uLmNvbmZpZy5jdXN0b21IZWFkZXJzXG4gICAgfTtcbiAgfSBlbHNlIHtcbiAgICBoZWFkZXJzID0ge1xuICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke2NvbmZpZy5waW5hdGFKd3R9YCxcbiAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgU291cmNlOiBcInNkay91cGRhdGVNZXRhZGF0YVwiXG4gICAgfTtcbiAgfVxuICBsZXQgZW5kcG9pbnQgPSBcImh0dHBzOi8vYXBpLnBpbmF0YS5jbG91ZC92M1wiO1xuICBpZiAoY29uZmlnLmVuZHBvaW50VXJsKSB7XG4gICAgZW5kcG9pbnQgPSBjb25maWcuZW5kcG9pbnRVcmw7XG4gIH1cbiAgdHJ5IHtcbiAgICBjb25zdCByZXF1ZXN0ID0gYXdhaXQgZmV0Y2goYCR7ZW5kcG9pbnR9L2ZpbGVzLyR7b3B0aW9ucy5pZH1gLCB7XG4gICAgICBtZXRob2Q6IFwiUFVUXCIsXG4gICAgICBoZWFkZXJzLFxuICAgICAgYm9keVxuICAgIH0pO1xuICAgIGlmICghcmVxdWVzdC5vaykge1xuICAgICAgY29uc3QgZXJyb3JEYXRhID0gYXdhaXQgcmVxdWVzdC50ZXh0KCk7XG4gICAgICBpZiAocmVxdWVzdC5zdGF0dXMgPT09IDQwMSB8fCByZXF1ZXN0LnN0YXR1cyA9PT0gNDAzKSB7XG4gICAgICAgIHRocm93IG5ldyBBdXRoZW50aWNhdGlvbkVycm9yKFxuICAgICAgICAgIGBBdXRoZW50aWNhdGlvbiBmYWlsZWQ6ICR7ZXJyb3JEYXRhfWAsXG4gICAgICAgICAgcmVxdWVzdC5zdGF0dXMsXG4gICAgICAgICAgZXJyb3JEYXRhXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgICB0aHJvdyBuZXcgTmV0d29ya0Vycm9yKFxuICAgICAgICBgSFRUUCBlcnJvcjogJHtlcnJvckRhdGF9YCxcbiAgICAgICAgcmVxdWVzdC5zdGF0dXMsXG4gICAgICAgIGVycm9yRGF0YVxuICAgICAgKTtcbiAgICB9XG4gICAgY29uc3QgcmVzID0gYXdhaXQgcmVxdWVzdC5qc29uKCk7XG4gICAgY29uc3QgcmVzRGF0YSA9IHJlcy5kYXRhO1xuICAgIHJldHVybiByZXNEYXRhO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIFBpbmF0YUVycm9yKSB7XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gICAgaWYgKGVycm9yIGluc3RhbmNlb2YgRXJyb3IpIHtcbiAgICAgIHRocm93IG5ldyBQaW5hdGFFcnJvcihgRXJyb3IgcHJvY2Vzc2luZyB1cGRhdGVGaWxlOiAke2Vycm9yLm1lc3NhZ2V9YCk7XG4gICAgfVxuICAgIHRocm93IG5ldyBQaW5hdGFFcnJvcihcIkFuIHVua25vd24gZXJyb3Igb2NjdXJyZWQgd2hpbGUgdXBkYXRpbmcgZmlsZVwiKTtcbiAgfVxufTtcblxuLy8gc3JjL2NvcmUvZ2F0ZXdheS9nZXRDaWQudHNcbnZhciBnZXRDaWQgPSBhc3luYyAoY29uZmlnLCBjaWQsIG9wdGlvbnMpID0+IHtcbiAgaWYgKCFjb25maWcpIHtcbiAgICB0aHJvdyBuZXcgVmFsaWRhdGlvbkVycm9yKFwiUGluYXRhIGNvbmZpZ3VyYXRpb24gaXMgbWlzc2luZ1wiKTtcbiAgfVxuICBsZXQgZGF0YTtcbiAgbGV0IG5ld1VybCA9IGAke2NvbmZpZz8ucGluYXRhR2F0ZXdheX0vZmlsZXMvJHtjaWR9YDtcbiAgY29uc3QgcGFyYW1zID0gbmV3IFVSTFNlYXJjaFBhcmFtcygpO1xuICBpZiAob3B0aW9ucykge1xuICAgIGlmIChvcHRpb25zLndpZHRoKVxuICAgICAgcGFyYW1zLmFwcGVuZChcImltZy13aWR0aFwiLCBvcHRpb25zLndpZHRoLnRvU3RyaW5nKCkpO1xuICAgIGlmIChvcHRpb25zLmhlaWdodClcbiAgICAgIHBhcmFtcy5hcHBlbmQoXCJpbWctaGVpZ2h0XCIsIG9wdGlvbnMuaGVpZ2h0LnRvU3RyaW5nKCkpO1xuICAgIGlmIChvcHRpb25zLmRwcilcbiAgICAgIHBhcmFtcy5hcHBlbmQoXCJpbWctZHByXCIsIG9wdGlvbnMuZHByLnRvU3RyaW5nKCkpO1xuICAgIGlmIChvcHRpb25zLmZpdClcbiAgICAgIHBhcmFtcy5hcHBlbmQoXCJpbWctZml0XCIsIG9wdGlvbnMuZml0KTtcbiAgICBpZiAob3B0aW9ucy5ncmF2aXR5KVxuICAgICAgcGFyYW1zLmFwcGVuZChcImltZy1ncmF2aXR5XCIsIG9wdGlvbnMuZ3Jhdml0eSk7XG4gICAgaWYgKG9wdGlvbnMucXVhbGl0eSlcbiAgICAgIHBhcmFtcy5hcHBlbmQoXCJpbWctcXVhbGl0eVwiLCBvcHRpb25zLnF1YWxpdHkudG9TdHJpbmcoKSk7XG4gICAgaWYgKG9wdGlvbnMuZm9ybWF0KVxuICAgICAgcGFyYW1zLmFwcGVuZChcImltZy1mb3JtYXRcIiwgb3B0aW9ucy5mb3JtYXQpO1xuICAgIGlmIChvcHRpb25zLmFuaW1hdGlvbiAhPT0gdm9pZCAwKVxuICAgICAgcGFyYW1zLmFwcGVuZChcImltZy1hbmltXCIsIG9wdGlvbnMuYW5pbWF0aW9uLnRvU3RyaW5nKCkpO1xuICAgIGlmIChvcHRpb25zLnNoYXJwZW4pXG4gICAgICBwYXJhbXMuYXBwZW5kKFwiaW1nLXNoYXJwZW5cIiwgb3B0aW9ucy5zaGFycGVuLnRvU3RyaW5nKCkpO1xuICAgIGlmIChvcHRpb25zLm9uRXJyb3IgPT09IHRydWUpXG4gICAgICBwYXJhbXMuYXBwZW5kKFwiaW1nLW9uZXJyb3JcIiwgXCJyZWRpcmVjdFwiKTtcbiAgICBpZiAob3B0aW9ucy5tZXRhZGF0YSlcbiAgICAgIHBhcmFtcy5hcHBlbmQoXCJpbWctbWV0YWRhdGFcIiwgb3B0aW9ucy5tZXRhZGF0YSk7XG4gIH1cbiAgY29uc3QgcXVlcnlTdHJpbmcgPSBwYXJhbXMudG9TdHJpbmcoKTtcbiAgaWYgKHF1ZXJ5U3RyaW5nKSB7XG4gICAgbmV3VXJsICs9IGA/JHtxdWVyeVN0cmluZ31gO1xuICB9XG4gIGNvbnN0IGRhdGUgPSBNYXRoLmZsb29yKCgvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKSkuZ2V0VGltZSgpIC8gMWUzKTtcbiAgY29uc3QgcGF5bG9hZCA9IEpTT04uc3RyaW5naWZ5KHtcbiAgICB1cmw6IG5ld1VybCxcbiAgICBkYXRlLFxuICAgIGV4cGlyZXM6IDMwLFxuICAgIG1ldGhvZDogXCJHRVRcIlxuICB9KTtcbiAgbGV0IGVuZHBvaW50ID0gXCJodHRwczovL2FwaS5waW5hdGEuY2xvdWQvdjNcIjtcbiAgaWYgKGNvbmZpZy5lbmRwb2ludFVybCkge1xuICAgIGVuZHBvaW50ID0gY29uZmlnLmVuZHBvaW50VXJsO1xuICB9XG4gIGxldCBoZWFkZXJzO1xuICBpZiAoY29uZmlnLmN1c3RvbUhlYWRlcnMgJiYgT2JqZWN0LmtleXMoY29uZmlnLmN1c3RvbUhlYWRlcnMpLmxlbmd0aCA+IDApIHtcbiAgICBoZWFkZXJzID0ge1xuICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke2NvbmZpZy5waW5hdGFKd3R9YCxcbiAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgLi4uY29uZmlnLmN1c3RvbUhlYWRlcnNcbiAgICB9O1xuICB9IGVsc2Uge1xuICAgIGhlYWRlcnMgPSB7XG4gICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHtjb25maWcucGluYXRhSnd0fWAsXG4gICAgICBTb3VyY2U6IFwic2RrL2dldENpZFwiXG4gICAgfTtcbiAgfVxuICBjb25zdCBzaWduZWRVcmxSZXF1ZXN0ID0gYXdhaXQgZmV0Y2goYCR7ZW5kcG9pbnR9L2ZpbGVzL3NpZ25gLCB7XG4gICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICBoZWFkZXJzLFxuICAgIGJvZHk6IHBheWxvYWRcbiAgfSk7XG4gIGNvbnN0IHNpZ25lZFVybCA9IGF3YWl0IHNpZ25lZFVybFJlcXVlc3QuanNvbigpO1xuICB0cnkge1xuICAgIGNvbnN0IHJlcXVlc3QgPSBhd2FpdCBmZXRjaChzaWduZWRVcmwuZGF0YSk7XG4gICAgaWYgKCFyZXF1ZXN0Lm9rKSB7XG4gICAgICBjb25zdCBlcnJvckRhdGEgPSBhd2FpdCByZXF1ZXN0LnRleHQoKTtcbiAgICAgIGlmIChyZXF1ZXN0LnN0YXR1cyA9PT0gNDAxIHx8IHJlcXVlc3Quc3RhdHVzID09PSA0MDMpIHtcbiAgICAgICAgdGhyb3cgbmV3IEF1dGhlbnRpY2F0aW9uRXJyb3IoXG4gICAgICAgICAgYEF1dGhlbnRpY2F0aW9uIEZhaWxlZDogJHtlcnJvckRhdGF9YCxcbiAgICAgICAgICByZXF1ZXN0LnN0YXR1cyxcbiAgICAgICAgICBlcnJvckRhdGFcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICAgIHRocm93IG5ldyBOZXR3b3JrRXJyb3IoXG4gICAgICAgIGBIVFRQIGVycm9yOiAke2Vycm9yRGF0YX1gLFxuICAgICAgICByZXF1ZXN0LnN0YXR1cyxcbiAgICAgICAgZXJyb3JEYXRhXG4gICAgICApO1xuICAgIH1cbiAgICBjb25zdCBjb250ZW50VHlwZSA9IHJlcXVlc3QuaGVhZGVycy5nZXQoXCJjb250ZW50LXR5cGVcIik/LnNwbGl0KFwiO1wiKVswXSB8fCBudWxsO1xuICAgIGlmIChjb250ZW50VHlwZT8uaW5jbHVkZXMoXCJhcHBsaWNhdGlvbi9qc29uXCIpKSB7XG4gICAgICBkYXRhID0gYXdhaXQgcmVxdWVzdC5qc29uKCk7XG4gICAgfSBlbHNlIGlmIChjb250ZW50VHlwZT8uaW5jbHVkZXMoXCJ0ZXh0L1wiKSkge1xuICAgICAgZGF0YSA9IGF3YWl0IHJlcXVlc3QudGV4dCgpO1xuICAgIH0gZWxzZSB7XG4gICAgICBkYXRhID0gYXdhaXQgcmVxdWVzdC5ibG9iKCk7XG4gICAgfVxuICAgIGNvbnN0IHJlcyA9IHtcbiAgICAgIGRhdGEsXG4gICAgICBjb250ZW50VHlwZVxuICAgIH07XG4gICAgcmV0dXJuIHJlcztcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBQaW5hdGFFcnJvcikge1xuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIEVycm9yKSB7XG4gICAgICB0aHJvdyBuZXcgUGluYXRhRXJyb3IoYEVycm9yIHByb2Nlc3NpbmcgZ2V0Q2lkOiAke2Vycm9yLm1lc3NhZ2V9YCk7XG4gICAgfVxuICAgIHRocm93IG5ldyBQaW5hdGFFcnJvcihcbiAgICAgIFwiQW4gdW5rbm93biBlcnJvciBvY2N1cnJlZCB3aGlsZSBnZXR0aW5nIENJRCBjb250ZW50c1wiXG4gICAgKTtcbiAgfVxufTtcblxuLy8gc3JjL2NvcmUva2V5cy9jcmVhdGVLZXkudHNcbnZhciBjcmVhdGVLZXkgPSBhc3luYyAoY29uZmlnLCBvcHRpb25zKSA9PiB7XG4gIGlmICghY29uZmlnKSB7XG4gICAgdGhyb3cgbmV3IFZhbGlkYXRpb25FcnJvcihcIlBpbmF0YSBjb25maWd1cmF0aW9uIGlzIG1pc3NpbmdcIik7XG4gIH1cbiAgbGV0IGhlYWRlcnM7XG4gIGlmIChjb25maWcuY3VzdG9tSGVhZGVycyAmJiBPYmplY3Qua2V5cyhjb25maWcuY3VzdG9tSGVhZGVycykubGVuZ3RoID4gMCkge1xuICAgIGhlYWRlcnMgPSB7XG4gICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7Y29uZmlnLnBpbmF0YUp3dH1gLFxuICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gICAgICAuLi5jb25maWcuY3VzdG9tSGVhZGVyc1xuICAgIH07XG4gIH0gZWxzZSB7XG4gICAgaGVhZGVycyA9IHtcbiAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHtjb25maWcucGluYXRhSnd0fWAsXG4gICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgIFNvdXJjZTogXCJzZGsvY3JlYXRlS2V5XCJcbiAgICB9O1xuICB9XG4gIGNvbnN0IGRhdGEgPSBKU09OLnN0cmluZ2lmeShvcHRpb25zKTtcbiAgbGV0IGVuZHBvaW50ID0gXCJodHRwczovL2FwaS5waW5hdGEuY2xvdWQvdjNcIjtcbiAgaWYgKGNvbmZpZy5lbmRwb2ludFVybCkge1xuICAgIGVuZHBvaW50ID0gY29uZmlnLmVuZHBvaW50VXJsO1xuICB9XG4gIHRyeSB7XG4gICAgY29uc3QgcmVxdWVzdCA9IGF3YWl0IGZldGNoKGAke2VuZHBvaW50fS9waW5hdGEva2V5c2AsIHtcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICBoZWFkZXJzLFxuICAgICAgYm9keTogZGF0YVxuICAgIH0pO1xuICAgIGlmICghcmVxdWVzdC5vaykge1xuICAgICAgY29uc3QgZXJyb3JEYXRhID0gYXdhaXQgcmVxdWVzdC50ZXh0KCk7XG4gICAgICBpZiAocmVxdWVzdC5zdGF0dXMgPT09IDQwMSB8fCByZXF1ZXN0LnN0YXR1cyA9PT0gNDAzKSB7XG4gICAgICAgIHRocm93IG5ldyBBdXRoZW50aWNhdGlvbkVycm9yKFxuICAgICAgICAgIGBBdXRoZW50aWNhdGlvbiBmYWlsZWQ6ICR7ZXJyb3JEYXRhfWAsXG4gICAgICAgICAgcmVxdWVzdC5zdGF0dXMsXG4gICAgICAgICAgZXJyb3JEYXRhXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgICB0aHJvdyBuZXcgTmV0d29ya0Vycm9yKFxuICAgICAgICBgSFRUUCBlcnJvcjogJHtlcnJvckRhdGF9YCxcbiAgICAgICAgcmVxdWVzdC5zdGF0dXMsXG4gICAgICAgIGVycm9yRGF0YVxuICAgICAgKTtcbiAgICB9XG4gICAgY29uc3QgcmVzID0gYXdhaXQgcmVxdWVzdC5qc29uKCk7XG4gICAgcmV0dXJuIHJlcztcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBQaW5hdGFFcnJvcikge1xuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIEVycm9yKSB7XG4gICAgICB0aHJvdyBuZXcgUGluYXRhRXJyb3IoYEVycm9yIHByb2Nlc3NpbmcgY3JlYXRlS2V5OiAke2Vycm9yLm1lc3NhZ2V9YCk7XG4gICAgfVxuICAgIHRocm93IG5ldyBQaW5hdGFFcnJvcihcIkFuIHVua25vd24gZXJyb3Igb2NjdXJyZWQgd2hpbGUgY3JlYXRpbmcgQVBJIGtleVwiKTtcbiAgfVxufTtcblxuLy8gc3JjL2NvcmUva2V5cy9saXN0S2V5cy50c1xudmFyIGxpc3RLZXlzID0gYXN5bmMgKGNvbmZpZywgb3B0aW9ucykgPT4ge1xuICBpZiAoIWNvbmZpZykge1xuICAgIHRocm93IG5ldyBWYWxpZGF0aW9uRXJyb3IoXCJQaW5hdGEgY29uZmlndXJhdGlvbiBpcyBtaXNzaW5nXCIpO1xuICB9XG4gIGxldCBoZWFkZXJzO1xuICBpZiAoY29uZmlnLmN1c3RvbUhlYWRlcnMgJiYgT2JqZWN0LmtleXMoY29uZmlnLmN1c3RvbUhlYWRlcnMpLmxlbmd0aCA+IDApIHtcbiAgICBoZWFkZXJzID0ge1xuICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke2NvbmZpZy5waW5hdGFKd3R9YCxcbiAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgLi4uY29uZmlnLmN1c3RvbUhlYWRlcnNcbiAgICB9O1xuICB9IGVsc2Uge1xuICAgIGhlYWRlcnMgPSB7XG4gICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7Y29uZmlnLnBpbmF0YUp3dH1gLFxuICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gICAgICBTb3VyY2U6IFwic2RrL2xpc3RLZXlzXCJcbiAgICB9O1xuICB9XG4gIGNvbnN0IHBhcmFtcyA9IG5ldyBVUkxTZWFyY2hQYXJhbXMoKTtcbiAgaWYgKG9wdGlvbnMpIHtcbiAgICBjb25zdCB7IG9mZnNldCwgbmFtZSwgcmV2b2tlZCwgbGltaXRlZFVzZSwgZXhoYXVzdGVkIH0gPSBvcHRpb25zO1xuICAgIGlmIChvZmZzZXQpXG4gICAgICBwYXJhbXMuYXBwZW5kKFwib2Zmc2V0XCIsIG9mZnNldC50b1N0cmluZygpKTtcbiAgICBpZiAocmV2b2tlZCAhPT0gdm9pZCAwKVxuICAgICAgcGFyYW1zLmFwcGVuZChcInJldm9rZWRcIiwgcmV2b2tlZC50b1N0cmluZygpKTtcbiAgICBpZiAobGltaXRlZFVzZSAhPT0gdm9pZCAwKVxuICAgICAgcGFyYW1zLmFwcGVuZChcImxpbWl0ZWRVc2VcIiwgbGltaXRlZFVzZS50b1N0cmluZygpKTtcbiAgICBpZiAoZXhoYXVzdGVkICE9PSB2b2lkIDApXG4gICAgICBwYXJhbXMuYXBwZW5kKFwiZXhoYXVzdGVkXCIsIGV4aGF1c3RlZC50b1N0cmluZygpKTtcbiAgICBpZiAobmFtZSlcbiAgICAgIHBhcmFtcy5hcHBlbmQoXCJuYW1lXCIsIG5hbWUpO1xuICB9XG4gIGxldCBlbmRwb2ludCA9IFwiaHR0cHM6Ly9hcGkucGluYXRhLmNsb3VkL3YzXCI7XG4gIGlmIChjb25maWcuZW5kcG9pbnRVcmwpIHtcbiAgICBlbmRwb2ludCA9IGNvbmZpZy5lbmRwb2ludFVybDtcbiAgfVxuICB0cnkge1xuICAgIGNvbnN0IHJlcXVlc3QgPSBhd2FpdCBmZXRjaChcbiAgICAgIGAke2VuZHBvaW50fS9waW5hdGEva2V5cz8ke3BhcmFtcy50b1N0cmluZygpfWAsXG4gICAgICB7XG4gICAgICAgIG1ldGhvZDogXCJHRVRcIixcbiAgICAgICAgaGVhZGVyc1xuICAgICAgfVxuICAgICk7XG4gICAgaWYgKCFyZXF1ZXN0Lm9rKSB7XG4gICAgICBjb25zdCBlcnJvckRhdGEgPSBhd2FpdCByZXF1ZXN0LnRleHQoKTtcbiAgICAgIGlmIChyZXF1ZXN0LnN0YXR1cyA9PT0gNDAxIHx8IHJlcXVlc3Quc3RhdHVzID09PSA0MDMpIHtcbiAgICAgICAgdGhyb3cgbmV3IEF1dGhlbnRpY2F0aW9uRXJyb3IoXG4gICAgICAgICAgYEF1dGhlbnRpY2F0aW9uIGZhaWxlZDogJHtlcnJvckRhdGF9YCxcbiAgICAgICAgICByZXF1ZXN0LnN0YXR1cyxcbiAgICAgICAgICBlcnJvckRhdGFcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICAgIHRocm93IG5ldyBOZXR3b3JrRXJyb3IoXG4gICAgICAgIGBIVFRQIGVycm9yOiAke2Vycm9yRGF0YX1gLFxuICAgICAgICByZXF1ZXN0LnN0YXR1cyxcbiAgICAgICAgZXJyb3JEYXRhXG4gICAgICApO1xuICAgIH1cbiAgICBjb25zdCByZXMgPSBhd2FpdCByZXF1ZXN0Lmpzb24oKTtcbiAgICByZXR1cm4gcmVzLmtleXM7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgaWYgKGVycm9yIGluc3RhbmNlb2YgUGluYXRhRXJyb3IpIHtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBFcnJvcikge1xuICAgICAgdGhyb3cgbmV3IFBpbmF0YUVycm9yKGBFcnJvciBwcm9jZXNzaW5nIGxpc3RLZXlzOiAke2Vycm9yLm1lc3NhZ2V9YCk7XG4gICAgfVxuICAgIHRocm93IG5ldyBQaW5hdGFFcnJvcihcIkFuIHVua25vd24gZXJyb3Igb2NjdXJyZWQgd2hpbGUgbGlzdGluZyBBUEkga2V5c1wiKTtcbiAgfVxufTtcblxuLy8gc3JjL2NvcmUva2V5cy9yZXZva2VLZXlzLnRzXG52YXIgd2FpdDIgPSAobWlsbGlzZWNvbmRzKSA9PiB7XG4gIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4ge1xuICAgIHNldFRpbWVvdXQocmVzb2x2ZSwgbWlsbGlzZWNvbmRzKTtcbiAgfSk7XG59O1xudmFyIHJldm9rZUtleXMgPSBhc3luYyAoY29uZmlnLCBrZXlzKSA9PiB7XG4gIGlmICghY29uZmlnKSB7XG4gICAgdGhyb3cgbmV3IFZhbGlkYXRpb25FcnJvcihcIlBpbmF0YSBjb25maWd1cmF0aW9uIGlzIG1pc3NpbmdcIik7XG4gIH1cbiAgbGV0IGhlYWRlcnM7XG4gIGlmIChjb25maWcuY3VzdG9tSGVhZGVycyAmJiBPYmplY3Qua2V5cyhjb25maWcuY3VzdG9tSGVhZGVycykubGVuZ3RoID4gMCkge1xuICAgIGhlYWRlcnMgPSB7XG4gICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7Y29uZmlnLnBpbmF0YUp3dH1gLFxuICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gICAgICAuLi5jb25maWcuY3VzdG9tSGVhZGVyc1xuICAgIH07XG4gICAgaGVhZGVycyA9IHsgLi4uY29uZmlnLmN1c3RvbUhlYWRlcnMgfTtcbiAgfSBlbHNlIHtcbiAgICBoZWFkZXJzID0ge1xuICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke2NvbmZpZy5waW5hdGFKd3R9YCxcbiAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgU291cmNlOiBcInNkay9yZXZva2VLZXlzXCJcbiAgICB9O1xuICB9XG4gIGNvbnN0IHJlc3BvbnNlcyA9IFtdO1xuICBsZXQgZW5kcG9pbnQgPSBcImh0dHBzOi8vYXBpLnBpbmF0YS5jbG91ZC92M1wiO1xuICBpZiAoY29uZmlnLmVuZHBvaW50VXJsKSB7XG4gICAgZW5kcG9pbnQgPSBjb25maWcuZW5kcG9pbnRVcmw7XG4gIH1cbiAgZm9yIChjb25zdCBrZXkgb2Yga2V5cykge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXF1ZXN0ID0gYXdhaXQgZmV0Y2goYCR7ZW5kcG9pbnR9L3BpbmF0YS9rZXlzLyR7a2V5fWAsIHtcbiAgICAgICAgbWV0aG9kOiBcIlBVVFwiLFxuICAgICAgICBoZWFkZXJzXG4gICAgICB9KTtcbiAgICAgIGF3YWl0IHdhaXQyKDMwMCk7XG4gICAgICBpZiAoIXJlcXVlc3Qub2spIHtcbiAgICAgICAgY29uc3QgZXJyb3JEYXRhID0gYXdhaXQgcmVxdWVzdC50ZXh0KCk7XG4gICAgICAgIGlmIChyZXF1ZXN0LnN0YXR1cyA9PT0gNDAxIHx8IHJlcXVlc3Quc3RhdHVzID09PSA0MDMpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgQXV0aGVudGljYXRpb25FcnJvcihcbiAgICAgICAgICAgIGBBdXRoZW50aWNhdGlvbiBmYWlsZWQ6ICR7ZXJyb3JEYXRhfWAsXG4gICAgICAgICAgICByZXF1ZXN0LnN0YXR1cyxcbiAgICAgICAgICAgIGVycm9yRGF0YVxuICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgICAgdGhyb3cgbmV3IE5ldHdvcmtFcnJvcihcbiAgICAgICAgICBgSFRUUCBlcnJvcjogJHtlcnJvckRhdGF9YCxcbiAgICAgICAgICByZXF1ZXN0LnN0YXR1cyxcbiAgICAgICAgICBlcnJvckRhdGFcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHJlcXVlc3QuanNvbigpO1xuICAgICAgcmVzcG9uc2VzLnB1c2goe1xuICAgICAgICBrZXksXG4gICAgICAgIHN0YXR1czogcmVzdWx0XG4gICAgICB9KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbGV0IGVycm9yTWVzc2FnZTtcbiAgICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIFBpbmF0YUVycm9yKSB7XG4gICAgICAgIGVycm9yTWVzc2FnZSA9IGVycm9yLm1lc3NhZ2U7XG4gICAgICB9IGVsc2UgaWYgKGVycm9yIGluc3RhbmNlb2YgRXJyb3IpIHtcbiAgICAgICAgZXJyb3JNZXNzYWdlID0gYEVycm9yIHJldm9raW5nIGtleSAke2tleX06ICR7ZXJyb3IubWVzc2FnZX1gO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZXJyb3JNZXNzYWdlID0gYEFuIHVua25vd24gZXJyb3Igb2NjdXJyZWQgd2hpbGUgcmV2b2tpbmcga2V5ICR7a2V5fWA7XG4gICAgICB9XG4gICAgICByZXNwb25zZXMucHVzaCh7XG4gICAgICAgIGtleSxcbiAgICAgICAgc3RhdHVzOiBlcnJvck1lc3NhZ2VcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuICByZXR1cm4gcmVzcG9uc2VzO1xufTtcblxuLy8gc3JjL2NvcmUvZ3JvdXBzL2NyZWF0ZUdyb3VwLnRzXG52YXIgY3JlYXRlR3JvdXAgPSBhc3luYyAoY29uZmlnLCBvcHRpb25zKSA9PiB7XG4gIGlmICghY29uZmlnKSB7XG4gICAgdGhyb3cgbmV3IFZhbGlkYXRpb25FcnJvcihcIlBpbmF0YSBjb25maWd1cmF0aW9uIGlzIG1pc3NpbmdcIik7XG4gIH1cbiAgY29uc3QgZGF0YSA9IEpTT04uc3RyaW5naWZ5KHtcbiAgICBuYW1lOiBvcHRpb25zLm5hbWUsXG4gICAgaXNfcHVibGljOiBvcHRpb25zLmlzUHVibGljXG4gIH0pO1xuICBsZXQgaGVhZGVycztcbiAgaWYgKGNvbmZpZy5jdXN0b21IZWFkZXJzICYmIE9iamVjdC5rZXlzKGNvbmZpZy5jdXN0b21IZWFkZXJzKS5sZW5ndGggPiAwKSB7XG4gICAgaGVhZGVycyA9IHtcbiAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHtjb25maWcucGluYXRhSnd0fWAsXG4gICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgIC4uLmNvbmZpZy5jdXN0b21IZWFkZXJzXG4gICAgfTtcbiAgfSBlbHNlIHtcbiAgICBoZWFkZXJzID0ge1xuICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke2NvbmZpZy5waW5hdGFKd3R9YCxcbiAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgU291cmNlOiBcInNkay9jcmVhdGVHcm91cFwiXG4gICAgfTtcbiAgfVxuICBsZXQgZW5kcG9pbnQgPSBcImh0dHBzOi8vYXBpLnBpbmF0YS5jbG91ZC92M1wiO1xuICBpZiAoY29uZmlnLmVuZHBvaW50VXJsKSB7XG4gICAgZW5kcG9pbnQgPSBjb25maWcuZW5kcG9pbnRVcmw7XG4gIH1cbiAgdHJ5IHtcbiAgICBjb25zdCByZXF1ZXN0ID0gYXdhaXQgZmV0Y2goYCR7ZW5kcG9pbnR9L2ZpbGVzL2dyb3Vwc2AsIHtcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICBoZWFkZXJzLFxuICAgICAgYm9keTogZGF0YVxuICAgIH0pO1xuICAgIGlmICghcmVxdWVzdC5vaykge1xuICAgICAgY29uc3QgZXJyb3JEYXRhID0gYXdhaXQgcmVxdWVzdC50ZXh0KCk7XG4gICAgICBpZiAocmVxdWVzdC5zdGF0dXMgPT09IDQwMSB8fCByZXF1ZXN0LnN0YXR1cyA9PT0gNDAzKSB7XG4gICAgICAgIHRocm93IG5ldyBBdXRoZW50aWNhdGlvbkVycm9yKFxuICAgICAgICAgIGBBdXRoZW50aWNhdGlvbiBmYWlsZWQ6ICR7ZXJyb3JEYXRhfWAsXG4gICAgICAgICAgcmVxdWVzdC5zdGF0dXMsXG4gICAgICAgICAgZXJyb3JEYXRhXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgICB0aHJvdyBuZXcgTmV0d29ya0Vycm9yKFxuICAgICAgICBgSFRUUCBlcnJvcjogJHtlcnJvckRhdGF9YCxcbiAgICAgICAgcmVxdWVzdC5zdGF0dXMsXG4gICAgICAgIGVycm9yRGF0YVxuICAgICAgKTtcbiAgICB9XG4gICAgY29uc3QgcmVzID0gYXdhaXQgcmVxdWVzdC5qc29uKCk7XG4gICAgY29uc3QgcmVzRGF0YSA9IHJlcy5kYXRhO1xuICAgIHJldHVybiByZXNEYXRhO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIFBpbmF0YUVycm9yKSB7XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gICAgaWYgKGVycm9yIGluc3RhbmNlb2YgRXJyb3IpIHtcbiAgICAgIHRocm93IG5ldyBQaW5hdGFFcnJvcihgRXJyb3IgcHJvY2Vzc2luZyBjcmVhdGVHcm91cDogJHtlcnJvci5tZXNzYWdlfWApO1xuICAgIH1cbiAgICB0aHJvdyBuZXcgUGluYXRhRXJyb3IoXCJBbiB1bmtub3duIGVycm9yIG9jY3VycmVkIHdoaWxlIGNyZWF0aW5nIGEgZ3JvdXBcIik7XG4gIH1cbn07XG5cbi8vIHNyYy9jb3JlL2dyb3Vwcy9saXN0R3JvdXBzLnRzXG52YXIgbGlzdEdyb3VwcyA9IGFzeW5jIChjb25maWcsIG9wdGlvbnMpID0+IHtcbiAgaWYgKCFjb25maWcpIHtcbiAgICB0aHJvdyBuZXcgVmFsaWRhdGlvbkVycm9yKFwiUGluYXRhIGNvbmZpZ3VyYXRpb24gaXMgbWlzc2luZ1wiKTtcbiAgfVxuICBsZXQgaGVhZGVycztcbiAgaWYgKGNvbmZpZy5jdXN0b21IZWFkZXJzICYmIE9iamVjdC5rZXlzKGNvbmZpZy5jdXN0b21IZWFkZXJzKS5sZW5ndGggPiAwKSB7XG4gICAgaGVhZGVycyA9IHtcbiAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHtjb25maWcucGluYXRhSnd0fWAsXG4gICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgIC4uLmNvbmZpZy5jdXN0b21IZWFkZXJzXG4gICAgfTtcbiAgfSBlbHNlIHtcbiAgICBoZWFkZXJzID0ge1xuICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke2NvbmZpZy5waW5hdGFKd3R9YCxcbiAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgU291cmNlOiBcInNkay9saXN0R3JvdXBzXCJcbiAgICB9O1xuICB9XG4gIGNvbnN0IHBhcmFtcyA9IG5ldyBVUkxTZWFyY2hQYXJhbXMoKTtcbiAgaWYgKG9wdGlvbnMpIHtcbiAgICBjb25zdCB7IHBhZ2VUb2tlbiwgbmFtZSwgbGltaXQsIGlzUHVibGljIH0gPSBvcHRpb25zO1xuICAgIGlmIChwYWdlVG9rZW4pXG4gICAgICBwYXJhbXMuYXBwZW5kKFwicGFnZVRva2VuXCIsIHBhZ2VUb2tlbi50b1N0cmluZygpKTtcbiAgICBpZiAoaXNQdWJsaWMpXG4gICAgICBwYXJhbXMuYXBwZW5kKFwiaXNQdWJsaWNcIiwgaXNQdWJsaWMudG9TdHJpbmcoKSk7XG4gICAgaWYgKG5hbWUpXG4gICAgICBwYXJhbXMuYXBwZW5kKFwibmFtZVwiLCBuYW1lKTtcbiAgICBpZiAobGltaXQgIT09IHZvaWQgMClcbiAgICAgIHBhcmFtcy5hcHBlbmQoXCJsaW1pdFwiLCBsaW1pdC50b1N0cmluZygpKTtcbiAgfVxuICBsZXQgZW5kcG9pbnQgPSBcImh0dHBzOi8vYXBpLnBpbmF0YS5jbG91ZC92M1wiO1xuICBpZiAoY29uZmlnLmVuZHBvaW50VXJsKSB7XG4gICAgZW5kcG9pbnQgPSBjb25maWcuZW5kcG9pbnRVcmw7XG4gIH1cbiAgdHJ5IHtcbiAgICBjb25zdCByZXF1ZXN0ID0gYXdhaXQgZmV0Y2goXG4gICAgICBgJHtlbmRwb2ludH0vZmlsZXMvZ3JvdXBzPyR7cGFyYW1zLnRvU3RyaW5nKCl9YCxcbiAgICAgIHtcbiAgICAgICAgbWV0aG9kOiBcIkdFVFwiLFxuICAgICAgICBoZWFkZXJzXG4gICAgICB9XG4gICAgKTtcbiAgICBpZiAoIXJlcXVlc3Qub2spIHtcbiAgICAgIGNvbnN0IGVycm9yRGF0YSA9IGF3YWl0IHJlcXVlc3QudGV4dCgpO1xuICAgICAgaWYgKHJlcXVlc3Quc3RhdHVzID09PSA0MDEgfHwgcmVxdWVzdC5zdGF0dXMgPT09IDQwMykge1xuICAgICAgICB0aHJvdyBuZXcgQXV0aGVudGljYXRpb25FcnJvcihcbiAgICAgICAgICBgQXV0aGVudGljYXRpb24gZmFpbGVkOiAke2Vycm9yRGF0YX1gLFxuICAgICAgICAgIHJlcXVlc3Quc3RhdHVzLFxuICAgICAgICAgIGVycm9yRGF0YVxuICAgICAgICApO1xuICAgICAgfVxuICAgICAgdGhyb3cgbmV3IE5ldHdvcmtFcnJvcihcbiAgICAgICAgYEhUVFAgZXJyb3I6ICR7ZXJyb3JEYXRhfWAsXG4gICAgICAgIHJlcXVlc3Quc3RhdHVzLFxuICAgICAgICBlcnJvckRhdGFcbiAgICAgICk7XG4gICAgfVxuICAgIGNvbnN0IHJlcyA9IGF3YWl0IHJlcXVlc3QuanNvbigpO1xuICAgIGNvbnN0IHJlc0RhdGEgPSByZXMuZGF0YTtcbiAgICByZXR1cm4gcmVzRGF0YTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBQaW5hdGFFcnJvcikge1xuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIEVycm9yKSB7XG4gICAgICB0aHJvdyBuZXcgUGluYXRhRXJyb3IoYEVycm9yIHByb2Nlc3NpbmcgbGlzdEdyb3VwczogJHtlcnJvci5tZXNzYWdlfWApO1xuICAgIH1cbiAgICB0aHJvdyBuZXcgUGluYXRhRXJyb3IoXCJBbiB1bmtub3duIGVycm9yIG9jY3VycmVkIHdoaWxlIGxpc3RpbmcgZ3JvdXBzXCIpO1xuICB9XG59O1xuXG4vLyBzcmMvY29yZS9ncm91cHMvZ2V0R3JvdXAudHNcbnZhciBnZXRHcm91cCA9IGFzeW5jIChjb25maWcsIG9wdGlvbnMpID0+IHtcbiAgaWYgKCFjb25maWcpIHtcbiAgICB0aHJvdyBuZXcgVmFsaWRhdGlvbkVycm9yKFwiUGluYXRhIGNvbmZpZ3VyYXRpb24gaXMgbWlzc2luZ1wiKTtcbiAgfVxuICBsZXQgaGVhZGVycztcbiAgaWYgKGNvbmZpZy5jdXN0b21IZWFkZXJzICYmIE9iamVjdC5rZXlzKGNvbmZpZy5jdXN0b21IZWFkZXJzKS5sZW5ndGggPiAwKSB7XG4gICAgaGVhZGVycyA9IHtcbiAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHtjb25maWcucGluYXRhSnd0fWAsXG4gICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgIC4uLmNvbmZpZy5jdXN0b21IZWFkZXJzXG4gICAgfTtcbiAgfSBlbHNlIHtcbiAgICBoZWFkZXJzID0ge1xuICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke2NvbmZpZy5waW5hdGFKd3R9YCxcbiAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgU291cmNlOiBcInNkay9nZXRHcm91cFwiXG4gICAgfTtcbiAgfVxuICBsZXQgZW5kcG9pbnQgPSBcImh0dHBzOi8vYXBpLnBpbmF0YS5jbG91ZC92M1wiO1xuICBpZiAoY29uZmlnLmVuZHBvaW50VXJsKSB7XG4gICAgZW5kcG9pbnQgPSBjb25maWcuZW5kcG9pbnRVcmw7XG4gIH1cbiAgdHJ5IHtcbiAgICBjb25zdCByZXF1ZXN0ID0gYXdhaXQgZmV0Y2goYCR7ZW5kcG9pbnR9L2ZpbGVzL2dyb3Vwcy8ke29wdGlvbnMuZ3JvdXBJZH1gLCB7XG4gICAgICBtZXRob2Q6IFwiR0VUXCIsXG4gICAgICBoZWFkZXJzXG4gICAgfSk7XG4gICAgaWYgKCFyZXF1ZXN0Lm9rKSB7XG4gICAgICBjb25zdCBlcnJvckRhdGEgPSBhd2FpdCByZXF1ZXN0LnRleHQoKTtcbiAgICAgIGlmIChyZXF1ZXN0LnN0YXR1cyA9PT0gNDAxIHx8IHJlcXVlc3Quc3RhdHVzID09PSA0MDMpIHtcbiAgICAgICAgdGhyb3cgbmV3IEF1dGhlbnRpY2F0aW9uRXJyb3IoXG4gICAgICAgICAgYEF1dGhlbnRpY2F0aW9uIGZhaWxlZDogJHtlcnJvckRhdGF9YCxcbiAgICAgICAgICByZXF1ZXN0LnN0YXR1cyxcbiAgICAgICAgICBlcnJvckRhdGFcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICAgIHRocm93IG5ldyBOZXR3b3JrRXJyb3IoXG4gICAgICAgIGBIVFRQIGVycm9yOiAke2Vycm9yRGF0YX1gLFxuICAgICAgICByZXF1ZXN0LnN0YXR1cyxcbiAgICAgICAgZXJyb3JEYXRhXG4gICAgICApO1xuICAgIH1cbiAgICBjb25zdCByZXMgPSBhd2FpdCByZXF1ZXN0Lmpzb24oKTtcbiAgICBjb25zdCByZXNEYXRhID0gcmVzLmRhdGE7XG4gICAgcmV0dXJuIHJlc0RhdGE7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgaWYgKGVycm9yIGluc3RhbmNlb2YgUGluYXRhRXJyb3IpIHtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBFcnJvcikge1xuICAgICAgdGhyb3cgbmV3IFBpbmF0YUVycm9yKGBFcnJvciBwcm9jZXNzaW5nIGdldEdyb3VwOiAke2Vycm9yLm1lc3NhZ2V9YCk7XG4gICAgfVxuICAgIHRocm93IG5ldyBQaW5hdGFFcnJvcihcbiAgICAgIFwiQW4gdW5rbm93biBlcnJvciBvY2N1cnJlZCB3aGlsZSBnZXR0aW5nIGluZm8gZm9yIGEgZ3JvdXBcIlxuICAgICk7XG4gIH1cbn07XG5cbi8vIHNyYy9jb3JlL2dyb3Vwcy9hZGRUb0dyb3VwLnRzXG52YXIgYWRkVG9Hcm91cCA9IGFzeW5jIChjb25maWcsIG9wdGlvbnMpID0+IHtcbiAgaWYgKCFjb25maWcpIHtcbiAgICB0aHJvdyBuZXcgVmFsaWRhdGlvbkVycm9yKFwiUGluYXRhIGNvbmZpZ3VyYXRpb24gaXMgbWlzc2luZ1wiKTtcbiAgfVxuICBjb25zdCB3YWl0MyA9IChtaWxsaXNlY29uZHMpID0+IHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcbiAgICAgIHNldFRpbWVvdXQocmVzb2x2ZSwgbWlsbGlzZWNvbmRzKTtcbiAgICB9KTtcbiAgfTtcbiAgY29uc3QgcmVzcG9uc2VzID0gW107XG4gIGxldCBoZWFkZXJzO1xuICBpZiAoY29uZmlnLmN1c3RvbUhlYWRlcnMgJiYgT2JqZWN0LmtleXMoY29uZmlnLmN1c3RvbUhlYWRlcnMpLmxlbmd0aCA+IDApIHtcbiAgICBoZWFkZXJzID0ge1xuICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke2NvbmZpZy5waW5hdGFKd3R9YCxcbiAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgLi4uY29uZmlnLmN1c3RvbUhlYWRlcnNcbiAgICB9O1xuICB9IGVsc2Uge1xuICAgIGhlYWRlcnMgPSB7XG4gICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7Y29uZmlnLnBpbmF0YUp3dH1gLFxuICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gICAgICBTb3VyY2U6IFwic2RrL2FkZFRvR3JvdXBcIlxuICAgIH07XG4gIH1cbiAgbGV0IGVuZHBvaW50ID0gXCJodHRwczovL2FwaS5waW5hdGEuY2xvdWQvdjNcIjtcbiAgaWYgKGNvbmZpZy5lbmRwb2ludFVybCkge1xuICAgIGVuZHBvaW50ID0gY29uZmlnLmVuZHBvaW50VXJsO1xuICB9XG4gIGZvciAoY29uc3QgaWQgb2Ygb3B0aW9ucy5maWxlcykge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKFxuICAgICAgICBgJHtlbmRwb2ludH0vZmlsZXMvZ3JvdXBzLyR7b3B0aW9ucy5ncm91cElkfS9pZHMvJHtpZH1gLFxuICAgICAgICB7XG4gICAgICAgICAgbWV0aG9kOiBcIlBVVFwiLFxuICAgICAgICAgIGhlYWRlcnNcbiAgICAgICAgfVxuICAgICAgKTtcbiAgICAgIGF3YWl0IHdhaXQzKDMwMCk7XG4gICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICAgIGNvbnN0IGVycm9yRGF0YSA9IGF3YWl0IHJlc3BvbnNlLnRleHQoKTtcbiAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gNDAxKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEF1dGhlbnRpY2F0aW9uRXJyb3IoXG4gICAgICAgICAgICBgQXV0aGVudGljYXRpb24gZmFpbGVkOiAke2Vycm9yRGF0YX1gLFxuICAgICAgICAgICAgcmVzcG9uc2Uuc3RhdHVzLFxuICAgICAgICAgICAgZXJyb3JEYXRhXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgICB0aHJvdyBuZXcgTmV0d29ya0Vycm9yKFxuICAgICAgICAgIGBIVFRQIGVycm9yOiAke2Vycm9yRGF0YX1gLFxuICAgICAgICAgIHJlc3BvbnNlLnN0YXR1cyxcbiAgICAgICAgICBlcnJvckRhdGFcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICAgIHJlc3BvbnNlcy5wdXNoKHtcbiAgICAgICAgaWQsXG4gICAgICAgIHN0YXR1czogcmVzcG9uc2Uuc3RhdHVzVGV4dFxuICAgICAgfSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxldCBlcnJvck1lc3NhZ2U7XG4gICAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBQaW5hdGFFcnJvcikge1xuICAgICAgICBlcnJvck1lc3NhZ2UgPSBlcnJvci5tZXNzYWdlO1xuICAgICAgfSBlbHNlIGlmIChlcnJvciBpbnN0YW5jZW9mIEVycm9yKSB7XG4gICAgICAgIGVycm9yTWVzc2FnZSA9IGBFcnJvciBhZGRpbmcgZmlsZSAke2lkfSB0byBncm91cDogJHtlcnJvci5tZXNzYWdlfWA7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBlcnJvck1lc3NhZ2UgPSBgQW4gdW5rbm93biBlcnJvciBvY2N1cnJlZCB3aGlsZSBhZGRpbmcgZmlsZSAke2lkfSB0byBncm91cGA7XG4gICAgICB9XG4gICAgICByZXNwb25zZXMucHVzaCh7XG4gICAgICAgIGlkLFxuICAgICAgICBzdGF0dXM6IGVycm9yTWVzc2FnZVxuICAgICAgfSk7XG4gICAgfVxuICB9XG4gIHJldHVybiByZXNwb25zZXM7XG59O1xuXG4vLyBzcmMvY29yZS9ncm91cHMvdXBkYXRlR3JvdXAudHNcbnZhciB1cGRhdGVHcm91cCA9IGFzeW5jIChjb25maWcsIG9wdGlvbnMpID0+IHtcbiAgaWYgKCFjb25maWcpIHtcbiAgICB0aHJvdyBuZXcgVmFsaWRhdGlvbkVycm9yKFwiUGluYXRhIGNvbmZpZ3VyYXRpb24gaXMgbWlzc2luZ1wiKTtcbiAgfVxuICBjb25zdCBkYXRhID0gSlNPTi5zdHJpbmdpZnkoe1xuICAgIG5hbWU6IG9wdGlvbnMubmFtZSxcbiAgICBpc19wdWJsaWM6IG9wdGlvbnMuaXNQdWJsaWNcbiAgfSk7XG4gIGxldCBoZWFkZXJzO1xuICBpZiAoY29uZmlnLmN1c3RvbUhlYWRlcnMgJiYgT2JqZWN0LmtleXMoY29uZmlnLmN1c3RvbUhlYWRlcnMpLmxlbmd0aCA+IDApIHtcbiAgICBoZWFkZXJzID0ge1xuICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke2NvbmZpZy5waW5hdGFKd3R9YCxcbiAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgLi4uY29uZmlnLmN1c3RvbUhlYWRlcnNcbiAgICB9O1xuICB9IGVsc2Uge1xuICAgIGhlYWRlcnMgPSB7XG4gICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7Y29uZmlnLnBpbmF0YUp3dH1gLFxuICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gICAgICBTb3VyY2U6IFwic2RrL3VwZGF0ZUdyb3VwXCJcbiAgICB9O1xuICB9XG4gIGxldCBlbmRwb2ludCA9IFwiaHR0cHM6Ly9hcGkucGluYXRhLmNsb3VkL3YzXCI7XG4gIGlmIChjb25maWcuZW5kcG9pbnRVcmwpIHtcbiAgICBlbmRwb2ludCA9IGNvbmZpZy5lbmRwb2ludFVybDtcbiAgfVxuICB0cnkge1xuICAgIGNvbnN0IHJlcXVlc3QgPSBhd2FpdCBmZXRjaChgJHtlbmRwb2ludH0vZmlsZXMvZ3JvdXBzLyR7b3B0aW9ucy5ncm91cElkfWAsIHtcbiAgICAgIG1ldGhvZDogXCJQVVRcIixcbiAgICAgIGhlYWRlcnMsXG4gICAgICBib2R5OiBkYXRhXG4gICAgfSk7XG4gICAgaWYgKCFyZXF1ZXN0Lm9rKSB7XG4gICAgICBjb25zdCBlcnJvckRhdGEgPSBhd2FpdCByZXF1ZXN0LnRleHQoKTtcbiAgICAgIGlmIChyZXF1ZXN0LnN0YXR1cyA9PT0gNDAxIHx8IHJlcXVlc3Quc3RhdHVzID09PSA0MDMpIHtcbiAgICAgICAgdGhyb3cgbmV3IEF1dGhlbnRpY2F0aW9uRXJyb3IoXG4gICAgICAgICAgYEF1dGhlbnRpY2F0aW9uIGZhaWxlZDogJHtlcnJvckRhdGF9YCxcbiAgICAgICAgICByZXF1ZXN0LnN0YXR1cyxcbiAgICAgICAgICBlcnJvckRhdGFcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICAgIHRocm93IG5ldyBOZXR3b3JrRXJyb3IoXG4gICAgICAgIGBIVFRQIGVycm9yOiAke2Vycm9yRGF0YX1gLFxuICAgICAgICByZXF1ZXN0LnN0YXR1cyxcbiAgICAgICAgZXJyb3JEYXRhXG4gICAgICApO1xuICAgIH1cbiAgICBjb25zdCByZXMgPSBhd2FpdCByZXF1ZXN0Lmpzb24oKTtcbiAgICBjb25zdCByZXNEYXRhID0gcmVzLmRhdGE7XG4gICAgcmV0dXJuIHJlc0RhdGE7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgaWYgKGVycm9yIGluc3RhbmNlb2YgUGluYXRhRXJyb3IpIHtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBFcnJvcikge1xuICAgICAgdGhyb3cgbmV3IFBpbmF0YUVycm9yKGBFcnJvciBwcm9jZXNzaW5nIHVwZGF0ZUdyb3VwOiAke2Vycm9yLm1lc3NhZ2V9YCk7XG4gICAgfVxuICAgIHRocm93IG5ldyBQaW5hdGFFcnJvcihcIkFuIHVua25vd24gZXJyb3Igb2NjdXJyZWQgd2hpbGUgdXBkYXRpbmcgZ3JvdXBcIik7XG4gIH1cbn07XG5cbi8vIHNyYy9jb3JlL2dyb3Vwcy9yZW1vdmVGcm9tR3JvdXAudHNcbnZhciByZW1vdmVGcm9tR3JvdXAgPSBhc3luYyAoY29uZmlnLCBvcHRpb25zKSA9PiB7XG4gIGlmICghY29uZmlnKSB7XG4gICAgdGhyb3cgbmV3IFZhbGlkYXRpb25FcnJvcihcIlBpbmF0YSBjb25maWd1cmF0aW9uIGlzIG1pc3NpbmdcIik7XG4gIH1cbiAgY29uc3Qgd2FpdDMgPSAobWlsbGlzZWNvbmRzKSA9PiB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG4gICAgICBzZXRUaW1lb3V0KHJlc29sdmUsIG1pbGxpc2Vjb25kcyk7XG4gICAgfSk7XG4gIH07XG4gIGNvbnN0IHJlc3BvbnNlcyA9IFtdO1xuICBsZXQgaGVhZGVycztcbiAgaWYgKGNvbmZpZy5jdXN0b21IZWFkZXJzICYmIE9iamVjdC5rZXlzKGNvbmZpZy5jdXN0b21IZWFkZXJzKS5sZW5ndGggPiAwKSB7XG4gICAgaGVhZGVycyA9IHtcbiAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHtjb25maWcucGluYXRhSnd0fWAsXG4gICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgIC4uLmNvbmZpZy5jdXN0b21IZWFkZXJzXG4gICAgfTtcbiAgfSBlbHNlIHtcbiAgICBoZWFkZXJzID0ge1xuICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke2NvbmZpZy5waW5hdGFKd3R9YCxcbiAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgU291cmNlOiBcInNkay9hZGRUb0dyb3VwXCJcbiAgICB9O1xuICB9XG4gIGxldCBlbmRwb2ludCA9IFwiaHR0cHM6Ly9hcGkucGluYXRhLmNsb3VkL3YzXCI7XG4gIGlmIChjb25maWcuZW5kcG9pbnRVcmwpIHtcbiAgICBlbmRwb2ludCA9IGNvbmZpZy5lbmRwb2ludFVybDtcbiAgfVxuICBmb3IgKGNvbnN0IGlkIG9mIG9wdGlvbnMuZmlsZXMpIHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChcbiAgICAgICAgYCR7ZW5kcG9pbnR9L2ZpbGVzL2dyb3Vwcy8ke29wdGlvbnMuZ3JvdXBJZH0vaWRzLyR7aWR9YCxcbiAgICAgICAge1xuICAgICAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcbiAgICAgICAgICBoZWFkZXJzXG4gICAgICAgIH1cbiAgICAgICk7XG4gICAgICBhd2FpdCB3YWl0MygzMDApO1xuICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgICBjb25zdCBlcnJvckRhdGEgPSBhd2FpdCByZXNwb25zZS50ZXh0KCk7XG4gICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDQwMSkge1xuICAgICAgICAgIHRocm93IG5ldyBBdXRoZW50aWNhdGlvbkVycm9yKFxuICAgICAgICAgICAgYEF1dGhlbnRpY2F0aW9uIGZhaWxlZDogJHtlcnJvckRhdGF9YCxcbiAgICAgICAgICAgIHJlc3BvbnNlLnN0YXR1cyxcbiAgICAgICAgICAgIGVycm9yRGF0YVxuICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgICAgdGhyb3cgbmV3IE5ldHdvcmtFcnJvcihcbiAgICAgICAgICBgSFRUUCBlcnJvcjogJHtlcnJvckRhdGF9YCxcbiAgICAgICAgICByZXNwb25zZS5zdGF0dXMsXG4gICAgICAgICAgZXJyb3JEYXRhXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgICByZXNwb25zZXMucHVzaCh7XG4gICAgICAgIGlkLFxuICAgICAgICBzdGF0dXM6IHJlc3BvbnNlLnN0YXR1c1RleHRcbiAgICAgIH0pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsZXQgZXJyb3JNZXNzYWdlO1xuICAgICAgaWYgKGVycm9yIGluc3RhbmNlb2YgUGluYXRhRXJyb3IpIHtcbiAgICAgICAgZXJyb3JNZXNzYWdlID0gZXJyb3IubWVzc2FnZTtcbiAgICAgIH0gZWxzZSBpZiAoZXJyb3IgaW5zdGFuY2VvZiBFcnJvcikge1xuICAgICAgICBlcnJvck1lc3NhZ2UgPSBgRXJyb3IgYWRkaW5nIGZpbGUgJHtpZH0gdG8gZ3JvdXA6ICR7ZXJyb3IubWVzc2FnZX1gO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZXJyb3JNZXNzYWdlID0gYEFuIHVua25vd24gZXJyb3Igb2NjdXJyZWQgd2hpbGUgYWRkaW5nIGZpbGUgJHtpZH0gdG8gZ3JvdXBgO1xuICAgICAgfVxuICAgICAgcmVzcG9uc2VzLnB1c2goe1xuICAgICAgICBpZCxcbiAgICAgICAgc3RhdHVzOiBlcnJvck1lc3NhZ2VcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuICByZXR1cm4gcmVzcG9uc2VzO1xufTtcblxuLy8gc3JjL2NvcmUvZ3JvdXBzL2RlbGV0ZUdyb3VwLnRzXG52YXIgZGVsZXRlR3JvdXAgPSBhc3luYyAoY29uZmlnLCBvcHRpb25zKSA9PiB7XG4gIGlmICghY29uZmlnKSB7XG4gICAgdGhyb3cgbmV3IFZhbGlkYXRpb25FcnJvcihcIlBpbmF0YSBjb25maWd1cmF0aW9uIGlzIG1pc3NpbmdcIik7XG4gIH1cbiAgbGV0IGhlYWRlcnM7XG4gIGlmIChjb25maWcuY3VzdG9tSGVhZGVycyAmJiBPYmplY3Qua2V5cyhjb25maWcuY3VzdG9tSGVhZGVycykubGVuZ3RoID4gMCkge1xuICAgIGhlYWRlcnMgPSB7XG4gICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7Y29uZmlnLnBpbmF0YUp3dH1gLFxuICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gICAgICAuLi5jb25maWcuY3VzdG9tSGVhZGVyc1xuICAgIH07XG4gIH0gZWxzZSB7XG4gICAgaGVhZGVycyA9IHtcbiAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHtjb25maWcucGluYXRhSnd0fWAsXG4gICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgIFNvdXJjZTogXCJzZGsvZGVsZXRlR3JvdXBcIlxuICAgIH07XG4gIH1cbiAgbGV0IGVuZHBvaW50ID0gXCJodHRwczovL2FwaS5waW5hdGEuY2xvdWQvdjNcIjtcbiAgaWYgKGNvbmZpZy5lbmRwb2ludFVybCkge1xuICAgIGVuZHBvaW50ID0gY29uZmlnLmVuZHBvaW50VXJsO1xuICB9XG4gIHRyeSB7XG4gICAgY29uc3QgcmVxdWVzdCA9IGF3YWl0IGZldGNoKGAke2VuZHBvaW50fS9maWxlcy9ncm91cHMvJHtvcHRpb25zLmdyb3VwSWR9YCwge1xuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgICAgaGVhZGVyc1xuICAgIH0pO1xuICAgIGlmICghcmVxdWVzdC5vaykge1xuICAgICAgY29uc3QgZXJyb3JEYXRhID0gYXdhaXQgcmVxdWVzdC50ZXh0KCk7XG4gICAgICBpZiAocmVxdWVzdC5zdGF0dXMgPT09IDQwMSB8fCByZXF1ZXN0LnN0YXR1cyA9PT0gNDAzKSB7XG4gICAgICAgIHRocm93IG5ldyBBdXRoZW50aWNhdGlvbkVycm9yKFxuICAgICAgICAgIGBBdXRoZW50aWNhdGlvbiBmYWlsZWQ6ICR7ZXJyb3JEYXRhfWAsXG4gICAgICAgICAgcmVxdWVzdC5zdGF0dXMsXG4gICAgICAgICAgZXJyb3JEYXRhXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgICB0aHJvdyBuZXcgTmV0d29ya0Vycm9yKFxuICAgICAgICBgSFRUUCBlcnJvcjogJHtlcnJvckRhdGF9YCxcbiAgICAgICAgcmVxdWVzdC5zdGF0dXMsXG4gICAgICAgIGVycm9yRGF0YVxuICAgICAgKTtcbiAgICB9XG4gICAgY29uc3QgcmVzID0gcmVxdWVzdC5zdGF0dXNUZXh0O1xuICAgIHJldHVybiByZXM7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgaWYgKGVycm9yIGluc3RhbmNlb2YgUGluYXRhRXJyb3IpIHtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBFcnJvcikge1xuICAgICAgdGhyb3cgbmV3IFBpbmF0YUVycm9yKGBFcnJvciBwcm9jZXNzaW5nIGRlbGV0ZUdyb3VwOiAke2Vycm9yLm1lc3NhZ2V9YCk7XG4gICAgfVxuICAgIHRocm93IG5ldyBQaW5hdGFFcnJvcihcIkFuIHVua25vd24gZXJyb3Igb2NjdXJyZWQgd2hpbGUgZGVsZXRpbmcgYSBncm91cFwiKTtcbiAgfVxufTtcblxuLy8gc3JjL2NvcmUvYW5hbHl0aWNzL2FuYWx5dGljc1RvcFVzYWdlLnRzXG52YXIgYW5hbHl0aWNzVG9wVXNhZ2UgPSBhc3luYyAoY29uZmlnLCBvcHRpb25zKSA9PiB7XG4gIGlmICghY29uZmlnKSB7XG4gICAgdGhyb3cgbmV3IFZhbGlkYXRpb25FcnJvcihcIlBpbmF0YSBjb25maWd1cmF0aW9uIGlzIG1pc3NpbmdcIik7XG4gIH1cbiAgY29uc3QgcGFyYW1zID0gbmV3IFVSTFNlYXJjaFBhcmFtcygpO1xuICBpZiAob3B0aW9ucykge1xuICAgIGNvbnN0IHtcbiAgICAgIGNpZCxcbiAgICAgIGdhdGV3YXlfZG9tYWluLFxuICAgICAgc3RhcnRfZGF0ZSxcbiAgICAgIGVuZF9kYXRlLFxuICAgICAgZmlsZV9uYW1lLFxuICAgICAgdXNlcl9hZ2VudCxcbiAgICAgIGNvdW50cnksXG4gICAgICByZWdpb24sXG4gICAgICByZWZlcmVyLFxuICAgICAgbGltaXQsXG4gICAgICBzb3J0X29yZGVyLFxuICAgICAgc29ydF9ieSxcbiAgICAgIGF0dHJpYnV0ZVxuICAgIH0gPSBvcHRpb25zO1xuICAgIGNvbnN0IGRvbWFpbiA9IGdhdGV3YXlfZG9tYWluIHx8IGNvbmZpZy5waW5hdGFHYXRld2F5O1xuICAgIGlmIChkb21haW4pIHtcbiAgICAgIGNvbnN0IGNsZWFuRG9tYWluID0gZG9tYWluLnJlcGxhY2UoL15odHRwcz86XFwvXFwvLywgXCJcIik7XG4gICAgICBwYXJhbXMuYXBwZW5kKFwiZ2F0ZXdheV9kb21haW5cIiwgY2xlYW5Eb21haW4pO1xuICAgIH1cbiAgICBpZiAoY2lkKSB7XG4gICAgICBwYXJhbXMuYXBwZW5kKFwiY2lkXCIsIGNpZCk7XG4gICAgfVxuICAgIGlmIChzdGFydF9kYXRlKVxuICAgICAgcGFyYW1zLmFwcGVuZChcInN0YXJ0X2RhdGVcIiwgc3RhcnRfZGF0ZSk7XG4gICAgaWYgKGVuZF9kYXRlKVxuICAgICAgcGFyYW1zLmFwcGVuZChcImVuZF9kYXRlXCIsIGVuZF9kYXRlKTtcbiAgICBpZiAoZmlsZV9uYW1lKVxuICAgICAgcGFyYW1zLmFwcGVuZChcImZpbGVfbmFtZVwiLCBmaWxlX25hbWUpO1xuICAgIGlmICh1c2VyX2FnZW50KVxuICAgICAgcGFyYW1zLmFwcGVuZChcInVzZXJfYWdlbnRcIiwgdXNlcl9hZ2VudC50b1N0cmluZygpKTtcbiAgICBpZiAoY291bnRyeSlcbiAgICAgIHBhcmFtcy5hcHBlbmQoXCJjb3VudHJ5XCIsIGNvdW50cnkudG9TdHJpbmcoKSk7XG4gICAgaWYgKHJlZ2lvbilcbiAgICAgIHBhcmFtcy5hcHBlbmQoXCJyZWdpb25cIiwgcmVnaW9uKTtcbiAgICBpZiAocmVmZXJlcilcbiAgICAgIHBhcmFtcy5hcHBlbmQoXCJyZWZlcmVyXCIsIHJlZmVyZXIudG9TdHJpbmcoKSk7XG4gICAgaWYgKGxpbWl0KVxuICAgICAgcGFyYW1zLmFwcGVuZChcImxpbWl0XCIsIGxpbWl0LnRvU3RyaW5nKCkpO1xuICAgIGlmIChzb3J0X29yZGVyKVxuICAgICAgcGFyYW1zLmFwcGVuZChcInNvcnRfb3JkZXJcIiwgc29ydF9vcmRlcik7XG4gICAgaWYgKHNvcnRfYnkpXG4gICAgICBwYXJhbXMuYXBwZW5kKFwic29ydF9ieVwiLCBzb3J0X2J5KTtcbiAgICBpZiAoYXR0cmlidXRlKVxuICAgICAgcGFyYW1zLmFwcGVuZChcImJ5XCIsIGF0dHJpYnV0ZSk7XG4gIH1cbiAgbGV0IGVuZHBvaW50ID0gXCJodHRwczovL2FwaS5waW5hdGEuY2xvdWQvdjNcIjtcbiAgaWYgKGNvbmZpZy5lbmRwb2ludFVybCkge1xuICAgIGVuZHBvaW50ID0gY29uZmlnLmVuZHBvaW50VXJsO1xuICB9XG4gIGNvbnN0IHVybCA9IGAke2VuZHBvaW50fS9pcGZzL2dhdGV3YXlfYW5hbHl0aWNzX3RvcD8ke3BhcmFtcy50b1N0cmluZygpfWA7XG4gIHRyeSB7XG4gICAgbGV0IGhlYWRlcnM7XG4gICAgaWYgKGNvbmZpZy5jdXN0b21IZWFkZXJzICYmIE9iamVjdC5rZXlzKGNvbmZpZy5jdXN0b21IZWFkZXJzKS5sZW5ndGggPiAwKSB7XG4gICAgICBoZWFkZXJzID0geyAuLi5jb25maWcuY3VzdG9tSGVhZGVycyB9O1xuICAgIH0gZWxzZSB7XG4gICAgICBoZWFkZXJzID0ge1xuICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7Y29uZmlnLnBpbmF0YUp3dH1gLFxuICAgICAgICBTb3VyY2U6IFwic2RrL2FuYWx5dGljc1RvcFVzYWdlXCJcbiAgICAgIH07XG4gICAgfVxuICAgIGNvbnN0IHJlcXVlc3QgPSBhd2FpdCBmZXRjaCh1cmwsIHtcbiAgICAgIG1ldGhvZDogXCJHRVRcIixcbiAgICAgIGhlYWRlcnNcbiAgICB9KTtcbiAgICBpZiAoIXJlcXVlc3Qub2spIHtcbiAgICAgIGNvbnN0IGVycm9yRGF0YSA9IGF3YWl0IHJlcXVlc3QudGV4dCgpO1xuICAgICAgaWYgKHJlcXVlc3Quc3RhdHVzID09PSA0MDEgfHwgcmVxdWVzdC5zdGF0dXMgPT09IDQwMykge1xuICAgICAgICB0aHJvdyBuZXcgQXV0aGVudGljYXRpb25FcnJvcihcbiAgICAgICAgICBgQXV0aGVudGljYXRpb24gZmFpbGVkOiAke2Vycm9yRGF0YX1gLFxuICAgICAgICAgIHJlcXVlc3Quc3RhdHVzLFxuICAgICAgICAgIGVycm9yRGF0YVxuICAgICAgICApO1xuICAgICAgfVxuICAgICAgdGhyb3cgbmV3IE5ldHdvcmtFcnJvcihcbiAgICAgICAgYEhUVFAgZXJyb3I6ICR7ZXJyb3JEYXRhfWAsXG4gICAgICAgIHJlcXVlc3Quc3RhdHVzLFxuICAgICAgICBlcnJvckRhdGFcbiAgICAgICk7XG4gICAgfVxuICAgIGNvbnN0IHJlcyA9IGF3YWl0IHJlcXVlc3QuanNvbigpO1xuICAgIHJldHVybiByZXM7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgaWYgKGVycm9yIGluc3RhbmNlb2YgUGluYXRhRXJyb3IpIHtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBFcnJvcikge1xuICAgICAgdGhyb3cgbmV3IFBpbmF0YUVycm9yKFxuICAgICAgICBgRXJyb3IgcHJvY2Vzc2luZyBhbmF5dGljcyB1c2FnZTogJHtlcnJvci5tZXNzYWdlfWBcbiAgICAgICk7XG4gICAgfVxuICAgIHRocm93IG5ldyBQaW5hdGFFcnJvcihcbiAgICAgIFwiQW4gdW5rbm93biBlcnJvciBvY2N1cnJlZCB3aGlsZSBmZXRjaGluZyBnYXRld2F5IHVzYWdlXCJcbiAgICApO1xuICB9XG59O1xuXG4vLyBzcmMvY29yZS9hbmFseXRpY3MvYW5hbHl0aWNzRGF0ZUludGVydmFsLnRzXG52YXIgYW5hbHl0aWNzRGF0ZUludGVydmFsID0gYXN5bmMgKGNvbmZpZywgb3B0aW9ucykgPT4ge1xuICBpZiAoIWNvbmZpZykge1xuICAgIHRocm93IG5ldyBWYWxpZGF0aW9uRXJyb3IoXCJQaW5hdGEgY29uZmlndXJhdGlvbiBpcyBtaXNzaW5nXCIpO1xuICB9XG4gIGNvbnN0IHBhcmFtcyA9IG5ldyBVUkxTZWFyY2hQYXJhbXMoKTtcbiAgaWYgKG9wdGlvbnMpIHtcbiAgICBjb25zdCB7XG4gICAgICBjaWQsXG4gICAgICBnYXRld2F5X2RvbWFpbixcbiAgICAgIHN0YXJ0X2RhdGUsXG4gICAgICBlbmRfZGF0ZSxcbiAgICAgIGZpbGVfbmFtZSxcbiAgICAgIHVzZXJfYWdlbnQsXG4gICAgICBjb3VudHJ5LFxuICAgICAgcmVnaW9uLFxuICAgICAgcmVmZXJlcixcbiAgICAgIGxpbWl0LFxuICAgICAgc29ydF9vcmRlcixcbiAgICAgIGRhdGVfaW50ZXJ2YWwsXG4gICAgICBzb3J0X2J5XG4gICAgfSA9IG9wdGlvbnM7XG4gICAgaWYgKGNpZClcbiAgICAgIHBhcmFtcy5hcHBlbmQoXCJjaWRcIiwgY2lkKTtcbiAgICBpZiAoZ2F0ZXdheV9kb21haW4pXG4gICAgICBwYXJhbXMuYXBwZW5kKFwiZ2F0ZXdheV9kb21haW5cIiwgZ2F0ZXdheV9kb21haW4pO1xuICAgIGlmIChzdGFydF9kYXRlKVxuICAgICAgcGFyYW1zLmFwcGVuZChcInN0YXJ0X2RhdGVcIiwgc3RhcnRfZGF0ZSk7XG4gICAgaWYgKGVuZF9kYXRlKVxuICAgICAgcGFyYW1zLmFwcGVuZChcImVuZF9kYXRlXCIsIGVuZF9kYXRlKTtcbiAgICBpZiAoZmlsZV9uYW1lKVxuICAgICAgcGFyYW1zLmFwcGVuZChcImZpbGVfbmFtZVwiLCBmaWxlX25hbWUpO1xuICAgIGlmICh1c2VyX2FnZW50KVxuICAgICAgcGFyYW1zLmFwcGVuZChcInVzZXJfYWdlbnRcIiwgdXNlcl9hZ2VudC50b1N0cmluZygpKTtcbiAgICBpZiAoY291bnRyeSlcbiAgICAgIHBhcmFtcy5hcHBlbmQoXCJjb3VudHJ5XCIsIGNvdW50cnkudG9TdHJpbmcoKSk7XG4gICAgaWYgKHJlZ2lvbilcbiAgICAgIHBhcmFtcy5hcHBlbmQoXCJyZWdpb25cIiwgcmVnaW9uKTtcbiAgICBpZiAocmVmZXJlcilcbiAgICAgIHBhcmFtcy5hcHBlbmQoXCJyZWZlcmVyXCIsIHJlZmVyZXIudG9TdHJpbmcoKSk7XG4gICAgaWYgKGxpbWl0KVxuICAgICAgcGFyYW1zLmFwcGVuZChcImxpbWl0XCIsIGxpbWl0LnRvU3RyaW5nKCkpO1xuICAgIGlmIChzb3J0X29yZGVyKVxuICAgICAgcGFyYW1zLmFwcGVuZChcInNvcnRfb3JkZXJcIiwgc29ydF9vcmRlcik7XG4gICAgaWYgKHNvcnRfYnkpXG4gICAgICBwYXJhbXMuYXBwZW5kKFwic29ydF9ieVwiLCBzb3J0X2J5KTtcbiAgICBpZiAoZGF0ZV9pbnRlcnZhbClcbiAgICAgIHBhcmFtcy5hcHBlbmQoXCJieVwiLCBkYXRlX2ludGVydmFsKTtcbiAgfVxuICBsZXQgZW5kcG9pbnQgPSBcImh0dHBzOi8vYXBpLnBpbmF0YS5jbG91ZC92M1wiO1xuICBpZiAoY29uZmlnLmVuZHBvaW50VXJsKSB7XG4gICAgZW5kcG9pbnQgPSBjb25maWcuZW5kcG9pbnRVcmw7XG4gIH1cbiAgY29uc3QgdXJsID0gYCR7ZW5kcG9pbnR9L2lwZnMvZ2F0ZXdheV9hbmFseXRpY3NfdGltZV9zZXJpZXM/JHtwYXJhbXMudG9TdHJpbmcoKX1gO1xuICB0cnkge1xuICAgIGxldCBoZWFkZXJzO1xuICAgIGlmIChjb25maWcuY3VzdG9tSGVhZGVycyAmJiBPYmplY3Qua2V5cyhjb25maWcuY3VzdG9tSGVhZGVycykubGVuZ3RoID4gMCkge1xuICAgICAgaGVhZGVycyA9IHsgLi4uY29uZmlnLmN1c3RvbUhlYWRlcnMgfTtcbiAgICB9IGVsc2Uge1xuICAgICAgaGVhZGVycyA9IHtcbiAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke2NvbmZpZy5waW5hdGFKd3R9YCxcbiAgICAgICAgU291cmNlOiBcInNkay9hbmFseXRpY3NEYXRlSW50ZXJ2YWxcIlxuICAgICAgfTtcbiAgICB9XG4gICAgY29uc3QgcmVxdWVzdCA9IGF3YWl0IGZldGNoKHVybCwge1xuICAgICAgbWV0aG9kOiBcIkdFVFwiLFxuICAgICAgaGVhZGVyc1xuICAgIH0pO1xuICAgIGlmICghcmVxdWVzdC5vaykge1xuICAgICAgY29uc3QgZXJyb3JEYXRhID0gYXdhaXQgcmVxdWVzdC50ZXh0KCk7XG4gICAgICBpZiAocmVxdWVzdC5zdGF0dXMgPT09IDQwMSB8fCByZXF1ZXN0LnN0YXR1cyA9PT0gNDAzKSB7XG4gICAgICAgIHRocm93IG5ldyBBdXRoZW50aWNhdGlvbkVycm9yKFxuICAgICAgICAgIGBBdXRoZW50aWNhdGlvbiBmYWlsZWQ6ICR7ZXJyb3JEYXRhfWAsXG4gICAgICAgICAgcmVxdWVzdC5zdGF0dXMsXG4gICAgICAgICAgZXJyb3JEYXRhXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgICB0aHJvdyBuZXcgTmV0d29ya0Vycm9yKFxuICAgICAgICBgSFRUUCBlcnJvcjogJHtlcnJvckRhdGF9YCxcbiAgICAgICAgcmVxdWVzdC5zdGF0dXMsXG4gICAgICAgIGVycm9yRGF0YVxuICAgICAgKTtcbiAgICB9XG4gICAgY29uc3QgcmVzID0gYXdhaXQgcmVxdWVzdC5qc29uKCk7XG4gICAgY29uc3QgcmVzRGF0YSA9IHJlcy5kYXRhO1xuICAgIHJldHVybiByZXNEYXRhO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIFBpbmF0YUVycm9yKSB7XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gICAgaWYgKGVycm9yIGluc3RhbmNlb2YgRXJyb3IpIHtcbiAgICAgIHRocm93IG5ldyBQaW5hdGFFcnJvcihcbiAgICAgICAgYEVycm9yIHByb2Nlc3NpbmcgYW5heXRpY3MgdXNhZ2U6ICR7ZXJyb3IubWVzc2FnZX1gXG4gICAgICApO1xuICAgIH1cbiAgICB0aHJvdyBuZXcgUGluYXRhRXJyb3IoXG4gICAgICBcIkFuIHVua25vd24gZXJyb3Igb2NjdXJyZWQgd2hpbGUgZmV0Y2hpbmcgZ2F0ZXdheSB1c2FnZVwiXG4gICAgKTtcbiAgfVxufTtcblxuLy8gc3JjL2NvcmUvZmlsZXMvc3dhcENpZC50c1xudmFyIHN3YXBDaWQgPSBhc3luYyAoY29uZmlnLCBvcHRpb25zKSA9PiB7XG4gIGlmICghY29uZmlnKSB7XG4gICAgdGhyb3cgbmV3IFZhbGlkYXRpb25FcnJvcihcIlBpbmF0YSBjb25maWd1cmF0aW9uIGlzIG1pc3NpbmdcIik7XG4gIH1cbiAgY29uc3QgZGF0YSA9IEpTT04uc3RyaW5naWZ5KHtcbiAgICBzd2FwX2NpZDogb3B0aW9ucy5zd2FwQ2lkXG4gIH0pO1xuICBsZXQgaGVhZGVycztcbiAgaWYgKGNvbmZpZy5jdXN0b21IZWFkZXJzICYmIE9iamVjdC5rZXlzKGNvbmZpZy5jdXN0b21IZWFkZXJzKS5sZW5ndGggPiAwKSB7XG4gICAgaGVhZGVycyA9IHtcbiAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHtjb25maWcucGluYXRhSnd0fWAsXG4gICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgIC4uLmNvbmZpZy5jdXN0b21IZWFkZXJzXG4gICAgfTtcbiAgfSBlbHNlIHtcbiAgICBoZWFkZXJzID0ge1xuICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke2NvbmZpZy5waW5hdGFKd3R9YCxcbiAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgU291cmNlOiBcInNkay9zd2FwQ2lkXCJcbiAgICB9O1xuICB9XG4gIGxldCBlbmRwb2ludCA9IFwiaHR0cHM6Ly9hcGkucGluYXRhLmNsb3VkL3YzXCI7XG4gIGlmIChjb25maWcuZW5kcG9pbnRVcmwpIHtcbiAgICBlbmRwb2ludCA9IGNvbmZpZy5lbmRwb2ludFVybDtcbiAgfVxuICB0cnkge1xuICAgIGNvbnN0IHJlcXVlc3QgPSBhd2FpdCBmZXRjaChgJHtlbmRwb2ludH0vZmlsZXMvc3dhcC8ke29wdGlvbnMuY2lkfWAsIHtcbiAgICAgIG1ldGhvZDogXCJQVVRcIixcbiAgICAgIGhlYWRlcnMsXG4gICAgICBib2R5OiBkYXRhXG4gICAgfSk7XG4gICAgaWYgKCFyZXF1ZXN0Lm9rKSB7XG4gICAgICBjb25zdCBlcnJvckRhdGEgPSBhd2FpdCByZXF1ZXN0LnRleHQoKTtcbiAgICAgIGlmIChyZXF1ZXN0LnN0YXR1cyA9PT0gNDAxIHx8IHJlcXVlc3Quc3RhdHVzID09PSA0MDMpIHtcbiAgICAgICAgdGhyb3cgbmV3IEF1dGhlbnRpY2F0aW9uRXJyb3IoXG4gICAgICAgICAgYEF1dGhlbnRpY2F0aW9uIGZhaWxlZDogJHtlcnJvckRhdGF9YCxcbiAgICAgICAgICByZXF1ZXN0LnN0YXR1cyxcbiAgICAgICAgICBlcnJvckRhdGFcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICAgIGlmIChyZXF1ZXN0LnN0YXR1cyA9PT0gNDAzKSB7XG4gICAgICAgIHRocm93IG5ldyBQaW5hdGFFcnJvcihcbiAgICAgICAgICBcIlVuYXV0aG9yaXplZCBDSUQgU3dhcFwiLFxuICAgICAgICAgIHJlcXVlc3Quc3RhdHVzLFxuICAgICAgICAgIGVycm9yRGF0YVxuICAgICAgICApO1xuICAgICAgfVxuICAgICAgaWYgKHJlcXVlc3Quc3RhdHVzID09PSA0MDQpIHtcbiAgICAgICAgdGhyb3cgbmV3IFBpbmF0YUVycm9yKFxuICAgICAgICAgIFwiQ0lEIG5vdCBwaW5uZWQgdG8gYWNjb3VudFwiLFxuICAgICAgICAgIHJlcXVlc3Quc3RhdHVzLFxuICAgICAgICAgIGVycm9yRGF0YVxuICAgICAgICApO1xuICAgICAgfVxuICAgICAgdGhyb3cgbmV3IE5ldHdvcmtFcnJvcihcbiAgICAgICAgYEhUVFAgZXJyb3I6ICR7ZXJyb3JEYXRhfWAsXG4gICAgICAgIHJlcXVlc3Quc3RhdHVzLFxuICAgICAgICBlcnJvckRhdGFcbiAgICAgICk7XG4gICAgfVxuICAgIGNvbnN0IHJlcyA9IGF3YWl0IHJlcXVlc3QuanNvbigpO1xuICAgIGNvbnN0IHJlc0RhdGEgPSByZXMuZGF0YTtcbiAgICByZXR1cm4gcmVzRGF0YTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBQaW5hdGFFcnJvcikge1xuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIEVycm9yKSB7XG4gICAgICB0aHJvdyBuZXcgUGluYXRhRXJyb3IoYEVycm9yIHByb2Nlc3NpbmcgQ0lEIFN3YXA6ICR7ZXJyb3IubWVzc2FnZX1gKTtcbiAgICB9XG4gICAgdGhyb3cgbmV3IFBpbmF0YUVycm9yKFwiQW4gdW5rbm93biBlcnJvciBvY2N1cnJlZCB3aGlsZSBzd2FwcGluZyBDSURcIik7XG4gIH1cbn07XG5cbi8vIHNyYy9jb3JlL2ZpbGVzL3N3YXBIaXN0b3J5LnRzXG52YXIgc3dhcEhpc3RvcnkgPSBhc3luYyAoY29uZmlnLCBvcHRpb25zKSA9PiB7XG4gIGlmICghY29uZmlnKSB7XG4gICAgdGhyb3cgbmV3IFZhbGlkYXRpb25FcnJvcihcIlBpbmF0YSBjb25maWd1cmF0aW9uIGlzIG1pc3NpbmdcIik7XG4gIH1cbiAgbGV0IGhlYWRlcnM7XG4gIGlmIChjb25maWcuY3VzdG9tSGVhZGVycyAmJiBPYmplY3Qua2V5cyhjb25maWcuY3VzdG9tSGVhZGVycykubGVuZ3RoID4gMCkge1xuICAgIGhlYWRlcnMgPSB7XG4gICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7Y29uZmlnLnBpbmF0YUp3dH1gLFxuICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gICAgICAuLi5jb25maWcuY3VzdG9tSGVhZGVyc1xuICAgIH07XG4gIH0gZWxzZSB7XG4gICAgaGVhZGVycyA9IHtcbiAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHtjb25maWcucGluYXRhSnd0fWAsXG4gICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgIFNvdXJjZTogXCJzZGsvc3dhcEhpc3RvcnlcIlxuICAgIH07XG4gIH1cbiAgbGV0IGVuZHBvaW50ID0gXCJodHRwczovL2FwaS5waW5hdGEuY2xvdWQvdjNcIjtcbiAgaWYgKGNvbmZpZy5lbmRwb2ludFVybCkge1xuICAgIGVuZHBvaW50ID0gY29uZmlnLmVuZHBvaW50VXJsO1xuICB9XG4gIHRyeSB7XG4gICAgY29uc3QgcmVxdWVzdCA9IGF3YWl0IGZldGNoKFxuICAgICAgYCR7ZW5kcG9pbnR9L2ZpbGVzL3N3YXAvJHtvcHRpb25zLmNpZH0/ZG9tYWluPSR7b3B0aW9ucy5kb21haW59YCxcbiAgICAgIHtcbiAgICAgICAgbWV0aG9kOiBcIkdFVFwiLFxuICAgICAgICBoZWFkZXJzXG4gICAgICB9XG4gICAgKTtcbiAgICBpZiAoIXJlcXVlc3Qub2spIHtcbiAgICAgIGNvbnN0IGVycm9yRGF0YSA9IGF3YWl0IHJlcXVlc3QudGV4dCgpO1xuICAgICAgaWYgKHJlcXVlc3Quc3RhdHVzID09PSA0MDEgfHwgcmVxdWVzdC5zdGF0dXMgPT09IDQwMykge1xuICAgICAgICB0aHJvdyBuZXcgQXV0aGVudGljYXRpb25FcnJvcihcbiAgICAgICAgICBgQXV0aGVudGljYXRpb24gZmFpbGVkOiAke2Vycm9yRGF0YX1gLFxuICAgICAgICAgIHJlcXVlc3Quc3RhdHVzLFxuICAgICAgICAgIGVycm9yRGF0YVxuICAgICAgICApO1xuICAgICAgfVxuICAgICAgaWYgKHJlcXVlc3Quc3RhdHVzID09PSA0MDQpIHtcbiAgICAgICAgdGhyb3cgbmV3IFBpbmF0YUVycm9yKFxuICAgICAgICAgIFwiQ0lEIGRvZXMgbm90IGhhdmUgaGlzdG9yeVwiLFxuICAgICAgICAgIHJlcXVlc3Quc3RhdHVzLFxuICAgICAgICAgIGVycm9yRGF0YVxuICAgICAgICApO1xuICAgICAgfVxuICAgICAgdGhyb3cgbmV3IE5ldHdvcmtFcnJvcihcbiAgICAgICAgYEhUVFAgZXJyb3I6ICR7ZXJyb3JEYXRhfWAsXG4gICAgICAgIHJlcXVlc3Quc3RhdHVzLFxuICAgICAgICBlcnJvckRhdGFcbiAgICAgICk7XG4gICAgfVxuICAgIGNvbnN0IHJlcyA9IGF3YWl0IHJlcXVlc3QuanNvbigpO1xuICAgIGNvbnN0IHJlc0RhdGEgPSByZXMuZGF0YTtcbiAgICByZXR1cm4gcmVzRGF0YTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBQaW5hdGFFcnJvcikge1xuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIEVycm9yKSB7XG4gICAgICB0aHJvdyBuZXcgUGluYXRhRXJyb3IoYEVycm9yIGZldGNoaW5nIHN3YXAgaGlzdG9yeTogJHtlcnJvci5tZXNzYWdlfWApO1xuICAgIH1cbiAgICB0aHJvdyBuZXcgUGluYXRhRXJyb3IoXG4gICAgICBcIkFuIHVua25vd24gZXJyb3Igb2NjdXJyZWQgd2hpbGUgZmV0Y2hpbmcgc3dhcCBoaXN0b3J5XCJcbiAgICApO1xuICB9XG59O1xuXG4vLyBzcmMvY29yZS9maWxlcy9kZWxldGVTd2FwLnRzXG52YXIgZGVsZXRlU3dhcCA9IGFzeW5jIChjb25maWcsIGNpZCkgPT4ge1xuICBpZiAoIWNvbmZpZykge1xuICAgIHRocm93IG5ldyBWYWxpZGF0aW9uRXJyb3IoXCJQaW5hdGEgY29uZmlndXJhdGlvbiBpcyBtaXNzaW5nXCIpO1xuICB9XG4gIGxldCBoZWFkZXJzO1xuICBpZiAoY29uZmlnLmN1c3RvbUhlYWRlcnMgJiYgT2JqZWN0LmtleXMoY29uZmlnLmN1c3RvbUhlYWRlcnMpLmxlbmd0aCA+IDApIHtcbiAgICBoZWFkZXJzID0ge1xuICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke2NvbmZpZy5waW5hdGFKd3R9YCxcbiAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgLi4uY29uZmlnLmN1c3RvbUhlYWRlcnNcbiAgICB9O1xuICB9IGVsc2Uge1xuICAgIGhlYWRlcnMgPSB7XG4gICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7Y29uZmlnLnBpbmF0YUp3dH1gLFxuICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gICAgICBTb3VyY2U6IFwic2RrL2RlbGV0ZVN3YXBcIlxuICAgIH07XG4gIH1cbiAgbGV0IGVuZHBvaW50ID0gXCJodHRwczovL2FwaS5waW5hdGEuY2xvdWQvdjNcIjtcbiAgaWYgKGNvbmZpZy5lbmRwb2ludFVybCkge1xuICAgIGVuZHBvaW50ID0gY29uZmlnLmVuZHBvaW50VXJsO1xuICB9XG4gIHRyeSB7XG4gICAgY29uc3QgcmVxdWVzdCA9IGF3YWl0IGZldGNoKGAke2VuZHBvaW50fS9maWxlcy9zd2FwLyR7Y2lkfWAsIHtcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcbiAgICAgIGhlYWRlcnNcbiAgICB9KTtcbiAgICBpZiAoIXJlcXVlc3Qub2spIHtcbiAgICAgIGNvbnN0IGVycm9yRGF0YSA9IGF3YWl0IHJlcXVlc3QudGV4dCgpO1xuICAgICAgaWYgKHJlcXVlc3Quc3RhdHVzID09PSA0MDEgfHwgcmVxdWVzdC5zdGF0dXMgPT09IDQwMykge1xuICAgICAgICB0aHJvdyBuZXcgQXV0aGVudGljYXRpb25FcnJvcihcbiAgICAgICAgICBgQXV0aGVudGljYXRpb24gZmFpbGVkOiAke2Vycm9yRGF0YX1gLFxuICAgICAgICAgIHJlcXVlc3Quc3RhdHVzLFxuICAgICAgICAgIGVycm9yRGF0YVxuICAgICAgICApO1xuICAgICAgfVxuICAgICAgaWYgKHJlcXVlc3Quc3RhdHVzID09PSA0MDMpIHtcbiAgICAgICAgdGhyb3cgbmV3IFBpbmF0YUVycm9yKFxuICAgICAgICAgIFwiVW5hdXRob3JpemVkIENJRCBTd2FwIERlbGV0aW9uXCIsXG4gICAgICAgICAgcmVxdWVzdC5zdGF0dXMsXG4gICAgICAgICAgZXJyb3JEYXRhXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgICBpZiAocmVxdWVzdC5zdGF0dXMgPT09IDQwNCkge1xuICAgICAgICB0aHJvdyBuZXcgUGluYXRhRXJyb3IoXG4gICAgICAgICAgXCJDSUQgbm90IHBpbm5lZCB0byBhY2NvdW50XCIsXG4gICAgICAgICAgcmVxdWVzdC5zdGF0dXMsXG4gICAgICAgICAgZXJyb3JEYXRhXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgICB0aHJvdyBuZXcgTmV0d29ya0Vycm9yKFxuICAgICAgICBgSFRUUCBlcnJvcjogJHtlcnJvckRhdGF9YCxcbiAgICAgICAgcmVxdWVzdC5zdGF0dXMsXG4gICAgICAgIGVycm9yRGF0YVxuICAgICAgKTtcbiAgICB9XG4gICAgcmV0dXJuIHJlcXVlc3Quc3RhdHVzVGV4dDtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBQaW5hdGFFcnJvcikge1xuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIEVycm9yKSB7XG4gICAgICB0aHJvdyBuZXcgUGluYXRhRXJyb3IoYEVycm9yIHByb2Nlc3NpbmcgZGVsZXRlU3dhcDogJHtlcnJvci5tZXNzYWdlfWApO1xuICAgIH1cbiAgICB0aHJvdyBuZXcgUGluYXRhRXJyb3IoXCJBbiB1bmtub3duIGVycm9yIG9jY3VycmVkIHdoaWxlIGRlbGV0aW5nIHN3YXBcIik7XG4gIH1cbn07XG5cbi8vIHNyYy9jb3JlL2dhdGV3YXkvY3JlYXRlU2lnbmVkVVJMLnRzXG52YXIgY3JlYXRlU2lnbmVkVVJMID0gYXN5bmMgKGNvbmZpZywgb3B0aW9ucywgaW1nT3B0cykgPT4ge1xuICBpZiAoIWNvbmZpZykge1xuICAgIHRocm93IG5ldyBWYWxpZGF0aW9uRXJyb3IoXCJQaW5hdGEgY29uZmlndXJhdGlvbiBpcyBtaXNzaW5nXCIpO1xuICB9XG4gIGxldCBiYXNlVXJsO1xuICBpZiAob3B0aW9ucz8uZ2F0ZXdheSkge1xuICAgIGJhc2VVcmwgPSBvcHRpb25zLmdhdGV3YXkuc3RhcnRzV2l0aChcImh0dHBzOi8vXCIpID8gb3B0aW9ucy5nYXRld2F5IDogYGh0dHBzOi8vJHtvcHRpb25zLmdhdGV3YXl9YDtcbiAgfSBlbHNlIHtcbiAgICBiYXNlVXJsID0gY29uZmlnLnBpbmF0YUdhdGV3YXk7XG4gIH1cbiAgbGV0IG5ld1VybCA9IGAke2Jhc2VVcmx9L2ZpbGVzLyR7b3B0aW9ucy5jaWR9YDtcbiAgY29uc3QgcGFyYW1zID0gbmV3IFVSTFNlYXJjaFBhcmFtcygpO1xuICBpZiAoaW1nT3B0cykge1xuICAgIGlmIChpbWdPcHRzLndpZHRoKVxuICAgICAgcGFyYW1zLmFwcGVuZChcImltZy13aWR0aFwiLCBpbWdPcHRzLndpZHRoLnRvU3RyaW5nKCkpO1xuICAgIGlmIChpbWdPcHRzLmhlaWdodClcbiAgICAgIHBhcmFtcy5hcHBlbmQoXCJpbWctaGVpZ2h0XCIsIGltZ09wdHMuaGVpZ2h0LnRvU3RyaW5nKCkpO1xuICAgIGlmIChpbWdPcHRzLmRwcilcbiAgICAgIHBhcmFtcy5hcHBlbmQoXCJpbWctZHByXCIsIGltZ09wdHMuZHByLnRvU3RyaW5nKCkpO1xuICAgIGlmIChpbWdPcHRzLmZpdClcbiAgICAgIHBhcmFtcy5hcHBlbmQoXCJpbWctZml0XCIsIGltZ09wdHMuZml0KTtcbiAgICBpZiAoaW1nT3B0cy5ncmF2aXR5KVxuICAgICAgcGFyYW1zLmFwcGVuZChcImltZy1ncmF2aXR5XCIsIGltZ09wdHMuZ3Jhdml0eSk7XG4gICAgaWYgKGltZ09wdHMucXVhbGl0eSlcbiAgICAgIHBhcmFtcy5hcHBlbmQoXCJpbWctcXVhbGl0eVwiLCBpbWdPcHRzLnF1YWxpdHkudG9TdHJpbmcoKSk7XG4gICAgaWYgKGltZ09wdHMuZm9ybWF0KVxuICAgICAgcGFyYW1zLmFwcGVuZChcImltZy1mb3JtYXRcIiwgaW1nT3B0cy5mb3JtYXQpO1xuICAgIGlmIChpbWdPcHRzLmFuaW1hdGlvbiAhPT0gdm9pZCAwKVxuICAgICAgcGFyYW1zLmFwcGVuZChcImltZy1hbmltXCIsIGltZ09wdHMuYW5pbWF0aW9uLnRvU3RyaW5nKCkpO1xuICAgIGlmIChpbWdPcHRzLnNoYXJwZW4pXG4gICAgICBwYXJhbXMuYXBwZW5kKFwiaW1nLXNoYXJwZW5cIiwgaW1nT3B0cy5zaGFycGVuLnRvU3RyaW5nKCkpO1xuICAgIGlmIChpbWdPcHRzLm9uRXJyb3IgPT09IHRydWUpXG4gICAgICBwYXJhbXMuYXBwZW5kKFwiaW1nLW9uZXJyb3JcIiwgXCJyZWRpcmVjdFwiKTtcbiAgICBpZiAoaW1nT3B0cy5tZXRhZGF0YSlcbiAgICAgIHBhcmFtcy5hcHBlbmQoXCJpbWctbWV0YWRhdGFcIiwgaW1nT3B0cy5tZXRhZGF0YSk7XG4gIH1cbiAgY29uc3QgcXVlcnlTdHJpbmcgPSBwYXJhbXMudG9TdHJpbmcoKTtcbiAgaWYgKHF1ZXJ5U3RyaW5nKSB7XG4gICAgbmV3VXJsICs9IGA/JHtxdWVyeVN0cmluZ31gO1xuICB9XG4gIGNvbnN0IGRhdGUgPSBvcHRpb25zPy5kYXRlIHx8IE1hdGguZmxvb3IoKC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpKS5nZXRUaW1lKCkgLyAxZTMpO1xuICBjb25zdCBwYXlsb2FkID0gSlNPTi5zdHJpbmdpZnkoe1xuICAgIHVybDogbmV3VXJsLFxuICAgIGRhdGUsXG4gICAgZXhwaXJlczogb3B0aW9ucy5leHBpcmVzLFxuICAgIG1ldGhvZDogXCJHRVRcIlxuICB9KTtcbiAgbGV0IGVuZHBvaW50ID0gXCJodHRwczovL2FwaS5waW5hdGEuY2xvdWQvdjNcIjtcbiAgaWYgKGNvbmZpZy5lbmRwb2ludFVybCkge1xuICAgIGVuZHBvaW50ID0gY29uZmlnLmVuZHBvaW50VXJsO1xuICB9XG4gIGxldCBoZWFkZXJzO1xuICBpZiAoY29uZmlnLmN1c3RvbUhlYWRlcnMgJiYgT2JqZWN0LmtleXMoY29uZmlnLmN1c3RvbUhlYWRlcnMpLmxlbmd0aCA+IDApIHtcbiAgICBoZWFkZXJzID0ge1xuICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke2NvbmZpZy5waW5hdGFKd3R9YCxcbiAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgLi4uY29uZmlnLmN1c3RvbUhlYWRlcnNcbiAgICB9O1xuICB9IGVsc2Uge1xuICAgIGhlYWRlcnMgPSB7XG4gICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHtjb25maWcucGluYXRhSnd0fWAsXG4gICAgICBTb3VyY2U6IFwic2RrL2NyZWF0ZVNpZ25VUkxcIlxuICAgIH07XG4gIH1cbiAgdHJ5IHtcbiAgICBjb25zdCByZXF1ZXN0ID0gYXdhaXQgZmV0Y2goYCR7ZW5kcG9pbnR9L2ZpbGVzL3NpZ25gLCB7XG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgaGVhZGVycyxcbiAgICAgIGJvZHk6IHBheWxvYWRcbiAgICB9KTtcbiAgICBpZiAoIXJlcXVlc3Qub2spIHtcbiAgICAgIGNvbnN0IGVycm9yRGF0YSA9IGF3YWl0IHJlcXVlc3QudGV4dCgpO1xuICAgICAgaWYgKHJlcXVlc3Quc3RhdHVzID09PSA0MDEgfHwgcmVxdWVzdC5zdGF0dXMgPT09IDQwMykge1xuICAgICAgICB0aHJvdyBuZXcgQXV0aGVudGljYXRpb25FcnJvcihcbiAgICAgICAgICBgQXV0aGVudGljYXRpb24gRmFpbGVkOiAke2Vycm9yRGF0YX1gLFxuICAgICAgICAgIHJlcXVlc3Quc3RhdHVzLFxuICAgICAgICAgIGVycm9yRGF0YVxuICAgICAgICApO1xuICAgICAgfVxuICAgICAgdGhyb3cgbmV3IE5ldHdvcmtFcnJvcihcbiAgICAgICAgYEhUVFAgZXJyb3I6ICR7ZXJyb3JEYXRhfWAsXG4gICAgICAgIHJlcXVlc3Quc3RhdHVzLFxuICAgICAgICBlcnJvckRhdGFcbiAgICAgICk7XG4gICAgfVxuICAgIGNvbnN0IHJlcyA9IGF3YWl0IHJlcXVlc3QuanNvbigpO1xuICAgIHJldHVybiByZXMuZGF0YTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBQaW5hdGFFcnJvcikge1xuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIEVycm9yKSB7XG4gICAgICB0aHJvdyBuZXcgUGluYXRhRXJyb3IoXG4gICAgICAgIGBFcnJvciBwcm9jZXNzaW5nIGNyZWF0ZVNpZ25lZFVSTDogJHtlcnJvci5tZXNzYWdlfWBcbiAgICAgICk7XG4gICAgfVxuICAgIHRocm93IG5ldyBQaW5hdGFFcnJvcihcIkFuIHVua25vd24gZXJyb3Igb2NjdXJyZWQgd2hpbGUgZ2V0dGluZyBzaWduZWQgdXJsXCIpO1xuICB9XG59O1xuXG4vLyBzcmMvY29yZS9waW5hdGFTREsudHNcbnZhciBmb3JtYXRDb25maWcgPSAoY29uZmlnKSA9PiB7XG4gIGxldCBnYXRld2F5ID0gY29uZmlnPy5waW5hdGFHYXRld2F5O1xuICBpZiAoY29uZmlnICYmIGdhdGV3YXkpIHtcbiAgICBpZiAoZ2F0ZXdheSAmJiAhZ2F0ZXdheS5zdGFydHNXaXRoKFwiaHR0cHM6Ly9cIikpIHtcbiAgICAgIGdhdGV3YXkgPSBgaHR0cHM6Ly8ke2dhdGV3YXl9YDtcbiAgICB9XG4gICAgY29uZmlnLnBpbmF0YUdhdGV3YXkgPSBnYXRld2F5O1xuICB9XG4gIHJldHVybiBjb25maWc7XG59O1xudmFyIFBpbmF0YVNESyA9IGNsYXNzIHtcbiAgLy9zaWduYXR1cmVzOiBTaWduYXR1cmVzO1xuICBjb25zdHJ1Y3Rvcihjb25maWcpIHtcbiAgICB0aGlzLmNvbmZpZyA9IGZvcm1hdENvbmZpZyhjb25maWcpO1xuICAgIHRoaXMuZmlsZXMgPSBuZXcgRmlsZXModGhpcy5jb25maWcpO1xuICAgIHRoaXMudXBsb2FkID0gbmV3IFVwbG9hZCh0aGlzLmNvbmZpZyk7XG4gICAgdGhpcy5nYXRld2F5cyA9IG5ldyBHYXRld2F5cyh0aGlzLmNvbmZpZyk7XG4gICAgdGhpcy5rZXlzID0gbmV3IEtleXModGhpcy5jb25maWcpO1xuICAgIHRoaXMuZ3JvdXBzID0gbmV3IEdyb3Vwcyh0aGlzLmNvbmZpZyk7XG4gICAgdGhpcy5hbmFseXRpY3MgPSBuZXcgQW5hbHl0aWNzKHRoaXMuY29uZmlnKTtcbiAgfVxuICBzZXROZXdIZWFkZXJzKGhlYWRlcnMpIHtcbiAgICBpZiAoIXRoaXMuY29uZmlnKSB7XG4gICAgICB0aGlzLmNvbmZpZyA9IHsgcGluYXRhSnd0OiBcIlwiLCBjdXN0b21IZWFkZXJzOiB7fSB9O1xuICAgIH1cbiAgICB0aGlzLmNvbmZpZy5jdXN0b21IZWFkZXJzID0geyAuLi50aGlzLmNvbmZpZy5jdXN0b21IZWFkZXJzLCAuLi5oZWFkZXJzIH07XG4gICAgdGhpcy5maWxlcy51cGRhdGVDb25maWcodGhpcy5jb25maWcpO1xuICAgIHRoaXMudXBsb2FkLnVwZGF0ZUNvbmZpZyh0aGlzLmNvbmZpZyk7XG4gICAgdGhpcy5nYXRld2F5cy51cGRhdGVDb25maWcodGhpcy5jb25maWcpO1xuICAgIHRoaXMua2V5cy51cGRhdGVDb25maWcodGhpcy5jb25maWcpO1xuICAgIHRoaXMuZ3JvdXBzLnVwZGF0ZUNvbmZpZyh0aGlzLmNvbmZpZyk7XG4gICAgdGhpcy5hbmFseXRpY3MudXBkYXRlQ29uZmlnKHRoaXMuY29uZmlnKTtcbiAgfVxuICBzZXROZXdKd3Qoand0KSB7XG4gICAgaWYgKCF0aGlzLmNvbmZpZykge1xuICAgICAgdGhpcy5jb25maWcgPSB7IHBpbmF0YUp3dDogXCJcIiB9O1xuICAgIH1cbiAgICB0aGlzLmNvbmZpZy5waW5hdGFKd3QgPSBqd3Q7XG4gICAgdGhpcy5maWxlcy51cGRhdGVDb25maWcodGhpcy5jb25maWcpO1xuICAgIHRoaXMudXBsb2FkLnVwZGF0ZUNvbmZpZyh0aGlzLmNvbmZpZyk7XG4gICAgdGhpcy5nYXRld2F5cy51cGRhdGVDb25maWcodGhpcy5jb25maWcpO1xuICAgIHRoaXMua2V5cy51cGRhdGVDb25maWcodGhpcy5jb25maWcpO1xuICAgIHRoaXMuZ3JvdXBzLnVwZGF0ZUNvbmZpZyh0aGlzLmNvbmZpZyk7XG4gICAgdGhpcy5hbmFseXRpY3MudXBkYXRlQ29uZmlnKHRoaXMuY29uZmlnKTtcbiAgfVxuICB0ZXN0QXV0aGVudGljYXRpb24oKSB7XG4gICAgcmV0dXJuIHRlc3RBdXRoZW50aWNhdGlvbih0aGlzLmNvbmZpZyk7XG4gIH1cbn07XG52YXIgRmlsZXMgPSBjbGFzcyB7XG4gIGNvbnN0cnVjdG9yKGNvbmZpZykge1xuICAgIHRoaXMuY29uZmlnID0gZm9ybWF0Q29uZmlnKGNvbmZpZyk7XG4gIH1cbiAgdXBkYXRlQ29uZmlnKG5ld0NvbmZpZykge1xuICAgIHRoaXMuY29uZmlnID0gbmV3Q29uZmlnO1xuICB9XG4gIGxpc3QoKSB7XG4gICAgcmV0dXJuIG5ldyBGaWx0ZXJGaWxlcyh0aGlzLmNvbmZpZyk7XG4gIH1cbiAgZGVsZXRlKGZpbGVzKSB7XG4gICAgcmV0dXJuIGRlbGV0ZUZpbGUodGhpcy5jb25maWcsIGZpbGVzKTtcbiAgfVxuICB1cGRhdGUob3B0aW9ucykge1xuICAgIHJldHVybiB1cGRhdGVGaWxlKHRoaXMuY29uZmlnLCBvcHRpb25zKTtcbiAgfVxuICBhZGRTd2FwKG9wdGlvbnMpIHtcbiAgICByZXR1cm4gc3dhcENpZCh0aGlzLmNvbmZpZywgb3B0aW9ucyk7XG4gIH1cbiAgZ2V0U3dhcEhpc3Rvcnkob3B0aW9ucykge1xuICAgIHJldHVybiBzd2FwSGlzdG9yeSh0aGlzLmNvbmZpZywgb3B0aW9ucyk7XG4gIH1cbiAgZGVsZXRlU3dhcChjaWQpIHtcbiAgICByZXR1cm4gZGVsZXRlU3dhcCh0aGlzLmNvbmZpZywgY2lkKTtcbiAgfVxufTtcbnZhciBVcGxvYWRCdWlsZGVyID0gY2xhc3Mge1xuICBjb25zdHJ1Y3Rvcihjb25maWcsIHVwbG9hZEZ1bmN0aW9uLCAuLi5hcmdzKSB7XG4gICAgdGhpcy5jb25maWcgPSBjb25maWc7XG4gICAgdGhpcy51cGxvYWRGdW5jdGlvbiA9IHVwbG9hZEZ1bmN0aW9uO1xuICAgIHRoaXMuYXJncyA9IGFyZ3M7XG4gIH1cbiAgYWRkTWV0YWRhdGEobWV0YWRhdGEpIHtcbiAgICB0aGlzLm1ldGFkYXRhID0gbWV0YWRhdGE7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cbiAga2V5KGp3dCkge1xuICAgIHRoaXMua2V5cyA9IGp3dDtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuICAvLyBjaWRWZXJzaW9uKHY6IDAgfCAxKTogVXBsb2FkQnVpbGRlcjxUPiB7XG4gIC8vIFx0dGhpcy52ZXJzaW9uID0gdjtcbiAgLy8gXHRyZXR1cm4gdGhpcztcbiAgLy8gfVxuICBncm91cChncm91cElkKSB7XG4gICAgdGhpcy5ncm91cElkID0gZ3JvdXBJZDtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuICB0aGVuKG9uZnVsZmlsbGVkLCBvbnJlamVjdGVkKSB7XG4gICAgY29uc3Qgb3B0aW9ucyA9IHRoaXMuYXJnc1t0aGlzLmFyZ3MubGVuZ3RoIC0gMV0gfHwge307XG4gICAgaWYgKHRoaXMubWV0YWRhdGEpIHtcbiAgICAgIG9wdGlvbnMubWV0YWRhdGEgPSB0aGlzLm1ldGFkYXRhO1xuICAgIH1cbiAgICBpZiAodGhpcy5rZXlzKSB7XG4gICAgICBvcHRpb25zLmtleXMgPSB0aGlzLmtleXM7XG4gICAgfVxuICAgIGlmICh0aGlzLmdyb3VwSWQpIHtcbiAgICAgIG9wdGlvbnMuZ3JvdXBJZCA9IHRoaXMuZ3JvdXBJZDtcbiAgICB9XG4gICAgdGhpcy5hcmdzW3RoaXMuYXJncy5sZW5ndGggLSAxXSA9IG9wdGlvbnM7XG4gICAgcmV0dXJuIHRoaXMudXBsb2FkRnVuY3Rpb24odGhpcy5jb25maWcsIC4uLnRoaXMuYXJncykudGhlbihcbiAgICAgIG9uZnVsZmlsbGVkLFxuICAgICAgb25yZWplY3RlZFxuICAgICk7XG4gIH1cbn07XG52YXIgVXBsb2FkID0gY2xhc3Mge1xuICBjb25zdHJ1Y3Rvcihjb25maWcpIHtcbiAgICB0aGlzLmNvbmZpZyA9IGZvcm1hdENvbmZpZyhjb25maWcpO1xuICB9XG4gIHVwZGF0ZUNvbmZpZyhuZXdDb25maWcpIHtcbiAgICB0aGlzLmNvbmZpZyA9IG5ld0NvbmZpZztcbiAgfVxuICBmaWxlKGZpbGUsIG9wdGlvbnMpIHtcbiAgICByZXR1cm4gbmV3IFVwbG9hZEJ1aWxkZXIodGhpcy5jb25maWcsIHVwbG9hZEZpbGUsIGZpbGUsIG9wdGlvbnMpO1xuICB9XG4gIC8vIGZpbGVBcnJheShcbiAgLy8gXHRmaWxlczogRmlsZU9iamVjdFtdLFxuICAvLyBcdG9wdGlvbnM/OiBVcGxvYWRPcHRpb25zLFxuICAvLyApOiBVcGxvYWRCdWlsZGVyPFVwbG9hZFJlc3BvbnNlPiB7XG4gIC8vIFx0cmV0dXJuIG5ldyBVcGxvYWRCdWlsZGVyKHRoaXMuY29uZmlnLCB1cGxvYWRGaWxlQXJyYXksIGZpbGVzLCBvcHRpb25zKTtcbiAgLy8gfVxuICBiYXNlNjQoYmFzZTY0U3RyaW5nLCBvcHRpb25zKSB7XG4gICAgcmV0dXJuIG5ldyBVcGxvYWRCdWlsZGVyKHRoaXMuY29uZmlnLCB1cGxvYWRCYXNlNjQsIGJhc2U2NFN0cmluZywgb3B0aW9ucyk7XG4gIH1cbiAgdXJsKHVybCwgb3B0aW9ucykge1xuICAgIHJldHVybiBuZXcgVXBsb2FkQnVpbGRlcih0aGlzLmNvbmZpZywgdXBsb2FkVXJsLCB1cmwsIG9wdGlvbnMpO1xuICB9XG4gIGpzb24oZGF0YSwgb3B0aW9ucykge1xuICAgIHJldHVybiBuZXcgVXBsb2FkQnVpbGRlcih0aGlzLmNvbmZpZywgdXBsb2FkSnNvbiwgZGF0YSwgb3B0aW9ucyk7XG4gIH1cbn07XG52YXIgRmlsdGVyRmlsZXMgPSBjbGFzcyB7XG4gIC8vIHJhdGUgbGltaXQgdmFyc1xuICAvLyBwcml2YXRlIHJlcXVlc3RDb3VudCA9IDA7XG4gIC8vIHByaXZhdGUgbGFzdFJlcXVlc3RUaW1lID0gMDtcbiAgLy8gcHJpdmF0ZSByZWFkb25seSBNQVhfUkVRVUVTVFNfUEVSX01JTlVURSA9IDMwO1xuICAvLyBwcml2YXRlIHJlYWRvbmx5IE1JTlVURV9JTl9NUyA9IDYwMDAwO1xuICBjb25zdHJ1Y3Rvcihjb25maWcpIHtcbiAgICB0aGlzLnF1ZXJ5ID0ge307XG4gICAgdGhpcy5jb25maWcgPSBjb25maWc7XG4gIH1cbiAgbmFtZShuYW1lKSB7XG4gICAgdGhpcy5xdWVyeS5uYW1lID0gbmFtZTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuICBncm91cChncm91cCkge1xuICAgIHRoaXMucXVlcnkuZ3JvdXAgPSBncm91cDtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuICBjaWQoY2lkKSB7XG4gICAgdGhpcy5xdWVyeS5jaWQgPSBjaWQ7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cbiAgbWltZVR5cGUobWltZVR5cGUpIHtcbiAgICB0aGlzLnF1ZXJ5Lm1pbWVUeXBlID0gbWltZVR5cGU7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cbiAgb3JkZXIob3JkZXIpIHtcbiAgICB0aGlzLnF1ZXJ5Lm9yZGVyID0gb3JkZXI7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cbiAgbGltaXQobGltaXQpIHtcbiAgICB0aGlzLnF1ZXJ5LmxpbWl0ID0gbGltaXQ7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cbiAgY2lkUGVuZGluZyhjaWRQZW5kaW5nKSB7XG4gICAgdGhpcy5xdWVyeS5jaWRQZW5kaW5nID0gY2lkUGVuZGluZztcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuICBtZXRhZGF0YShrZXl2YWx1ZXMpIHtcbiAgICB0aGlzLnF1ZXJ5Lm1ldGFkYXRhID0ga2V5dmFsdWVzO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG4gIG5vR3JvdXAobm9Hcm91cCkge1xuICAgIHRoaXMucXVlcnkubm9Hcm91cCA9IG5vR3JvdXA7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cbiAgcGFnZVRva2VuKHBhZ2VUb2tlbikge1xuICAgIHRoaXMucXVlcnkucGFnZVRva2VuID0gcGFnZVRva2VuO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG4gIHRoZW4ob25mdWxmaWxsZWQpIHtcbiAgICByZXR1cm4gdGhpcy5mZXRjaFBhZ2UoKS50aGVuKG9uZnVsZmlsbGVkKTtcbiAgfVxuICBhc3luYyBmZXRjaFBhZ2UoKSB7XG4gICAgaWYgKHRoaXMuY3VycmVudFBhZ2VUb2tlbikge1xuICAgICAgdGhpcy5xdWVyeS5wYWdlVG9rZW4gPSB0aGlzLmN1cnJlbnRQYWdlVG9rZW47XG4gICAgfVxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgbGlzdEZpbGVzKHRoaXMuY29uZmlnLCB0aGlzLnF1ZXJ5KTtcbiAgICB0aGlzLmN1cnJlbnRQYWdlVG9rZW4gPSByZXNwb25zZS5uZXh0X3BhZ2VfdG9rZW47XG4gICAgcmV0dXJuIHJlc3BvbnNlO1xuICB9XG4gIC8vIC8vIHJhdGUgbGltaXQsIGhvcGVmdWxseSB0ZW1wb3Jhcnk/XG4gIC8vIHByaXZhdGUgYXN5bmMgcmF0ZUxpbWl0KCk6IFByb21pc2U8dm9pZD4ge1xuICAvLyBcdHRoaXMucmVxdWVzdENvdW50Kys7XG4gIC8vIFx0Y29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcbiAgLy8gXHRpZiAodGhpcy5yZXF1ZXN0Q291bnQgPj0gdGhpcy5NQVhfUkVRVUVTVFNfUEVSX01JTlVURSkge1xuICAvLyBcdFx0Y29uc3QgdGltZVBhc3NlZFNpbmNlTGFzdFJlcXVlc3QgPSBub3cgLSB0aGlzLmxhc3RSZXF1ZXN0VGltZTtcbiAgLy8gXHRcdGlmICh0aW1lUGFzc2VkU2luY2VMYXN0UmVxdWVzdCA8IHRoaXMuTUlOVVRFX0lOX01TKSB7XG4gIC8vIFx0XHRcdGNvbnN0IGRlbGF5VGltZSA9IHRoaXMuTUlOVVRFX0lOX01TIC0gdGltZVBhc3NlZFNpbmNlTGFzdFJlcXVlc3Q7XG4gIC8vIFx0XHRcdGF3YWl0IG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIGRlbGF5VGltZSkpO1xuICAvLyBcdFx0fVxuICAvLyBcdFx0dGhpcy5yZXF1ZXN0Q291bnQgPSAwO1xuICAvLyBcdH1cbiAgLy8gXHR0aGlzLmxhc3RSZXF1ZXN0VGltZSA9IERhdGUubm93KCk7XG4gIC8vIH1cbiAgYXN5bmMgKltTeW1ib2wuYXN5bmNJdGVyYXRvcl0oKSB7XG4gICAgd2hpbGUgKHRydWUpIHtcbiAgICAgIGNvbnN0IGl0ZW1zID0gYXdhaXQgdGhpcy5mZXRjaFBhZ2UoKTtcbiAgICAgIGZvciAoY29uc3QgaXRlbSBvZiBpdGVtcy5maWxlcykge1xuICAgICAgICB5aWVsZCBpdGVtO1xuICAgICAgfVxuICAgICAgaWYgKCF0aGlzLmN1cnJlbnRQYWdlVG9rZW4pIHtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIGFzeW5jIGFsbCgpIHtcbiAgICBjb25zdCBhbGxJdGVtcyA9IFtdO1xuICAgIGZvciBhd2FpdCAoY29uc3QgaXRlbSBvZiB0aGlzKSB7XG4gICAgICBhbGxJdGVtcy5wdXNoKGl0ZW0pO1xuICAgIH1cbiAgICByZXR1cm4gYWxsSXRlbXM7XG4gIH1cbn07XG52YXIgR2F0ZXdheXMgPSBjbGFzcyB7XG4gIGNvbnN0cnVjdG9yKGNvbmZpZykge1xuICAgIHRoaXMuY29uZmlnID0gZm9ybWF0Q29uZmlnKGNvbmZpZyk7XG4gIH1cbiAgdXBkYXRlQ29uZmlnKG5ld0NvbmZpZykge1xuICAgIHRoaXMuY29uZmlnID0gbmV3Q29uZmlnO1xuICB9XG4gIGdldChjaWQpIHtcbiAgICByZXR1cm4gbmV3IE9wdGltaXplSW1hZ2VHZXRDaWQodGhpcy5jb25maWcsIGNpZCk7XG4gIH1cbiAgY3JlYXRlU2lnbmVkVVJMKG9wdGlvbnMpIHtcbiAgICByZXR1cm4gbmV3IE9wdGltaXplSW1hZ2VDcmVhdGVTaWduZWRVUkwodGhpcy5jb25maWcsIG9wdGlvbnMpO1xuICB9XG4gIC8vIHRvcFVzYWdlQW5hbHl0aWNzKG9wdGlvbnM6IHtcbiAgLy8gXHRkb21haW46IHN0cmluZztcbiAgLy8gXHRzdGFydDogc3RyaW5nO1xuICAvLyBcdGVuZDogc3RyaW5nO1xuICAvLyBcdHNvcnRCeTogXCJyZXF1ZXN0c1wiIHwgXCJiYW5kd2lkdGhcIjtcbiAgLy8gXHRhdHRyaWJ1dGU6XG4gIC8vIFx0XHR8IFwiY2lkXCJcbiAgLy8gXHRcdHwgXCJjb3VudHJ5XCJcbiAgLy8gXHRcdHwgXCJyZWdpb25cIlxuICAvLyBcdFx0fCBcInVzZXJfYWdlbnRcIlxuICAvLyBcdFx0fCBcInJlZmVyZXJcIlxuICAvLyBcdFx0fCBcImZpbGVfbmFtZVwiO1xuICAvLyB9KTogVG9wR2F0ZXdheUFuYWx5dGljc0J1aWxkZXIge1xuICAvLyBcdHJldHVybiBuZXcgVG9wR2F0ZXdheUFuYWx5dGljc0J1aWxkZXIoXG4gIC8vIFx0XHR0aGlzLmNvbmZpZyxcbiAgLy8gXHRcdG9wdGlvbnMuZG9tYWluLFxuICAvLyBcdFx0b3B0aW9ucy5zdGFydCxcbiAgLy8gXHRcdG9wdGlvbnMuZW5kLFxuICAvLyBcdFx0b3B0aW9ucy5zb3J0QnksXG4gIC8vIFx0XHRvcHRpb25zLmF0dHJpYnV0ZSxcbiAgLy8gXHQpO1xuICAvLyB9XG4gIC8vIGRhdGVJbnRlcnZhbEFuYWx5dGljcyhvcHRpb25zOiB7XG4gIC8vIFx0ZG9tYWluOiBzdHJpbmc7XG4gIC8vIFx0c3RhcnQ6IHN0cmluZztcbiAgLy8gXHRlbmQ6IHN0cmluZztcbiAgLy8gXHRpbnRlcnZhbDogXCJkYXlcIiB8IFwid2Vla1wiO1xuICAvLyB9KTogVGltZUludGVydmFsR2F0ZXdheUFuYWx5dGljc0J1aWxkZXIge1xuICAvLyBcdHJldHVybiBuZXcgVGltZUludGVydmFsR2F0ZXdheUFuYWx5dGljc0J1aWxkZXIoXG4gIC8vIFx0XHR0aGlzLmNvbmZpZyxcbiAgLy8gXHRcdG9wdGlvbnMuZG9tYWluLFxuICAvLyBcdFx0b3B0aW9ucy5zdGFydCxcbiAgLy8gXHRcdG9wdGlvbnMuZW5kLFxuICAvLyBcdFx0b3B0aW9ucy5pbnRlcnZhbCxcbiAgLy8gXHQpO1xuICAvLyB9XG59O1xudmFyIE9wdGltaXplSW1hZ2VHZXRDaWQgPSBjbGFzcyB7XG4gIGNvbnN0cnVjdG9yKGNvbmZpZywgY2lkKSB7XG4gICAgdGhpcy5vcHRpb25zID0ge307XG4gICAgdGhpcy5jb25maWcgPSBjb25maWc7XG4gICAgdGhpcy5jaWQgPSBjaWQ7XG4gIH1cbiAgb3B0aW1pemVJbWFnZShvcHRpb25zKSB7XG4gICAgdGhpcy5vcHRpb25zID0geyAuLi50aGlzLm9wdGlvbnMsIC4uLm9wdGlvbnMgfTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuICB0aGVuKG9uZnVsZmlsbGVkKSB7XG4gICAgcmV0dXJuIGdldENpZCh0aGlzLmNvbmZpZywgdGhpcy5jaWQsIHRoaXMub3B0aW9ucykudGhlbihvbmZ1bGZpbGxlZCk7XG4gIH1cbn07XG52YXIgT3B0aW1pemVJbWFnZUNyZWF0ZVNpZ25lZFVSTCA9IGNsYXNzIHtcbiAgY29uc3RydWN0b3IoY29uZmlnLCB1cmxPcHRzKSB7XG4gICAgdGhpcy5pbWdPcHRzID0ge307XG4gICAgdGhpcy5jb25maWcgPSBjb25maWc7XG4gICAgdGhpcy51cmxPcHRzID0gdXJsT3B0cztcbiAgfVxuICBvcHRpbWl6ZUltYWdlKG9wdGlvbnMpIHtcbiAgICB0aGlzLmltZ09wdHMgPSB7IC4uLnRoaXMuaW1nT3B0cywgLi4ub3B0aW9ucyB9O1xuICAgIHJldHVybiB0aGlzO1xuICB9XG4gIHRoZW4ob25mdWxmaWxsZWQpIHtcbiAgICByZXR1cm4gY3JlYXRlU2lnbmVkVVJMKHRoaXMuY29uZmlnLCB0aGlzLnVybE9wdHMsIHRoaXMuaW1nT3B0cykudGhlbihcbiAgICAgIG9uZnVsZmlsbGVkXG4gICAgKTtcbiAgfVxufTtcbnZhciBLZXlzID0gY2xhc3Mge1xuICBjb25zdHJ1Y3Rvcihjb25maWcpIHtcbiAgICB0aGlzLmNvbmZpZyA9IGZvcm1hdENvbmZpZyhjb25maWcpO1xuICB9XG4gIHVwZGF0ZUNvbmZpZyhuZXdDb25maWcpIHtcbiAgICB0aGlzLmNvbmZpZyA9IG5ld0NvbmZpZztcbiAgfVxuICBjcmVhdGUob3B0aW9ucykge1xuICAgIHJldHVybiBjcmVhdGVLZXkodGhpcy5jb25maWcsIG9wdGlvbnMpO1xuICB9XG4gIGxpc3QoKSB7XG4gICAgcmV0dXJuIG5ldyBGaWx0ZXJLZXlzKHRoaXMuY29uZmlnKTtcbiAgfVxuICByZXZva2Uoa2V5cykge1xuICAgIHJldHVybiByZXZva2VLZXlzKHRoaXMuY29uZmlnLCBrZXlzKTtcbiAgfVxufTtcbnZhciBGaWx0ZXJLZXlzID0gY2xhc3Mge1xuICAvLyByYXRlIGxpbWl0IHZhcnNcbiAgLy8gcHJpdmF0ZSByZXF1ZXN0Q291bnQgPSAwO1xuICAvLyBwcml2YXRlIGxhc3RSZXF1ZXN0VGltZSA9IDA7XG4gIC8vIHByaXZhdGUgcmVhZG9ubHkgTUFYX1JFUVVFU1RTX1BFUl9NSU5VVEUgPSAzMDtcbiAgLy8gcHJpdmF0ZSByZWFkb25seSBNSU5VVEVfSU5fTVMgPSA2MDAwMDtcbiAgY29uc3RydWN0b3IoY29uZmlnKSB7XG4gICAgdGhpcy5xdWVyeSA9IHt9O1xuICAgIHRoaXMuY29uZmlnID0gY29uZmlnO1xuICB9XG4gIG9mZnNldChvZmZzZXQpIHtcbiAgICB0aGlzLnF1ZXJ5Lm9mZnNldCA9IG9mZnNldDtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuICByZXZva2VkKHJldm9rZWQpIHtcbiAgICB0aGlzLnF1ZXJ5LnJldm9rZWQgPSByZXZva2VkO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG4gIGxpbWl0ZWRVc2UobGltaXRlZFVzZSkge1xuICAgIHRoaXMucXVlcnkubGltaXRlZFVzZSA9IGxpbWl0ZWRVc2U7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cbiAgZXhoYXVzdGVkKGV4aGF1c3RlZCkge1xuICAgIHRoaXMucXVlcnkuZXhoYXVzdGVkID0gZXhoYXVzdGVkO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG4gIG5hbWUobmFtZSkge1xuICAgIHRoaXMucXVlcnkubmFtZSA9IG5hbWU7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cbiAgdGhlbihvbmZ1bGZpbGxlZCkge1xuICAgIHJldHVybiBsaXN0S2V5cyh0aGlzLmNvbmZpZywgdGhpcy5xdWVyeSkudGhlbihvbmZ1bGZpbGxlZCk7XG4gIH1cbiAgLy8gcHJpdmF0ZSBhc3luYyByYXRlTGltaXQoKTogUHJvbWlzZTx2b2lkPiB7XG4gIC8vIFx0dGhpcy5yZXF1ZXN0Q291bnQrKztcbiAgLy8gXHRjb25zdCBub3cgPSBEYXRlLm5vdygpO1xuICAvLyBcdGlmICh0aGlzLnJlcXVlc3RDb3VudCA+PSB0aGlzLk1BWF9SRVFVRVNUU19QRVJfTUlOVVRFKSB7XG4gIC8vIFx0XHRjb25zdCB0aW1lUGFzc2VkU2luY2VMYXN0UmVxdWVzdCA9IG5vdyAtIHRoaXMubGFzdFJlcXVlc3RUaW1lO1xuICAvLyBcdFx0aWYgKHRpbWVQYXNzZWRTaW5jZUxhc3RSZXF1ZXN0IDwgdGhpcy5NSU5VVEVfSU5fTVMpIHtcbiAgLy8gXHRcdFx0Y29uc3QgZGVsYXlUaW1lID0gdGhpcy5NSU5VVEVfSU5fTVMgLSB0aW1lUGFzc2VkU2luY2VMYXN0UmVxdWVzdDtcbiAgLy8gXHRcdFx0YXdhaXQgbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgZGVsYXlUaW1lKSk7XG4gIC8vIFx0XHR9XG4gIC8vIFx0XHR0aGlzLnJlcXVlc3RDb3VudCA9IDA7XG4gIC8vIFx0fVxuICAvLyBcdHRoaXMubGFzdFJlcXVlc3RUaW1lID0gRGF0ZS5ub3coKTtcbiAgLy8gfVxuICBhc3luYyAqW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSgpIHtcbiAgICBsZXQgaGFzTW9yZSA9IHRydWU7XG4gICAgbGV0IG9mZnNldCA9IDA7XG4gICAgd2hpbGUgKGhhc01vcmUpIHtcbiAgICAgIHRoaXMucXVlcnkub2Zmc2V0ID0gb2Zmc2V0O1xuICAgICAgY29uc3QgaXRlbXMgPSBhd2FpdCBsaXN0S2V5cyh0aGlzLmNvbmZpZywgdGhpcy5xdWVyeSk7XG4gICAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgaXRlbXMpIHtcbiAgICAgICAgeWllbGQgaXRlbTtcbiAgICAgIH1cbiAgICAgIGlmIChpdGVtcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgaGFzTW9yZSA9IGZhbHNlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgb2Zmc2V0ICs9IGl0ZW1zLmxlbmd0aDtcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgYXN5bmMgYWxsKCkge1xuICAgIGNvbnN0IGFsbEl0ZW1zID0gW107XG4gICAgZm9yIGF3YWl0IChjb25zdCBpdGVtIG9mIHRoaXMpIHtcbiAgICAgIGFsbEl0ZW1zLnB1c2goaXRlbSk7XG4gICAgfVxuICAgIHJldHVybiBhbGxJdGVtcztcbiAgfVxufTtcbnZhciBHcm91cHMgPSBjbGFzcyB7XG4gIGNvbnN0cnVjdG9yKGNvbmZpZykge1xuICAgIHRoaXMuY29uZmlnID0gZm9ybWF0Q29uZmlnKGNvbmZpZyk7XG4gIH1cbiAgdXBkYXRlQ29uZmlnKG5ld0NvbmZpZykge1xuICAgIHRoaXMuY29uZmlnID0gbmV3Q29uZmlnO1xuICB9XG4gIGNyZWF0ZShvcHRpb25zKSB7XG4gICAgcmV0dXJuIGNyZWF0ZUdyb3VwKHRoaXMuY29uZmlnLCBvcHRpb25zKTtcbiAgfVxuICBsaXN0KCkge1xuICAgIHJldHVybiBuZXcgRmlsdGVyR3JvdXBzKHRoaXMuY29uZmlnKTtcbiAgfVxuICBnZXQob3B0aW9ucykge1xuICAgIHJldHVybiBnZXRHcm91cCh0aGlzLmNvbmZpZywgb3B0aW9ucyk7XG4gIH1cbiAgYWRkRmlsZXMob3B0aW9ucykge1xuICAgIHJldHVybiBhZGRUb0dyb3VwKHRoaXMuY29uZmlnLCBvcHRpb25zKTtcbiAgfVxuICByZW1vdmVGaWxlcyhvcHRpb25zKSB7XG4gICAgcmV0dXJuIHJlbW92ZUZyb21Hcm91cCh0aGlzLmNvbmZpZywgb3B0aW9ucyk7XG4gIH1cbiAgdXBkYXRlKG9wdGlvbnMpIHtcbiAgICByZXR1cm4gdXBkYXRlR3JvdXAodGhpcy5jb25maWcsIG9wdGlvbnMpO1xuICB9XG4gIGRlbGV0ZShvcHRpb25zKSB7XG4gICAgcmV0dXJuIGRlbGV0ZUdyb3VwKHRoaXMuY29uZmlnLCBvcHRpb25zKTtcbiAgfVxufTtcbnZhciBGaWx0ZXJHcm91cHMgPSBjbGFzcyB7XG4gIGNvbnN0cnVjdG9yKGNvbmZpZykge1xuICAgIHRoaXMucXVlcnkgPSB7fTtcbiAgICB0aGlzLmNvbmZpZyA9IGNvbmZpZztcbiAgfVxuICBuYW1lKG5hbWUpIHtcbiAgICB0aGlzLnF1ZXJ5Lm5hbWUgPSBuYW1lO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG4gIGxpbWl0KGxpbWl0KSB7XG4gICAgdGhpcy5xdWVyeS5saW1pdCA9IGxpbWl0O1xuICAgIHJldHVybiB0aGlzO1xuICB9XG4gIGlzUHVibGljKGlzUHVibGljKSB7XG4gICAgdGhpcy5xdWVyeS5pc1B1YmxpYyA9IGlzUHVibGljO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG4gIHBhZ2VUb2tlbihwYWdlVG9rZW4pIHtcbiAgICB0aGlzLnF1ZXJ5LnBhZ2VUb2tlbiA9IHBhZ2VUb2tlbjtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuICB0aGVuKG9uZnVsZmlsbGVkKSB7XG4gICAgcmV0dXJuIHRoaXMuZmV0Y2hQYWdlKCkudGhlbigocmVzcG9uc2UpID0+IHtcbiAgICAgIHRoaXMubmV4dFBhZ2VUb2tlbiA9IHJlc3BvbnNlLm5leHRfcGFnZV90b2tlbjtcbiAgICAgIHJldHVybiByZXNwb25zZTtcbiAgICB9KS50aGVuKG9uZnVsZmlsbGVkKTtcbiAgfVxuICBhc3luYyBmZXRjaFBhZ2UoKSB7XG4gICAgaWYgKHRoaXMubmV4dFBhZ2VUb2tlbikge1xuICAgICAgdGhpcy5xdWVyeS5wYWdlVG9rZW4gPSB0aGlzLm5leHRQYWdlVG9rZW47XG4gICAgfVxuICAgIHJldHVybiBsaXN0R3JvdXBzKHRoaXMuY29uZmlnLCB0aGlzLnF1ZXJ5KTtcbiAgfVxuICAvLyByYXRlIGxpbWl0LCBob3BlZnVsbHkgdGVtcG9yYXJ5P1xuICAvLyBwcml2YXRlIGFzeW5jIHJhdGVMaW1pdCgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgLy8gXHR0aGlzLnJlcXVlc3RDb3VudCsrO1xuICAvLyBcdGNvbnN0IG5vdyA9IERhdGUubm93KCk7XG4gIC8vIFx0aWYgKHRoaXMucmVxdWVzdENvdW50ID49IHRoaXMuTUFYX1JFUVVFU1RTX1BFUl9NSU5VVEUpIHtcbiAgLy8gXHRcdGNvbnN0IHRpbWVQYXNzZWRTaW5jZUxhc3RSZXF1ZXN0ID0gbm93IC0gdGhpcy5sYXN0UmVxdWVzdFRpbWU7XG4gIC8vIFx0XHRpZiAodGltZVBhc3NlZFNpbmNlTGFzdFJlcXVlc3QgPCB0aGlzLk1JTlVURV9JTl9NUykge1xuICAvLyBcdFx0XHRjb25zdCBkZWxheVRpbWUgPSB0aGlzLk1JTlVURV9JTl9NUyAtIHRpbWVQYXNzZWRTaW5jZUxhc3RSZXF1ZXN0O1xuICAvLyBcdFx0XHRhd2FpdCBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gc2V0VGltZW91dChyZXNvbHZlLCBkZWxheVRpbWUpKTtcbiAgLy8gXHRcdH1cbiAgLy8gXHRcdHRoaXMucmVxdWVzdENvdW50ID0gMDtcbiAgLy8gXHR9XG4gIC8vIFx0dGhpcy5sYXN0UmVxdWVzdFRpbWUgPSBEYXRlLm5vdygpO1xuICAvLyB9XG4gIGFzeW5jICpbU3ltYm9sLmFzeW5jSXRlcmF0b3JdKCkge1xuICAgIHdoaWxlICh0cnVlKSB7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMuZmV0Y2hQYWdlKCk7XG4gICAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgcmVzcG9uc2UuZ3JvdXBzKSB7XG4gICAgICAgIHlpZWxkIGl0ZW07XG4gICAgICB9XG4gICAgICBpZiAoIXJlc3BvbnNlLm5leHRfcGFnZV90b2tlbikge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIHRoaXMubmV4dFBhZ2VUb2tlbiA9IHJlc3BvbnNlLm5leHRfcGFnZV90b2tlbjtcbiAgICB9XG4gIH1cbiAgYXN5bmMgYWxsKCkge1xuICAgIGNvbnN0IGFsbEl0ZW1zID0gW107XG4gICAgZm9yIGF3YWl0IChjb25zdCBpdGVtIG9mIHRoaXMpIHtcbiAgICAgIGFsbEl0ZW1zLnB1c2goaXRlbSk7XG4gICAgfVxuICAgIHJldHVybiBhbGxJdGVtcztcbiAgfVxufTtcbnZhciBBbmFseXRpY3MgPSBjbGFzcyB7XG4gIGNvbnN0cnVjdG9yKGNvbmZpZykge1xuICAgIHRoaXMuY29uZmlnID0gZm9ybWF0Q29uZmlnKGNvbmZpZyk7XG4gICAgdGhpcy5yZXF1ZXN0cyA9IG5ldyBBbmFseXRpY3NSZXF1ZXN0cyh0aGlzLmNvbmZpZyk7XG4gICAgdGhpcy5iYW5kd2lkdGggPSBuZXcgQW5hbHl0aWNzQmFuZHdpZHRoKHRoaXMuY29uZmlnKTtcbiAgfVxuICB1cGRhdGVDb25maWcobmV3Q29uZmlnKSB7XG4gICAgdGhpcy5jb25maWcgPSBuZXdDb25maWc7XG4gICAgdGhpcy5yZXF1ZXN0cy51cGRhdGVDb25maWcobmV3Q29uZmlnKTtcbiAgICB0aGlzLmJhbmR3aWR0aC51cGRhdGVDb25maWcobmV3Q29uZmlnKTtcbiAgfVxuICAvLyBkZXRhaWxlZChvcHRpb25zOiB7XG4gIC8vIFx0ZG9tYWluOiBzdHJpbmc7XG4gIC8vIFx0c3RhcnQ6IHN0cmluZztcbiAgLy8gXHRlbmQ6IHN0cmluZztcbiAgLy8gXHRzb3J0Qnk6IFwicmVxdWVzdHNcIiB8IFwiYmFuZHdpZHRoXCI7XG4gIC8vIFx0YXR0cmlidXRlOlxuICAvLyBcdFx0fCBcImNpZFwiXG4gIC8vIFx0XHR8IFwiY291bnRyeVwiXG4gIC8vIFx0XHR8IFwicmVnaW9uXCJcbiAgLy8gXHRcdHwgXCJ1c2VyX2FnZW50XCJcbiAgLy8gXHRcdHwgXCJyZWZlcmVyXCJcbiAgLy8gXHRcdHwgXCJmaWxlX25hbWVcIjtcbiAgLy8gfSk6IFRvcEFuYWx5dGljc0J1aWxkZXIge1xuICAvLyBcdHJldHVybiBuZXcgVG9wQW5hbHl0aWNzQnVpbGRlcihcbiAgLy8gXHRcdHRoaXMuY29uZmlnLFxuICAvLyBcdFx0b3B0aW9ucy5kb21haW4sXG4gIC8vIFx0XHRvcHRpb25zLnN0YXJ0LFxuICAvLyBcdFx0b3B0aW9ucy5lbmQsXG4gIC8vIFx0XHRvcHRpb25zLnNvcnRCeSxcbiAgLy8gXHRcdG9wdGlvbnMuYXR0cmlidXRlLFxuICAvLyBcdCk7XG4gIC8vIH1cbiAgc3VtbWFyeShvcHRpb25zKSB7XG4gICAgcmV0dXJuIG5ldyBUaW1lSW50ZXJ2YWxBbmFseXRpY3NCdWlsZGVyKFxuICAgICAgdGhpcy5jb25maWcsXG4gICAgICBvcHRpb25zLmRvbWFpbixcbiAgICAgIG9wdGlvbnMuc3RhcnQsXG4gICAgICBvcHRpb25zLmVuZCxcbiAgICAgIG9wdGlvbnMuaW50ZXJ2YWxcbiAgICApO1xuICB9XG59O1xudmFyIGNhbGN1bGF0ZURhdGVzID0gKGRheXMpID0+IHtcbiAgY29uc3QgZW5kID0gLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCk7XG4gIGNvbnN0IHN0YXJ0ID0gLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCk7XG4gIHN0YXJ0LnNldERhdGUoc3RhcnQuZ2V0RGF0ZSgpIC0gZGF5cyk7XG4gIHJldHVybiB7XG4gICAgc3RhcnQ6IHN0YXJ0LnRvSVNPU3RyaW5nKCkuc3BsaXQoXCJUXCIpWzBdLFxuICAgIGVuZDogZW5kLnRvSVNPU3RyaW5nKCkuc3BsaXQoXCJUXCIpWzBdXG4gIH07XG59O1xudmFyIEFuYWx5dGljc0ZpbHRlciA9IGNsYXNzIHtcbiAgY29uc3RydWN0b3IoY29uZmlnLCBkb21haW4sIHN0YXJ0LCBlbmQpIHtcbiAgICB0aGlzLmNvbmZpZyA9IGNvbmZpZztcbiAgICB0aGlzLnF1ZXJ5ID0ge1xuICAgICAgZ2F0ZXdheV9kb21haW46IGRvbWFpbixcbiAgICAgIHN0YXJ0X2RhdGU6IHN0YXJ0LFxuICAgICAgZW5kX2RhdGU6IGVuZCxcbiAgICAgIHNvcnRfYnk6IFwicmVxdWVzdHNcIixcbiAgICAgIC8vIFdpbGwgYmUgb3ZlcnJpZGRlbiBpbiBjaGlsZCBjbGFzc2VzXG4gICAgICBhdHRyaWJ1dGU6IFwiY2lkXCJcbiAgICB9O1xuICB9XG4gIGNpZChjaWQpIHtcbiAgICB0aGlzLnF1ZXJ5LmF0dHJpYnV0ZSA9IFwiY2lkXCI7XG4gICAgaWYgKGNpZCkge1xuICAgICAgdGhpcy5xdWVyeS5jaWQgPSBjaWQ7XG4gICAgfVxuICAgIHJldHVybiB0aGlzO1xuICB9XG4gIGZpbGVOYW1lKGZpbGVOYW1lKSB7XG4gICAgdGhpcy5xdWVyeS5hdHRyaWJ1dGUgPSBcImZpbGVfbmFtZVwiO1xuICAgIGlmIChmaWxlTmFtZSkge1xuICAgICAgdGhpcy5xdWVyeS5maWxlX25hbWUgPSBmaWxlTmFtZTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cbiAgdXNlckFnZW50KHVzZXJBZ2VudCkge1xuICAgIHRoaXMucXVlcnkuYXR0cmlidXRlID0gXCJ1c2VyX2FnZW50XCI7XG4gICAgaWYgKHVzZXJBZ2VudCkge1xuICAgICAgdGhpcy5xdWVyeS51c2VyX2FnZW50ID0gdXNlckFnZW50O1xuICAgIH1cbiAgICByZXR1cm4gdGhpcztcbiAgfVxuICBjb3VudHJ5KGNvdW50cnkpIHtcbiAgICB0aGlzLnF1ZXJ5LmF0dHJpYnV0ZSA9IFwiY291bnRyeVwiO1xuICAgIGlmIChjb3VudHJ5KSB7XG4gICAgICB0aGlzLnF1ZXJ5LmNvdW50cnkgPSBjb3VudHJ5O1xuICAgIH1cbiAgICByZXR1cm4gdGhpcztcbiAgfVxuICByZWdpb24ocmVnaW9uKSB7XG4gICAgdGhpcy5xdWVyeS5hdHRyaWJ1dGUgPSBcInJlZ2lvblwiO1xuICAgIGlmIChyZWdpb24pIHtcbiAgICAgIHRoaXMucXVlcnkucmVnaW9uID0gcmVnaW9uO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcztcbiAgfVxuICByZWZlcmVyKHJlZmVyZXIpIHtcbiAgICB0aGlzLnF1ZXJ5LmF0dHJpYnV0ZSA9IFwicmVmZXJlclwiO1xuICAgIGlmIChyZWZlcmVyKSB7XG4gICAgICB0aGlzLnF1ZXJ5LnJlZmVyZXIgPSByZWZlcmVyO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcztcbiAgfVxuICBsaW1pdChsaW1pdCkge1xuICAgIHRoaXMucXVlcnkubGltaXQgPSBsaW1pdDtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuICBzb3J0KG9yZGVyKSB7XG4gICAgdGhpcy5xdWVyeS5zb3J0X29yZGVyID0gb3JkZXI7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cbiAgZGF5cyhudW1iZXJPZkRheXMpIHtcbiAgICBjb25zdCB7IHN0YXJ0LCBlbmQgfSA9IGNhbGN1bGF0ZURhdGVzKG51bWJlck9mRGF5cyk7XG4gICAgdGhpcy5xdWVyeS5zdGFydF9kYXRlID0gc3RhcnQ7XG4gICAgdGhpcy5xdWVyeS5lbmRfZGF0ZSA9IGVuZDtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuICB0aGVuKG9uZnVsZmlsbGVkKSB7XG4gICAgcmV0dXJuIGFuYWx5dGljc1RvcFVzYWdlKHRoaXMuY29uZmlnLCB0aGlzLnF1ZXJ5KS50aGVuKG9uZnVsZmlsbGVkKTtcbiAgfVxufTtcbnZhciBBbmFseXRpY3NSZXF1ZXN0cyA9IGNsYXNzIGV4dGVuZHMgQW5hbHl0aWNzRmlsdGVyIHtcbiAgY29uc3RydWN0b3IoY29uZmlnKSB7XG4gICAgc3VwZXIoY29uZmlnLCBcIlwiLCBcIlwiLCBcIlwiKTtcbiAgICB0aGlzLnF1ZXJ5LnNvcnRfYnkgPSBcInJlcXVlc3RzXCI7XG4gIH1cbiAgdXBkYXRlQ29uZmlnKG5ld0NvbmZpZykge1xuICAgIHRoaXMuY29uZmlnID0gbmV3Q29uZmlnO1xuICB9XG4gIGN1c3RvbURhdGVzKHN0YXJ0LCBlbmQpIHtcbiAgICBpZiAoc3RhcnQpXG4gICAgICB0aGlzLnF1ZXJ5LnN0YXJ0X2RhdGUgPSBzdGFydDtcbiAgICBpZiAoZW5kKVxuICAgICAgdGhpcy5xdWVyeS5lbmRfZGF0ZSA9IGVuZDtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuICBmcm9tKGRvbWFpbikge1xuICAgIHRoaXMucXVlcnkuZ2F0ZXdheV9kb21haW4gPSBkb21haW47XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cbn07XG52YXIgQW5hbHl0aWNzQmFuZHdpZHRoID0gY2xhc3MgZXh0ZW5kcyBBbmFseXRpY3NGaWx0ZXIge1xuICBjb25zdHJ1Y3Rvcihjb25maWcpIHtcbiAgICBzdXBlcihjb25maWcsIFwiXCIsIFwiXCIsIFwiXCIpO1xuICAgIHRoaXMucXVlcnkuc29ydF9ieSA9IFwiYmFuZHdpZHRoXCI7XG4gIH1cbiAgdXBkYXRlQ29uZmlnKG5ld0NvbmZpZykge1xuICAgIHRoaXMuY29uZmlnID0gbmV3Q29uZmlnO1xuICB9XG4gIGN1c3RvbURhdGVzKHN0YXJ0LCBlbmQpIHtcbiAgICBpZiAoc3RhcnQpXG4gICAgICB0aGlzLnF1ZXJ5LnN0YXJ0X2RhdGUgPSBzdGFydDtcbiAgICBpZiAoZW5kKVxuICAgICAgdGhpcy5xdWVyeS5lbmRfZGF0ZSA9IGVuZDtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuICBmcm9tKGRvbWFpbikge1xuICAgIHRoaXMucXVlcnkuZ2F0ZXdheV9kb21haW4gPSBkb21haW47XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cbn07XG52YXIgQW5hbHl0aWNzQnVpbGRlciA9IGNsYXNzIHtcbiAgY29uc3RydWN0b3IoY29uZmlnLCBxdWVyeSkge1xuICAgIHRoaXMucmVxdWVzdENvdW50ID0gMDtcbiAgICB0aGlzLmxhc3RSZXF1ZXN0VGltZSA9IDA7XG4gICAgdGhpcy5NQVhfUkVRVUVTVFNfUEVSX01JTlVURSA9IDMwO1xuICAgIHRoaXMuTUlOVVRFX0lOX01TID0gNmU0O1xuICAgIHRoaXMuY29uZmlnID0gY29uZmlnO1xuICAgIHRoaXMucXVlcnkgPSBxdWVyeTtcbiAgfVxuICBjaWQoY2lkKSB7XG4gICAgdGhpcy5xdWVyeS5jaWQgPSBjaWQ7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cbiAgZmlsZU5hbWUoZmlsZU5hbWUpIHtcbiAgICB0aGlzLnF1ZXJ5LmZpbGVfbmFtZSA9IGZpbGVOYW1lO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG4gIHVzZXJBZ2VudCh1c2VyQWdlbnQpIHtcbiAgICB0aGlzLnF1ZXJ5LnVzZXJfYWdlbnQgPSB1c2VyQWdlbnQ7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cbiAgY291bnRyeShjb3VudHJ5KSB7XG4gICAgdGhpcy5xdWVyeS5jb3VudHJ5ID0gY291bnRyeTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuICByZWdpb24ocmVnaW9uKSB7XG4gICAgdGhpcy5xdWVyeS5yZWdpb24gPSByZWdpb247XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cbiAgcmVmZXJlcihyZWZlcmVyKSB7XG4gICAgdGhpcy5xdWVyeS5yZWZlcmVyID0gcmVmZXJlcjtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuICBsaW1pdChsaW1pdCkge1xuICAgIHRoaXMucXVlcnkubGltaXQgPSBsaW1pdDtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuICBzb3J0KG9yZGVyKSB7XG4gICAgdGhpcy5xdWVyeS5zb3J0X29yZGVyID0gb3JkZXI7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cbiAgLy8gcHJpdmF0ZSBhc3luYyByYXRlTGltaXQoKTogUHJvbWlzZTx2b2lkPiB7XG4gIC8vIFx0dGhpcy5yZXF1ZXN0Q291bnQrKztcbiAgLy8gXHRjb25zdCBub3cgPSBEYXRlLm5vdygpO1xuICAvLyBcdGlmICh0aGlzLnJlcXVlc3RDb3VudCA+PSB0aGlzLk1BWF9SRVFVRVNUU19QRVJfTUlOVVRFKSB7XG4gIC8vIFx0XHRjb25zdCB0aW1lUGFzc2VkU2luY2VMYXN0UmVxdWVzdCA9IG5vdyAtIHRoaXMubGFzdFJlcXVlc3RUaW1lO1xuICAvLyBcdFx0aWYgKHRpbWVQYXNzZWRTaW5jZUxhc3RSZXF1ZXN0IDwgdGhpcy5NSU5VVEVfSU5fTVMpIHtcbiAgLy8gXHRcdFx0Y29uc3QgZGVsYXlUaW1lID0gdGhpcy5NSU5VVEVfSU5fTVMgLSB0aW1lUGFzc2VkU2luY2VMYXN0UmVxdWVzdDtcbiAgLy8gXHRcdFx0YXdhaXQgbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgZGVsYXlUaW1lKSk7XG4gIC8vIFx0XHR9XG4gIC8vIFx0XHR0aGlzLnJlcXVlc3RDb3VudCA9IDA7XG4gIC8vIFx0fVxuICAvLyBcdHRoaXMubGFzdFJlcXVlc3RUaW1lID0gRGF0ZS5ub3coKTtcbiAgLy8gfVxuICBhc3luYyBnZXRBbmFseXRpY3MoKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFwiZ2V0QW5hbHl0aWNzIG1ldGhvZCBtdXN0IGJlIGltcGxlbWVudGVkIGluIGRlcml2ZWQgY2xhc3NcIik7XG4gIH1cbiAgdGhlbihvbmZ1bGZpbGxlZCkge1xuICAgIHJldHVybiB0aGlzLmdldEFuYWx5dGljcygpLnRoZW4ob25mdWxmaWxsZWQpO1xuICB9XG59O1xudmFyIFRpbWVJbnRlcnZhbEFuYWx5dGljc0J1aWxkZXIgPSBjbGFzcyBleHRlbmRzIEFuYWx5dGljc0J1aWxkZXIge1xuICBjb25zdHJ1Y3Rvcihjb25maWcsIGRvbWFpbiwgc3RhcnQsIGVuZCwgZGF0ZUludGVydmFsKSB7XG4gICAgc3VwZXIoY29uZmlnLCB7XG4gICAgICBnYXRld2F5X2RvbWFpbjogZG9tYWluLFxuICAgICAgc3RhcnRfZGF0ZTogc3RhcnQsXG4gICAgICBlbmRfZGF0ZTogZW5kLFxuICAgICAgZGF0ZV9pbnRlcnZhbDogZGF0ZUludGVydmFsXG4gICAgfSk7XG4gIH1cbiAgc29ydEJ5KHNvcnRCeSkge1xuICAgIHRoaXMucXVlcnkuc29ydF9ieSA9IHNvcnRCeTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuICBhc3luYyBnZXRBbmFseXRpY3MoKSB7XG4gICAgcmV0dXJuIGFuYWx5dGljc0RhdGVJbnRlcnZhbCh0aGlzLmNvbmZpZywgdGhpcy5xdWVyeSk7XG4gIH1cbiAgYXN5bmMgYWxsKCkge1xuICAgIHJldHVybiB0aGlzLmdldEFuYWx5dGljcygpO1xuICB9XG59O1xuZXhwb3J0IHtcbiAgUGluYXRhU0RLXG59O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXgubWpzLm1hcCJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/pinata/dist/index.mjs\n");

/***/ })

};
;